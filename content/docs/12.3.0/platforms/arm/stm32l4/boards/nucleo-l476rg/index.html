<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ST Nucleo L476RG &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="ST Nucleo L496ZG" href="../nucleo-l496zg/index.html" />
    <link rel="prev" title="ST Nucleo L452RE" href="../nucleo-l452re/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a64/index.html">Allwinner A64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">ST STM32L4</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#supported-mcus">Supported MCUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../b-l475e-iot01a/index.html">ST B-L475E-IOT01A</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l432kc/index.html">ST Nucleo L432KC</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l452re/index.html">ST Nucleo L452RE</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">ST Nucleo L476RG</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l496zg/index.html">ST Nucleo L496ZG</a></li>
<li class="toctree-l5"><a class="reference internal" href="../steval-stlcs01v1/index.html">ST STEVAL-STLCS01V1</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32l476-mdk/index.html">STM32L476-mdk</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32l476vg-disco/index.html">ST STM32L476VG-DISCO</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32l4r9ai-disco/index.html">ST STM32L4R9AI-DISCO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">AVR8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">ST STM32L4</a></li>
      <li class="breadcrumb-item active">ST Nucleo L476RG</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/stm32l4/boards/nucleo-l476rg/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="st-nucleo-l476rg">
<h1>ST Nucleo L476RG<a class="headerlink" href="#st-nucleo-l476rg" title="Permalink to this heading"></a></h1>
<p>This page discusses issues unique to NuttX configurations for the ST
NucleoL476RG board from ST Micro.  See</p>
<blockquote>
<div><p><a class="reference external" href="http://www.st.com/nucleo-l476rg">http://www.st.com/nucleo-l476rg</a></p>
</div></blockquote>
<p>NucleoL476RG:</p>
<ul class="simple">
<li><p>Microprocessor: 32-bit ARM Cortex M4 at 80MHz STM32L476RGT6</p></li>
<li><p>Memory: 1024 KB Flash and 96+32 KB SRAM</p></li>
<li><p>ADC: 2×12-bit, 2.4 MSPS A/D converter: up to 24 channels</p></li>
<li><p>DMA: 16-stream DMA controllers with FIFOs and burst support</p></li>
<li><p>Timers: Up to 11 timers: up to eight 16-bit, two 32-bit timers, two
watchdog timers, and a SysTick timer</p></li>
<li><p>GPIO: Up to 51 I/O ports with interrupt capability</p></li>
<li><p>I2C: Up to 3 × I2C interfaces</p></li>
<li><p>USARTs: Up to 3 USARTs, 2 UARTs, 1 LPUART</p></li>
<li><p>SPIs: Up to 3 SPIs</p></li>
<li><p>SAIs: Up to 2 dual-channel audio interfaces</p></li>
<li><p>CAN interface</p></li>
<li><p>SDIO interface</p></li>
<li><p>QSPI interface</p></li>
<li><p>USB: USB 2.0 full-speed device/host/OTG controller with on-chip PHY</p></li>
<li><p>CRC calculation unit</p></li>
<li><p>RTC</p></li>
</ul>
<p>Board features:</p>
<ul class="simple">
<li><p>Peripherals: 1 led, 1 push button</p></li>
<li><p>Debug: Serial wire debug and JTAG interfaces</p></li>
<li><p>Expansion I/F  Ardino and Morpho Headers</p></li>
</ul>
<p>Uses a STM32F103 to provide a ST-Link for programming, debug similar to the
OpenOcd FTDI function - USB to JTAG front-end.</p>
<p>See <a class="reference external" href="http://mbed.org/platforms/ST-Nucleo-L476RG">http://mbed.org/platforms/ST-Nucleo-L476RG</a> for more
information about these boards.</p>
<section id="development-environment">
<h2>Development Environment<a class="headerlink" href="#development-environment" title="Permalink to this heading"></a></h2>
<p>Either Linux or Cygwin on Windows can be used for the development environment.
The source has been built only using the GNU toolchain (see below).  Other
toolchains will likely cause problems.</p>
</section>
<section id="gnu-toolchain-options">
<h2>GNU Toolchain Options<a class="headerlink" href="#gnu-toolchain-options" title="Permalink to this heading"></a></h2>
<section id="toolchain-configurations">
<h3>Toolchain Configurations<a class="headerlink" href="#toolchain-configurations" title="Permalink to this heading"></a></h3>
<p>The NuttX make system has been modified to support the following different
toolchain options.</p>
<ol class="arabic simple">
<li><p>The NuttX buildroot Toolchain (see below), or</p></li>
<li><p>Any generic arm-none-eabi GNU toolchain.</p></li>
</ol>
<p>All testing has been conducted using the NuttX Codesourcery toolchain.  To use
a different toolchain, you simply need to modify the configuration.  As an
example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_ARM_TOOLCHAIN_GNU_EABI : Generic arm-none-eabi toolchain
</pre></div>
</div>
</section>
</section>
<section id="ides">
<h2>IDEs<a class="headerlink" href="#ides" title="Permalink to this heading"></a></h2>
<p>NuttX is built using command-line make.  It can be used with an IDE, but some
effort will be required to create the project.</p>
<section id="makefile-build">
<h3>Makefile Build<a class="headerlink" href="#makefile-build" title="Permalink to this heading"></a></h3>
<p>Under Eclipse, it is pretty easy to set up an “empty makefile project” and
simply use the NuttX makefile to build the system.  That is almost for free
under Linux.  Under Windows, you will need to set up the “Cygwin GCC” empty
makefile project in order to work with Windows (Google for “Eclipse Cygwin” -
there is a lot of help on the internet).</p>
<p>Using Sourcery CodeBench from <a class="reference external" href="http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/overview">http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/overview</a>
Download and install the latest version (as of this writing it was
sourceryg++-2013.05-64-arm-none-eabi)</p>
<p>Import the  project from git.
File-&gt;import-&gt;Git-URI, then import a Exiting code as a Makefile progject
from the working directory the git clone was done to.</p>
<p>Select the Sourcery CodeBench for ARM EABI. N.B. You must do one command line
build, before the make will work in CodeBench.</p>
</section>
<section id="native-build">
<h3>Native Build<a class="headerlink" href="#native-build" title="Permalink to this heading"></a></h3>
<p>Here are a few tips before you start that effort:</p>
<ol class="arabic simple">
<li><p>Select the toolchain that you will be using in your .config file</p></li>
<li><p>Start the NuttX build at least one time from the Cygwin command line
before trying to create your project.  This is necessary to create
certain auto-generated files and directories that will be needed.</p></li>
<li><p>Set up include paths:  You will need include/, arch/arm/src/stm32,
arch/arm/src/common, arch/arm/src/armv7-m, and sched/.</p></li>
<li><p>All assembly files need to have the definition option -D __ASSEMBLY__
on the command line.</p></li>
</ol>
<p>Startup files will probably cause you some headaches.  The NuttX startup file
is arch/arm/src/stm32/stm32_vectors.S.  With RIDE, I have to build NuttX
one time from the Cygwin command line in order to obtain the pre-built
startup object needed by RIDE.</p>
</section>
</section>
<section id="nuttx-eabi-buildroot-toolchain">
<h2>NuttX EABI “buildroot” Toolchain<a class="headerlink" href="#nuttx-eabi-buildroot-toolchain" title="Permalink to this heading"></a></h2>
<p>A GNU GCC-based toolchain is assumed.  The PATH environment variable should
be modified to point to the correct path to the Cortex-M3 GCC toolchain (if
different from the default in your PATH variable).</p>
<p>If you have no Cortex-M3 toolchain, one can be downloaded from the NuttX
Bitbucket download site (<a class="reference external" href="https://bitbucket.org/nuttx/buildroot/downloads/">https://bitbucket.org/nuttx/buildroot/downloads/</a>).
This GNU toolchain builds and executes in the Linux or Cygwin environment.</p>
<ol class="arabic">
<li><p>You must have already configured NuttX in &lt;some-dir&gt;/nuttx.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ tools/configure.sh nucleo-l476rg:nsh
$ make qconfig
$ V=1 make context all 2&gt;&amp;1 | tee mout
</pre></div>
</div>
</li>
<li><p>Download the latest buildroot package into &lt;some-dir&gt;</p></li>
<li><p>unpack the buildroot tarball.  The resulting directory may
have versioning information on it like buildroot-x.y.z.  If so,
rename &lt;some-dir&gt;/buildroot-x.y.z to &lt;some-dir&gt;/buildroot.</p></li>
<li><p>cd &lt;some-dir&gt;/buildroot</p></li>
<li><p>cp boards/cortexm3-eabi-defconfig-4.6.3 .config</p></li>
<li><p>make oldconfig</p></li>
<li><p>make</p></li>
<li><p>Make sure that the PATH variable includes the path to the newly built
binaries.</p></li>
</ol>
<p>See the file boards/README.txt in the buildroot source tree.  That has more
details PLUS some special instructions that you will need to follow if you are
building a Cortex-M3 toolchain for Cygwin under Windows.</p>
<p>NOTE:  Unfortunately, the 4.6.3 EABI toolchain is not compatible with the
the NXFLAT tools.  See the top-level TODO file (under “Binary loaders”) for
more information about this problem. If you plan to use NXFLAT, please do not
use the GCC 4.6.3 EABI toolchain; instead use the GCC 4.3.3 EABI toolchain.</p>
</section>
<section id="nxflat-toolchain">
<h2>NXFLAT Toolchain<a class="headerlink" href="#nxflat-toolchain" title="Permalink to this heading"></a></h2>
<p>If you are <em>not</em> using the NuttX buildroot toolchain and you want to use
the NXFLAT tools, then you will still have to build a portion of the buildroot
tools – just the NXFLAT tools.  The buildroot with the NXFLAT tools can
be downloaded from the NuttX Bitbucket download site
(<a class="reference external" href="https://bitbucket.org/nuttx/nuttx/downloads/">https://bitbucket.org/nuttx/nuttx/downloads/</a>).</p>
<p>This GNU toolchain builds and executes in the Linux or Cygwin environment.</p>
<ol class="arabic">
<li><p>You must have already configured NuttX in &lt;some-dir&gt;/nuttx.</p>
<blockquote>
<div><p>tools/configure.sh lpcxpresso-lpc1768:&lt;sub-dir&gt;</p>
</div></blockquote>
</li>
<li><p>Download the latest buildroot package into &lt;some-dir&gt;</p></li>
<li><p>unpack the buildroot tarball.  The resulting directory may
have versioning information on it like buildroot-x.y.z.  If so,
rename &lt;some-dir&gt;/buildroot-x.y.z to &lt;some-dir&gt;/buildroot.</p></li>
<li><p>cd &lt;some-dir&gt;/buildroot</p></li>
<li><p>cp boards/cortexm3-defconfig-nxflat .config</p></li>
<li><p>make oldconfig</p></li>
<li><p>make</p></li>
<li><p>Make sure that the PATH variable includes the path to the newly built
NXFLAT binaries.</p></li>
</ol>
</section>
<section id="mbed">
<h2>mbed<a class="headerlink" href="#mbed" title="Permalink to this heading"></a></h2>
<p>The Nucleo-L476RG includes boot loader from mbed:</p>
<blockquote>
<div><p><a class="reference external" href="https://mbed.org/platforms/ST-Nucleo-L476RG/">https://mbed.org/platforms/ST-Nucleo-L476RG/</a>
<a class="reference external" href="https://mbed.org/handbook/Homepage">https://mbed.org/handbook/Homepage</a></p>
</div></blockquote>
<p>Using the mbed loader:</p>
<ol class="arabic simple">
<li><p>Connect the Nucleo-F4x1RE to the host PC using the USB connector.</p></li>
<li><p>A new file system will appear called NUCLEO; open it with Windows
Explorer (assuming that you are using Windows).</p></li>
<li><p>Drag and drop nuttx.bin into the MBED window.  This will load the
nuttx.bin binary into the Nucleo-F4x1RE.  The NUCLEO window will
close then re-open and the Nucleo-F4x1RE will be running the new code.</p></li>
</ol>
</section>
<section id="hardware">
<h2>Hardware<a class="headerlink" href="#hardware" title="Permalink to this heading"></a></h2>
<section id="gpio">
<h3>GPIO<a class="headerlink" href="#gpio" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SERIAL_TX=PA_2    USER_BUTTON=PC_13
SERIAL_RX=PA_3    LED1       =PA_5

A0=PA_0  USART2RX D0=PA_3            D8 =PA_9
A1=PA_1  USART2TX D1=PA_2            D9 =PC_7
A2=PA_4           D2=PA_10   WIFI_CS=D10=PB_6 SPI_CS
A3=PB_0  WIFI_INT=D3=PB_3            D11=PA_7 SPI_MOSI
A4=PC_1      SDCS=D4=PB_5            D12=PA_6 SPI_MISO
A5=PC_0   WIFI_EN=D5=PB_4       LED1=D13=PA_5 SPI_SCK
             LED2=D6=PB_10  I2C1_SDA=D14=PB_9 Probe
                  D7=PA_8   I2C1_SCL=D15=PB_8 Probe

From: https://mbed.org/platforms/ST-Nucleo-L476RG/
</pre></div>
</div>
</section>
<section id="buttons">
<h3>Buttons<a class="headerlink" href="#buttons" title="Permalink to this heading"></a></h3>
<p>B1 USER: the user button is connected to the I/O PC13 (pin 2) of the STM32
microcontroller.</p>
</section>
<section id="leds">
<h3>LEDs<a class="headerlink" href="#leds" title="Permalink to this heading"></a></h3>
<p>The Nucleo L476RG provides a single user LED, LD2.  LD2 is the green LED
connected to Arduino signal D13 corresponding to MCU I/O PA5 (pin 21) or
PB13 (pin 34) depending on the STM32target.</p>
<ul class="simple">
<li><p>When the I/O is HIGH value, the LED is on.</p></li>
<li><p>When the I/O is LOW, the LED is off.</p></li>
</ul>
<p>These LEDs are not used by the board port unless CONFIG_ARCH_LEDS is
defined.  In that case, the usage by the board port is defined in
include/board.h and src/sam_leds.c. The LEDs are used to encode OS-related
events as follows when the red LED (PE24) is available:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SYMBOL</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>LD2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LED_STARTED</p></td>
<td><p>NuttX has been started</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_HEAPALLOCATE</p></td>
<td><p>Heap has been allocated</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_IRQSENABLED</p></td>
<td><p>Interrupts enabled</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_STACKCREATED</p></td>
<td><p>Idle stack created</p></td>
<td><p>ON</p></td>
</tr>
<tr class="row-even"><td><p>LED_INIRQ</p></td>
<td><p>In an interrupt</p></td>
<td><p>No change</p></td>
</tr>
<tr class="row-odd"><td><p>LED_SIGNAL</p></td>
<td><p>In a signal handler</p></td>
<td><p>No change</p></td>
</tr>
<tr class="row-even"><td><p>LED_ASSERTION</p></td>
<td><p>An assertion failed</p></td>
<td><p>No change</p></td>
</tr>
<tr class="row-odd"><td><p>LED_PANIC</p></td>
<td><p>The system has crashed</p></td>
<td><p>Blinking</p></td>
</tr>
<tr class="row-even"><td><p>LED_IDLE</p></td>
<td><p>MCU is is sleep mode</p></td>
<td><p>Not used</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Thus if LD2, NuttX has successfully booted and is, apparently, running
normally.  If LD2 is flashing at approximately 2Hz, then a fatal error
has been detected and the system has halted.</p>
</section>
</section>
<section id="serial-consoles">
<h2>Serial Consoles<a class="headerlink" href="#serial-consoles" title="Permalink to this heading"></a></h2>
<section id="usart1">
<h3>USART1<a class="headerlink" href="#usart1" title="Permalink to this heading"></a></h3>
<p>Pins and Connectors:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RXD: PA11  CN10 pin 14
     PB7   CN7 pin 21
TXD: PA10  CN9 pin 3, CN10 pin 33
     PB6   CN5 pin 3, CN10 pin 17
</pre></div>
</div>
<p>NOTE:  You may need to edit the include/board.h to select different USART1
pin selections.</p>
<p>TTL to RS-232 converter connection:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Nucleo CN10 STM32F4x1RE
----------- ------------
Pin 21 PA9  USART1_RX   *Warning you make need to reverse RX/TX on
Pin 33 PA10 USART1_TX    some RS-232 converters
Pin 20 GND
Pin 8  U5V
</pre></div>
</div>
<p>To configure USART1 as the console:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_USART1=y
CONFIG_USART1_SERIALDRIVER=y
CONFIG_USART1_SERIAL_CONSOLE=y
CONFIG_USART1_RXBUFSIZE=256
CONFIG_USART1_TXBUFSIZE=256
CONFIG_USART1_BAUD=115200
CONFIG_USART1_BITS=8
CONFIG_USART1_PARITY=0
CONFIG_USART1_2STOP=0
</pre></div>
</div>
</section>
<section id="usart2">
<h3>USART2<a class="headerlink" href="#usart2" title="Permalink to this heading"></a></h3>
<p>Pins and Connectors:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RXD: PA3   CN9 pin 1 (See SB13, 14, 62, 63). CN10 pin 37
     PD6
TXD: PA2   CN9 pin 2(See SB13, 14, 62, 63). CN10 pin 35
     PD5
</pre></div>
</div>
<p>UART2 is the default in all of these configurations.</p>
<p>TTL to RS-232 converter connection:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Nucleo CN9  STM32F4x1RE
----------- ------------
Pin 1  PA3  USART2_RX   *Warning you make need to reverse RX/TX on
Pin 2  PA2  USART2_TX    some RS-232 converters
</pre></div>
</div>
<p>Solder Bridges.  This configuration requires:</p>
<ul class="simple">
<li><p>SB62 and SB63 Closed: PA2 and PA3 on STM32 MCU are connected to D1 and D0
(pin 7 and pin 8) on Arduino connector CN9 and ST Morpho connector CN10
as USART signals.  Thus SB13 and SB14 should be OFF.</p></li>
<li><p>SB13 and SB14 Open:  PA2 and PA3 on STM32F103C8T6 (ST-LINK MCU) are
disconnected to PA3 and PA2 on STM32 MCU.</p></li>
</ul>
<p>To configure USART2 as the console:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_USART2=y
CONFIG_USART2_SERIALDRIVER=y
CONFIG_USART2_SERIAL_CONSOLE=y
CONFIG_USART2_RXBUFSIZE=256
CONFIG_USART2_TXBUFSIZE=256
CONFIG_USART2_BAUD=115200
CONFIG_USART2_BITS=8
CONFIG_USART2_PARITY=0
CONFIG_USART2_2STOP=0
</pre></div>
</div>
</section>
<section id="usart6">
<h3>USART6<a class="headerlink" href="#usart6" title="Permalink to this heading"></a></h3>
<p>Pins and Connectors:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RXD: PC7    CN5 pin2, CN10 pin 19
     PA12   CN10, pin 12
TXD: PC6    CN10, pin 4
     PA11   CN10, pin 14
</pre></div>
</div>
<p>To configure USART6 as the console:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_USART6=y
CONFIG_USART6_SERIALDRIVER=y
CONFIG_USART6_SERIAL_CONSOLE=y
CONFIG_USART6_RXBUFSIZE=256
CONFIG_USART6_TXBUFSIZE=256
CONFIG_USART6_BAUD=115200
CONFIG_USART6_BITS=8
CONFIG_USART6_PARITY=0
CONFIG_USART6_2STOP=0
</pre></div>
</div>
</section>
<section id="virtual-com-port">
<h3>Virtual COM Port<a class="headerlink" href="#virtual-com-port" title="Permalink to this heading"></a></h3>
<p>Yet another option is to use UART2 and the USB virtual COM port.  This
option may be more convenient for long term development, but is painful
to use during board bring-up.</p>
<p>Solder Bridges.  This configuration requires:</p>
<ul class="simple">
<li><p>SB62 and SB63 Open: PA2 and PA3 on STM32 MCU are disconnected to D1
and D0 (pin 7 and pin 8) on Arduino connector CN9 and ST Morpho
connector CN10.</p></li>
<li><p>SB13 and SB14 Closed:  PA2 and PA3 on STM32F103C8T6 (ST-LINK MCU) are
connected to PA3 and PA2 on STM32 MCU to have USART communication
between them. Thus SB61, SB62 and SB63 should be OFF.</p></li>
</ul>
<p>Configuring USART2 is the same as given above.</p>
<p>Question:  What BAUD should be configure to interface with the Virtual
COM port?  115200 8N1?</p>
</section>
<section id="default">
<h3>Default<a class="headerlink" href="#default" title="Permalink to this heading"></a></h3>
<p>As shipped, SB62 and SB63 are open and SB13 and SB14 closed, so the
virtual COM port is enabled.</p>
</section>
</section>
<section id="shields">
<h2>Shields<a class="headerlink" href="#shields" title="Permalink to this heading"></a></h2>
<section id="rs-232-from-cutedigi-com">
<h3>RS-232 from Cutedigi.com<a class="headerlink" href="#rs-232-from-cutedigi-com" title="Permalink to this heading"></a></h3>
<p>Supports a single RS-232 connected via</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Nucleo CN9</p></th>
<th class="head"><p>STM32F4x1RE</p></th>
<th class="head"><p>Cutedigi</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pin 1  PA3</p></td>
<td><p>USART2_RX</p></td>
<td><p>RXD</p></td>
</tr>
<tr class="row-odd"><td><p>Pin 2  PA2</p></td>
<td><p>USART2_TX</p></td>
<td><p>TXD</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Support for this shield is enabled by selecting USART2 and configuring
SB13, 14, 62, and 63 as described above under “Serial Consoles”</p>
</section>
<section id="itead-joystick-shield">
<h3>Itead Joystick Shield<a class="headerlink" href="#itead-joystick-shield" title="Permalink to this heading"></a></h3>
<p>See <a class="reference external" href="http://imall.iteadstudio.com/im120417014.html">http://imall.iteadstudio.com/im120417014.html</a> for more information
about this joystick.</p>
<p>Itead Joystick Connection:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ARDUINO</p></th>
<th class="head"><p>ITEAD</p></th>
<th class="head"><p>NUCLEO=F4x1</p></th>
</tr>
<tr class="row-even"><th class="head"><p>PIN NAME</p></th>
<th class="head"><p>SIGNAL</p></th>
<th class="head"><p>SIGNAL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>D3</p></td>
<td><p>Button E Output</p></td>
<td><p>PB3</p></td>
</tr>
<tr class="row-even"><td><p>D4</p></td>
<td><p>Button D Output</p></td>
<td><p>PB5</p></td>
</tr>
<tr class="row-odd"><td><p>D5</p></td>
<td><p>Button C Output</p></td>
<td><p>PB4</p></td>
</tr>
<tr class="row-even"><td><p>D6</p></td>
<td><p>Button B Output</p></td>
<td><p>PB10</p></td>
</tr>
<tr class="row-odd"><td><p>D7</p></td>
<td><p>Button A Output</p></td>
<td><p>PA8</p></td>
</tr>
<tr class="row-even"><td><p>D8</p></td>
<td><p>Button F Output</p></td>
<td><p>PA9</p></td>
</tr>
<tr class="row-odd"><td><p>D9</p></td>
<td><p>Button G Output</p></td>
<td><p>PC7</p></td>
</tr>
<tr class="row-even"><td><p>A0</p></td>
<td><p>Joystick Y Output</p></td>
<td><p>PA0  ADC1_0</p></td>
</tr>
<tr class="row-odd"><td><p>A1</p></td>
<td><p>Joystick X Output</p></td>
<td><p>PA1  ADC1_1</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All buttons are pulled on the shield.  A sensed low value indicates
when the button is pressed.</p>
<p>NOTE: Button F cannot be used with the default USART1 configuration
because PA9 is configured for USART1_RX by default.  Use select
different USART1 pins in the board.h file or select a different
USART or select CONFIG_NUCLEO_L476RG_AJOY_MINBUTTONS which will
eliminate all but buttons A, B, and C.</p>
<p>Itead Joystick Signal interpretation:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>BUTTON</p></th>
<th class="head"><p>TYPE</p></th>
<th class="head"><p>NUTTX ALIAS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Button A</p></td>
<td><p>Large button A</p></td>
<td><p>JUMP/BUTTON 3</p></td>
</tr>
<tr class="row-odd"><td><p>Button B</p></td>
<td><p>Large button B</p></td>
<td><p>FIRE/BUTTON 2</p></td>
</tr>
<tr class="row-even"><td><p>Button C</p></td>
<td><p>Joystick select button</p></td>
<td><p>SELECT/BUTTON 1</p></td>
</tr>
<tr class="row-odd"><td><p>Button D</p></td>
<td><p>Tiny Button D</p></td>
<td><p>BUTTON 6</p></td>
</tr>
<tr class="row-even"><td><p>Button E</p></td>
<td><p>Tiny Button E</p></td>
<td><p>BUTTON 7</p></td>
</tr>
<tr class="row-odd"><td><p>Button F</p></td>
<td><p>Large Button F</p></td>
<td><p>BUTTON 4</p></td>
</tr>
<tr class="row-even"><td><p>Button G</p></td>
<td><p>Large Button G</p></td>
<td><p>BUTTON 5</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Itead Joystick configuration settings:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>System Type -&gt; STM32 Peripheral Support
  CONFIG_STM32_ADC1=y              : Enable ADC1 driver support

Drivers
  CONFIG_ANALOG=y                  : Should be automatically selected
  CONFIG_ADC=y                     : Should be automatically selected
  CONFIG_INPUT=y                   : Select input device support
  CONFIG_INPUT_AJOYSTICK=y         : Select analog joystick support
</pre></div>
</div>
<p>There is nothing in the configuration that currently uses the joystick.
For testing, you can add the following configuration options to enable the
analog joystick example at apps/examples/ajoystick:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_NSH_ARCHINIT=y
CONFIG_EXAMPLES_AJOYSTICK=y
CONFIG_EXAMPLES_AJOYSTICK_DEVNAME=&quot;/dev/ajoy0&quot;
</pre></div>
</div>
<p>STATUS:
2014-12-04:</p>
<ul class="simple">
<li><p>Without ADC DMA support, it is not possible to sample both X and Y
with a single ADC.  Right now, only one axis is being converted.</p></li>
<li><p>There is conflicts with some of the Arduino data pins and the
default USART1 configuration.  I am currently running with USART1
but with CONFIG_NUCLEO_L476RG_AJOY_MINBUTTONS to eliminate the
conflict.</p></li>
<li><p>Current showstopper: I appear to be getting infinite interrupts as
soon as joystick button interrupts are enabled.</p></li>
</ul>
</section>
</section>
<section id="other-external-hardware-devices">
<h2>Other External Hardware/Devices<a class="headerlink" href="#other-external-hardware-devices" title="Permalink to this heading"></a></h2>
<section id="using-external-spi-sdcard">
<h3>Using external SPI SDCard<a class="headerlink" href="#using-external-spi-sdcard" title="Permalink to this heading"></a></h3>
<p>It is possible to use external SDCard over SPI with the
nucleo-stm32l476rg Cortex-M4. This option will or can broaden the
functionality in your project, solution or application.</p>
<p>In this NuttX project we attach an MH-SD Card Module (SPI).
[<a class="reference external" href="http://www.geeetech.com/wiki/index.php/Arduino_SD_card_Module">http://www.geeetech.com/wiki/index.php/Arduino_SD_card_Module</a>]</p>
<p>Other solutions should also work.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Nucleo CN10</p></th>
<th class="head"><p>STM32L4x6RG</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pin 31  PB3</p></td>
<td><p>SLCK</p></td>
</tr>
<tr class="row-odd"><td><p>Pin 27  PB4</p></td>
<td><p>MISO</p></td>
</tr>
<tr class="row-even"><td><p>Pin 29  PB5</p></td>
<td><p>MOSI</p></td>
</tr>
<tr class="row-odd"><td><p>Pin 25  PB10</p></td>
<td><p>CS</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Nucleo CN7</p></th>
<th class="head"><p>STM32L4x6RG</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pin 18  +5V</p></td>
<td><p>5V</p></td>
</tr>
<tr class="row-odd"><td><p>Pin 22  GND</p></td>
<td><p>GND</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>On the board the pins are labeled and are corresponding with the functions
as written before.
Configuring can be done by using ./tools/configure.sh nucleo-l476rg/spimmcsd</p>
</section>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at apps/examples/nsh for the
Nucleo-L476RG board.  The Configuration enables the serial interfaces
on UART2.  Support for builtin applications is enabled, but in the base
configuration no builtin applications are selected (see NOTES below).</p>
<p>NOTES:</p>
<ol class="arabic">
<li><p>This configuration uses the mconf-based configuration tool.  To
change this configuration using that tool, you should:</p>
<ol class="loweralpha simple">
<li><p>Build and install the kconfig-mconf tool.  See nuttx/README.txt
see additional README.txt files in the NuttX tools repository.</p></li>
<li><p>Execute ‘make menuconfig’ in nuttx/ in order to start the
reconfiguration process.</p></li>
</ol>
</li>
<li><p>By default, this configuration uses the ARM EABI toolchain
for Linux.  That can easily be reconfigured, of course.:</p>
<blockquote>
<div><p>CONFIG_HOST_LINUX=y                     : Builds under Linux
CONFIG_ARM_TOOLCHAIN_GNU_EABI=y      : GNU EABI toolchain for Linux</p>
</div></blockquote>
</li>
<li><p>Although the default console is USART2 (which would correspond to
the Virtual COM port) I have done all testing with the console
device configured for USART1 (see instruction above under “Serial
Consoles).  I have been using a TTL-to-RS-232 converter connected
as shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Nucleo CN10 STM32F4x1RE
----------- ------------
Pin 21 PA9  USART1_RX   *Warning you make need to reverse RX/TX on
Pin 33 PA10 USART1_TX    some RS-232 converters
Pin 20 GND
Pin 8  U5V
</pre></div>
</div>
</li>
</ol>
</section>
<section id="nxdemo">
<h3>nxdemo<a class="headerlink" href="#nxdemo" title="Permalink to this heading"></a></h3>
<p>This is an NSH configuration that enables the NX graphics demo at
apps/examples/nxdemo.  It uses the PCD8544 display on SPI1.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../nucleo-l452re/index.html" class="btn btn-neutral float-left" title="ST Nucleo L452RE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nucleo-l496zg/index.html" class="btn btn-neutral float-right" title="ST Nucleo L496ZG" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>