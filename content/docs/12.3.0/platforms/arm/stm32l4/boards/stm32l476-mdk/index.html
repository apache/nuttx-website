<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STM32L476-mdk &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="ST STM32L476VG-DISCO" href="../stm32l476vg-disco/index.html" />
    <link rel="prev" title="ST STEVAL-STLCS01V1" href="../steval-stlcs01v1/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a64/index.html">Allwinner A64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">ST STM32L4</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#supported-mcus">Supported MCUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../b-l475e-iot01a/index.html">ST B-L475E-IOT01A</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l432kc/index.html">ST Nucleo L432KC</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l452re/index.html">ST Nucleo L452RE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l476rg/index.html">ST Nucleo L476RG</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l496zg/index.html">ST Nucleo L496ZG</a></li>
<li class="toctree-l5"><a class="reference internal" href="../steval-stlcs01v1/index.html">ST STEVAL-STLCS01V1</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">STM32L476-mdk</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32l476vg-disco/index.html">ST STM32L476VG-DISCO</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32l4r9ai-disco/index.html">ST STM32L4R9AI-DISCO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">AVR8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">ST STM32L4</a></li>
      <li class="breadcrumb-item active">STM32L476-mdk</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/stm32l4/boards/stm32l476-mdk/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="stm32l476-mdk">
<h1>STM32L476-mdk<a class="headerlink" href="#stm32l476-mdk" title="Permalink to this heading"></a></h1>
<p>This page discusses issues unique to NuttX configurations for STM32L476ME
part in the Motorola MDK.  This is referred to as the MuC in Motorola
technical documentation.</p>
<p>STM32L476ME:</p>
<ul class="simple">
<li><p>Microprocessor: 32-bit ARM Cortex M4 at 80MHz STM32L476ME</p></li>
<li><p>Memory: 1024 KB Flash and 96+32 KB SRAM</p></li>
<li><p>ADC: 3x12-bit, 2.4 MSPS A/D converter: up to 24 channels</p></li>
<li><p>DMA: 16-stream DMA controllers with FIFOs and burst support</p></li>
<li><p>Timers:Up to 11 timers: up to eight 16-bit, two 32-bit timers, two
watchdog timers, and a SysTick timer</p></li>
<li><p>GPIO: Up to 51 I/O ports with interrupt capability</p></li>
<li><p>I2C: Up to 3 x I2C interfaces</p></li>
<li><p>USARTs: Up to 3 USARTs, 2 UARTs, 1 LPUART</p></li>
<li><p>SPIs: Up to 3 SPIs</p></li>
<li><p>SAIs: Up to 2 dual-channel audio interfaces</p></li>
<li><p>CAN interface</p></li>
<li><p>SDIO interface (not connected)</p></li>
<li><p>QSPI interface (not connected)</p></li>
<li><p>USB: USB 2.0 full-speed device/host/OTG controller with on-chip PHY</p></li>
<li><p>CRC calculation unit</p></li>
<li><p>RTC</p></li>
</ul>
<section id="acronyms">
<h2>Acronyms<a class="headerlink" href="#acronyms" title="Permalink to this heading"></a></h2>
<p>MDK is, of course, the Motorola Development Kit.
MuC is the acronym that is used to refer to the STM32L476ME on the MDK board.
MHB is the acronym given to Toshiba Interface Bridge, part number T6WV7XBG.
See <a class="reference external" href="https://toshiba.semicon-storage.com/us/product/assp/interface-bridge.html">https://toshiba.semicon-storage.com/us/product/assp/interface-bridge.html</a>
NuttX runs the MuC.</p>
</section>
<section id="flashing">
<h2>Flashing<a class="headerlink" href="#flashing" title="Permalink to this heading"></a></h2>
<p>The MDK has a built-in FTDI to support flashing from openocd.  There are a
few extensions to openocd that haven’t been integrated upstream yet.  To
flash (or debug) the MDK, you will need the code from:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/MotorolaMobilityLLC/openocd
</pre></div>
</div>
<p>Refer to detailed OpenOCD build instructions at developer.motorola.com</p>
<p>After building, you can flash the STM32L476 (MuC) with the following
command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ openocd -f board/moto_mdk_muc.cfg -c &quot;program nuttx.bin 0x08000000 reset exit&quot;
</pre></div>
</div>
<p>You may need to be super-user in order access the USB device.</p>
<p>NOTE:  In order for the debug Type C connector to power the phone, the DIP
Switch B4 must be in the ON position.  See the MDK User Guide at
developer.motorola.com for more information on the hardware including the DIP
switches.</p>
<p>Or you can use the GDB server.  To start the GDB server:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ openocd -f board/moto_mdk_mu_reset.cfg &amp;
</pre></div>
</div>
<p>Then start GDB:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ arm-none-linux-gdb
(gdb) target extended-remote localhost:3333
(gdb) set can-use-hw-watchpoints 1
</pre></div>
</div>
<p>You can load code into FLASH like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(gdb) mon halt
(gdb) load nuttx
(gdb) file nuttx
(gdb) mon reset
</pre></div>
</div>
<p>NOTE:  There is a special version of GDB 7.11 available with some additional,
MDK-specific features.  It is available in a MotorolaMobilityLLC github.com
repository.</p>
</section>
<section id="serial-console">
<h2>Serial Console<a class="headerlink" href="#serial-console" title="Permalink to this heading"></a></h2>
<p>The serial console is configured on USART3 using MUC_UART3_TX (PC10) and
MUC_UART_RX (PC11).  This connects to the FT4232 part which supports 4
CDC/ACM serial ports.  The MuC console is on port C which will probably be
/dev/ttyUSB2 on your Linux host.  Port A (ttyUSB0) is the MuC SWD debug
interface.  Ports B and D are the MHB debug and console ports, respectively.</p>
<p>The serial terminal that you use must be configured to use the /dev/ttyUSB2
device at 11500 baud, no parity, 8 bits of data, 1 stop bit (115200 8N1 in
minicom-speak) and with no flow control.  Minicom works well.</p>
<p>You will probably need to be super-user in order access the /dev/ttyUSB2
device:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo minicom mdk
</pre></div>
</div>
<p>When mdk is the name of my saved configuration using the above serial
configuration.</p>
<p>The Motorola documentation also mentions picocom.  NSH also works well with
picocom:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo apt install picocom
$ sudo picocom -b 115200 /dev/ttyUSB2
</pre></div>
</div>
<p>Everything else defaults correctly.  Ctrl-A then Ctrl-X will terminate
either the minicom or the picocom session.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../steval-stlcs01v1/index.html" class="btn btn-neutral float-left" title="ST STEVAL-STLCS01V1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../stm32l476vg-disco/index.html" class="btn btn-neutral float-right" title="ST STM32L476VG-DISCO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>