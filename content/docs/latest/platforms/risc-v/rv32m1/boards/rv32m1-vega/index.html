<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RV32M1-VEGA &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
      <script src="../../../../../_static/jquery.js"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
      <script src="../../../../../_static/doctools.js"></script>
      <script src="../../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../../_static/clipboard.min.js"></script>
      <script src="../../../../../_static/copybutton.js"></script>
      <script src="../../../../../_static/design-tabs.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="SOPHGO SG2000" href="../../../sg2000/index.html" />
    <link rel="prev" title="NXP RV32M1" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../../../12.10.0" >12.10.0</option>
    
    <option value="../../../../../../12.11.0" >12.11.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../arm/index.html">ARM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">RISC-V</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../bl602/index.html">Bouffalo Lab BL602</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bl808/index.html">Bouffalo Lab BL808</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c906/index.html">THEAD C906</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eic7700x/index.html">ESWIN EIC7700X</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c3-legacy/index.html">Espressif ESP32-C3 (Legacy)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c3/index.html">Espressif ESP32-C3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c6/index.html">Espressif ESP32-C6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32h2/index.html">Espressif ESP32-H2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fe310/index.html">SiFive FE310</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hpm6000/index.html">Hpmicro HPM6000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hpm6750/index.html">Hpmicro HPM6750</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../jh7110/index.html">StarFive JH7110</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../k210/index.html">Kendryte K210</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../k230/index.html">Kendryte K230</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../litex/index.html">Enjoy Digital LiteX FPGA’s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mpfs/index.html">Microchip PolarFire® SoC FPGA’s (MPFS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu-rv/index.html">QEMU Generic RV32/RV64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp23xx-rv/index.html">Raspberry Pi rp2350 RISC-V</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">NXP RV32M1</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">RV32M1-VEGA</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sg2000/index.html">SOPHGO SG2000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_linux.html">Network Support on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_vpnkit.html">Network support with VPNKit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">RISC-V</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">NXP RV32M1</a></li>
      <li class="breadcrumb-item active">RV32M1-VEGA</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/platforms/risc-v/rv32m1/boards/rv32m1-vega/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rv32m1-vega">
<h1>RV32M1-VEGA<a class="headerlink" href="#rv32m1-vega" title="Permalink to this heading"></a></h1>
<p class="tags"><span>Tags: </span><a class="sd-sphinx-override sd-badge sd-bg-primary sd-bg-text-primary reference internal" href="../../../../../_tags/arch-riscv.html"><span class="doc">arch:riscv</span></a><span> </span><a class="sd-sphinx-override sd-badge sd-bg-primary sd-bg-text-primary reference internal" href="../../../../../_tags/vendor-vega.html"><span class="doc">vendor:vega</span></a><span> </span><a class="sd-sphinx-override sd-badge sd-bg-warning sd-bg-text-warning reference internal" href="../../../../../_tags/experimental.html"><span class="doc">experimental</span></a></p>
<figure class="align-center" id="id2" style="width: 40%">
<img alt="The RV32M1-VEGA development board." src="../../../../../_images/rv32m1-vega.png" />
<figcaption>
<p><span class="caption-text">The RV32M1-VEGA development board.</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The RV32M1 is a heterogeneous SoC including an ARM Cortex-M4 CPU, an ARM
Cortex-M0+ CPU, a RISC-V RI5CY CPU, and a RISC-V ZERO_RISCY CPU. The SOC
integrates 1.25 MB flash, 384 KB SRAM, and a variety of peripherals.</p>
<p>Refer to <a class="reference external" href="https://open-isa.org">https://open-isa.org</a> for further information about this board.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently NuttX is ported to RV32M1 RI5CY only. RI5CY is RV32IMC RISC-V CPU
with PULP extensions features:</p>
<ul class="simple">
<li><p>Post-Incrementing load and stores,</p></li>
<li><p>Multiply-Accumulate extensions,</p></li>
<li><p>ALU extensions,</p></li>
<li><p>Hardware Loops.</p></li>
</ul>
</div>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>On-board OpenSDA Debug Adapter,</p></li>
<li><p>USB Device Port,</p></li>
<li><p>FXOS8700CQ Digital Combo Sensor: 3D Accelerometer + 3D Magnetometer,</p></li>
<li><p>Wirless Abilities: BLE, Generic FSK, and IEEE Std.802.15.4(Thread),</p></li>
<li><p>ONE user RGB LED,</p></li>
<li><p>Four user push-buttons,</p></li>
<li><p>4 MB external SPI Flash,</p></li>
<li><p>Micro-SD Card Slot on the backside,</p></li>
<li><p>Arduino R3 Compatible IO Header.</p></li>
</ul>
</section>
<section id="buttons-and-leds">
<h2>Buttons and LEDs<a class="headerlink" href="#buttons-and-leds" title="Permalink to this heading"></a></h2>
<p>The RV32M1-VEGA board has <strong>one</strong> user RGB LED; only the red part of the LED is
used to indicate an interrupt request is being serviced.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SYMBOL</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>RED*</p></th>
<th class="head"><p>GREEN</p></th>
<th class="head"><p>BLUE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LED_STARTED</p></td>
<td><p>NuttX has been started</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_HEAPALLOCATE</p></td>
<td><p>Heap has been allocated</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_IRQSENABLED</p></td>
<td><p>Interrupts enabled</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_STACKCREATED</p></td>
<td><p>Idle stack created</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_INIRQ</p></td>
<td><p>In an interrupt**</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_SIGNAL</p></td>
<td><p>In a signal handler***</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_ASSERTION</p></td>
<td><p>An assertion failed</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_PANIC</p></td>
<td><p>The system has crashed</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_CPU</p></td>
<td><p>Interrupt service</p></td>
<td><p>ON</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
</tbody>
</table>
<p>Four tactile buttons are populated on RV32M1-VEGA board:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>NAME</p></th>
<th class="head"><p>PIN</p></th>
<th class="head"><p>EXTERNAL-PULLUP</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SW2</p></td>
<td><p>PA0</p></td>
<td><p>YES</p></td>
</tr>
<tr class="row-odd"><td><p>SW3</p></td>
<td><p>PE8</p></td>
<td><p>NO</p></td>
</tr>
<tr class="row-even"><td><p>SW4</p></td>
<td><p>PE9</p></td>
<td><p>NO</p></td>
</tr>
<tr class="row-odd"><td><p>SW5</p></td>
<td><p>PE12</p></td>
<td><p>NO</p></td>
</tr>
</tbody>
</table>
<p>All of these buttons can be used as interrupt and wake up sources, while SW2 can
be an alternative NMI Source.</p>
</section>
<section id="itcm">
<h2>ITCM<a class="headerlink" href="#itcm" title="Permalink to this heading"></a></h2>
<p>A 64KB ITCM is coupled with M4 Cores, RI5CY CPU or ARM Cortex-M4 CPU. If the
ITCM is selected, Critical Codes including but not limited to Exception Vectors,
Interrupt Service Routines will be placed in ITCM.</p>
</section>
<section id="tstmr">
<h2>TSTMR<a class="headerlink" href="#tstmr" title="Permalink to this heading"></a></h2>
<p>TSTMR Module is embedded in RV32M1 to provide system time stamp. It runs off
1MHz with a 56-bit counter, and can be adopted to get more accurate delay
counting. If the module is selected, a hardware delay method will replace
<code class="docutils literal notranslate"><span class="pre">up_mdelay</span></code> and <code class="docutils literal notranslate"><span class="pre">up_udelay</span></code>, the built-in software delay methods.</p>
</section>
<section id="pin-mapping">
<h2>Pin Mapping<a class="headerlink" href="#pin-mapping" title="Permalink to this heading"></a></h2>
<section id="lpuart-pins">
<h3>LPUART Pins<a class="headerlink" href="#lpuart-pins" title="Permalink to this heading"></a></h3>
<p>LPUART0:</p>
<ul class="simple">
<li><p>RX: PC7, PB25, PA2</p></li>
<li><p>TX: PC8, PB26, PA3</p></li>
</ul>
<p>LPUART1:</p>
<ul class="simple">
<li><p>RX: PB2, PC29, PA2, PA25</p></li>
<li><p>TX: PB3, PC30, PA3, PA26</p></li>
</ul>
<p>LPUART2:</p>
<ul class="simple">
<li><p>RX: PB11, PB18, PB1</p></li>
<li><p>TX: PB12, PB19, PB0</p></li>
</ul>
<p>LPUART3:</p>
<ul class="simple">
<li><p>RX: PB28, PE8, PE29</p></li>
<li><p>TX: PB29, PE9, PE30</p></li>
</ul>
<p>LPUART0 is enabled in most configurations. RX and TX are configured on pins PC7
and PC8, respectively. These two above pins are connected to onboard Debug
Adapter which provides a USB- TTL serial channel.</p>
</section>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>It is preferable to use OPEN ISA gcc Toolchain to exploit RV32M1 RI5CY
capabilities, though the generic GNU RVG Toolchain can generate binary codes
running on RV32M1 RI5CY without any problems. To switch generic GNU RVG
Toolchain to OPEN ISA Toolchain, the following option must be selected in the
Kconfig menu:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Board Selection  ---&gt;
  [*] Utilize OPEN ISA Toolchain
</pre></div>
</div>
<p>Make sure the OPEN ISA Toolchain has been installed and can be found in <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p>
</section>
<section id="building-nuttx">
<h2>Building NuttX<a class="headerlink" href="#building-nuttx" title="Permalink to this heading"></a></h2>
<p>The RI5CY Core supports hardware loop with 6 hardware loop registers assistance,
these registers could be overwritten when contexts switch. If code is generated
by OPEN ISA Toolchain and <code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_RISCV_INTXCPT_EXTREGS</span></code> is not less than
6, the RI5CY specific architecture flag will be passed to the <code class="docutils literal notranslate"><span class="pre">gcc</span></code> compiler.
In that case, the 6 hardware loop registers must be saved and restored in
interrupt routines with the general purpose registers.</p>
<p>You will see the following lines in Make.defs file:</p>
<div class="highlight-make notranslate"><div class="highlight"><pre><span></span><span class="nv">ARCHCPURV32IM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-march<span class="o">=</span>rv32imc<span class="w"> </span>-mabi<span class="o">=</span>ilp32

<span class="cp">ifeq ($(CONFIG_RV32M1_OPENISA_TOOLCHAIN),y)</span>
<span class="cp">  ifdef CONFIG_ARCH_RISCV_INTXCPT_EXTREGS</span>
<span class="cp">    ifeq ($(filter 0 1 2 3 4 5 , $(CONFIG_ARCH_RISCV_INTXCPT_EXTREGS)),)</span>
<span class="w">      </span><span class="nv">ARCHCPURV32IM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-march<span class="o">=</span>rv32imcxpulpv2
<span class="cp">    endif</span>
<span class="cp">  endif</span>
<span class="cp">endif</span>

<span class="nv">ARCHCPUFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>ARCHCPURV32IM<span class="k">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_RISV_INTXCPT_EXTREGS</span></code> could be configured in the following menu:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>System Type  ---&gt;
  [*] RISC-V Integer Context Extensions
  (6)   Number of Extral RISC-V Integer Context Registers
</pre></div>
</div>
</section>
<section id="flashing">
<h2>Flashing<a class="headerlink" href="#flashing" title="Permalink to this heading"></a></h2>
<p>To program the RV32M1, OpenOCD from OPEN ISA and an external JTAG adapter are
prerequisites. There are 2 tested JTAG adapters:</p>
<ul class="simple">
<li><p>Segger Jlink EDU mini</p></li>
<li><p>SiPEED USB JTAG Adapter</p></li>
</ul>
<p>The Segger Jlink EDU mini can connect J55 header on RV32M1-VEGA board directly
while SiPEED USB JTAG Adapter has to co-operate with an adapter board to setup
wires connection. Compared to the Segger Jlink EDU Mini adapter, SiPEED USB JTAG
Adapter is cheaper but not inferior.</p>
<p>With SiPEED USB Jtag Adapter, some patches must be applied to <code class="docutils literal notranslate"><span class="pre">rv32m1_ri5cy.cfg</span></code>:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- a/rv32m1_ri5cy.cfg</span>
<span class="gi">+++ b/rv32m1_ri5cy.cfg</span>
<span class="gu">@@ -2,7 +2,11 @@ set _WORKAREASIZE 0x2000</span>

<span class="w"> </span>adapter_khz 1000

<span class="gd">-interface jlink</span>
<span class="gi">+interface ftdi</span>
<span class="gi">+ftdi_vid_pid 0x0403 0x6010</span>
<span class="gi">+ftdi_layout_init 0x0508 0x0f1b</span>
<span class="gi">+ftdi_layout_signal nTRST -data 0x0200 -noe 0x0100</span>
<span class="gi">+ftdi_layout_signal nSRST -data 0x0800 -noe 0x0400</span>
<span class="w"> </span>transport select jtag

<span class="w"> </span>set _WORKAREASIZE 0x1000
</pre></div>
</div>
<p>Make sure that RV32M1 boots RI5CY, and you do this <strong>ONLY ONCE</strong>. Refer to
RV32M1-VEGA quick start guide for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OPEN ISA Toolchain and <code class="docutils literal notranslate"><span class="pre">rv32m1_ri5cy.cfg</span></code> are contained in the RV32M1 SDK,
and the RV32M1-VEGA quick start guide can be found at the following link:
<a class="reference external" href="https://open-isa.org/downloads/">https://open-isa.org/downloads/</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">riscv64-unknown-elf-gdb</span></code> can not debug RV32M1 RISC-V Cores currently. GDB
from the OPEN ISA Toolchain seems to be the only option and can even debug
ELF files generated by <code class="docutils literal notranslate"><span class="pre">risc64-unknown-elf-*</span></code> tools.</p>
</div>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>You can configure NuttX using the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>./tools/configure.sh<span class="w"> </span>rv32m1-vega:&lt;config&gt;
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;config&gt;</span></code> is one of the configurations listed below.</p>
<p>All of the configurations can be compiled by the generic GNU RVG Toolchain and
OPEN ISA Toolchain.</p>
<section id="buttons">
<h3>buttons<a class="headerlink" href="#buttons" title="Permalink to this heading"></a></h3>
<p>This configuration is a variant of the NSH configuration used for demonstrating
the four buttons on RV32M1-VEGA board.</p>
<p>Example usage of buttons:</p>
<ol class="arabic">
<li><p>Start the buttons daemon:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; buttons</span>
</pre></div>
</div>
</li>
<li><p>Press and release SW2, SW3, SW4, SW5 as you wish. The button press/release
event messages will display in the console accordingly.</p></li>
</ol>
</section>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>This configuration is basic. <code class="docutils literal notranslate"><span class="pre">getprime</span></code> is included in this configuration to
determine performance of RV32M1 RI5CY Core.</p>
</section>
<section id="nsh-itcm">
<h3>nsh-itcm<a class="headerlink" href="#nsh-itcm" title="Permalink to this heading"></a></h3>
<p>This configuration is a variant of the NSH configuration used for demonstrating
ITCM. When ITCM is selected, RI5CY Exception Vectors and Interrupt Service
Routines are placed in ITCM. Performance can be calculated by <code class="docutils literal notranslate"><span class="pre">getprime</span></code>, and
you might find it deteriorated a little ironically. The drawback may be caused
by long jump frequently between ITCM and flash. Besides, an instruction cache is
enabled always after RI5CY resets, and amelioration could not be achieved with
even ITCM enabled.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>What if codes fulfill the 64KB ITCM ?</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../index.html" class="btn btn-neutral float-left" title="NXP RV32M1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../sg2000/index.html" class="btn btn-neutral float-right" title="SOPHGO SG2000" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>