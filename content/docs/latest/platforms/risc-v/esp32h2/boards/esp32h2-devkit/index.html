<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESP32-H2-DevKitM-1 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
      <script src="../../../../../_static/jquery.js"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
      <script src="../../../../../_static/doctools.js"></script>
      <script src="../../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../../_static/clipboard.min.js"></script>
      <script src="../../../../../_static/copybutton.js"></script>
      <script src="../../../../../_static/design-tabs.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="SiFive FE310" href="../../../fe310/index.html" />
    <link rel="prev" title="Espressif ESP32-H2" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../../../12.10.0" >12.10.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../arm/index.html">ARM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">RISC-V</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../bl602/index.html">Bouffalo Lab BL602</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bl808/index.html">Bouffalo Lab BL808</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c906/index.html">THEAD C906</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eic7700x/index.html">ESWIN EIC7700X</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c3-legacy/index.html">Espressif ESP32-C3 (Legacy)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c3/index.html">Espressif ESP32-C3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32c6/index.html">Espressif ESP32-C6</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Espressif ESP32-H2</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#esp32-h2-toolchain">ESP32-H2 Toolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#building-and-flashing-nuttx">Building and flashing NuttX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#debugging">Debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#id1">Managing esptool on virtual environment</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">ESP32-H2-DevKitM-1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../fe310/index.html">SiFive FE310</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hpm6000/index.html">Hpmicro HPM6000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../hpm6750/index.html">Hpmicro HPM6750</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../jh7110/index.html">StarFive JH7110</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../k210/index.html">Kendryte K210</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../k230/index.html">Kendryte K230</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../litex/index.html">Enjoy Digital LiteX FPGA’s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mpfs/index.html">Microchip PolarFire® SoC FPGA’s (MPFS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu-rv/index.html">QEMU Generic RV32/RV64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rv32m1/index.html">NXP RV32M1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sg2000/index.html">SOPHGO SG2000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_linux.html">Network Support on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_vpnkit.html">Network support with VPNKit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">RISC-V</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Espressif ESP32-H2</a></li>
      <li class="breadcrumb-item active">ESP32-H2-DevKitM-1</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/platforms/risc-v/esp32h2/boards/esp32h2-devkit/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="esp32-h2-devkitm-1">
<h1>ESP32-H2-DevKitM-1<a class="headerlink" href="#esp32-h2-devkitm-1" title="Permalink to this heading"></a></h1>
<p>ESP32-H2-DevKitM-1 is an entry-level development board based on Bluetooth® Low Energy and
IEEE 802.15.4 combo module ESP32-H2-MINI-1 or ESP32-H2-MINI-1U. You can find the board schematic
<a class="reference external" href="https://espressif-docs.readthedocs-hosted.com/projects/esp-dev-kits/en/latest/_static/esp32-h2-devkitm-1/esp32-h2-devkitm-1_v1.2_schematics_20230306.pdf">here</a>.</p>
<p>Most of the I/O pins on the ESP32-H2-MINI-1/1U module are broken out to the pin headers on
both sides of this board for easy interfacing. Developers can either connect peripherals with
jumper wires or mount ESP32-H2-DevKitM-1 on a breadboard.</p>
<figure class="align-center align-default" id="id1">
<img alt="ESP32-H2-DevKitM-1 Board Layout" src="../../../../../_images/esp32-h2-devkitm-1-isometric.png" />
<figcaption>
<p><span class="caption-text">ESP32-H2-DevKitM-1 Board Layout</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The block diagram below presents main components of the ESP32-H2-DevKitM-1.</p>
<figure class="align-center align-default" id="id2">
<img alt="ESP32-H2-DevKitM-1 Electrical Block Diagram" src="../../../../../_images/ESP32-H2-DevKitM-1-v1.0-block-diagram.png" />
<figcaption>
<p><span class="caption-text">ESP32-H2-DevKitM-1 Electrical Block Diagram</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="hardware-components">
<h2>Hardware Components<a class="headerlink" href="#hardware-components" title="Permalink to this heading"></a></h2>
<figure class="align-center align-default" id="id3">
<img alt="ESP32-H2-DevKitM-1 Hardware Components" src="../../../../../_images/esp32-h2-devkitm-1-v1.2-annotated-photo.png" />
<figcaption>
<p><span class="caption-text">ESP32-H2-DevKitM-1 Hardware Components</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="buttons-and-leds">
<h3>Buttons and LEDs<a class="headerlink" href="#buttons-and-leds" title="Permalink to this heading"></a></h3>
</section>
</section>
<section id="board-buttons">
<h2>Board Buttons<a class="headerlink" href="#board-buttons" title="Permalink to this heading"></a></h2>
<p>There are two buttons labeled Boot and RST. The RST button is not available
to software. It pulls the chip enable line that doubles as a reset line.</p>
<p>The BOOT button is connected to IO9. On reset it is used as a strapping
pin to determine whether the chip boots normally or into the serial
bootloader. After reset, however, the BOOT button can be used for software
input.</p>
</section>
<section id="board-leds">
<h2>Board LEDs<a class="headerlink" href="#board-leds" title="Permalink to this heading"></a></h2>
<p>There is one on-board LED that indicates the presence of power.
Another WS2812 LED is connected to GPIO8 and is available for software.</p>
<section id="current-measurement">
<h3>Current Measurement<a class="headerlink" href="#current-measurement" title="Permalink to this heading"></a></h3>
<p>The J5 headers on ESP32-H2-DevKitM-1 can be used for measuring the current
drawn by the ESP32-H2-MINI-1/1U module:</p>
<blockquote>
<div><ul class="simple">
<li><p>Remove the jumper: Power supply between the module and peripherals on the
board is cut off. To measure the module’s current, connect the board with an
ammeter via J5 headers;</p></li>
<li><p>Apply the jumper (factory default): Restore the board’s normal functionality.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using 3V3 and GND pin headers to power the board, please remove the J5 jumper,
and connect an ammeter in series to the external circuit to measure the module’s current.</p>
</div>
</section>
<section id="pin-mapping">
<h3>Pin Mapping<a class="headerlink" href="#pin-mapping" title="Permalink to this heading"></a></h3>
<figure class="align-center align-default" id="id4">
<img alt="ESP32-H2-DevKitM-1 pin layout" src="../../../../../_images/esp32-h2-devkitm-1-pin-layout.png" />
<figcaption>
<p><span class="caption-text">ESP32-H2-DevKitM-1 Pin Layout</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="configurations">
<h3>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h3>
<p>All of the configurations presented below can be tested by running the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./tools/configure.sh esp32h2-devkit:&lt;config_name&gt;
$ make flash ESPTOOL_PORT=/dev/ttyUSB0 -j
</pre></div>
</div>
<p>Where &lt;config_name&gt; is the name of board configuration you want to use, i.e.: nsh, buttons, wifi…
Then use a serial console terminal like <code class="docutils literal notranslate"><span class="pre">picocom</span></code> configured to 115200 8N1.</p>
</section>
</section>
<section id="adc">
<h2>adc<a class="headerlink" href="#adc" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">adc</span></code> configuration enables the ADC driver and the ADC example application.
ADC Unit 1 is registered to <code class="docutils literal notranslate"><span class="pre">/dev/adc0</span></code> with channels 0, 1, 2 and 3 enabled by default.
Currently, the ADC operates in oneshot mode.</p>
<p>More ADC channels can be enabled or disabled in <code class="docutils literal notranslate"><span class="pre">ADC</span> <span class="pre">Configuration</span></code> menu.</p>
<p>This example shows channels 0 and 1 connected to 3.3 V and channels 2 and 3 to GND (all readings
show in units of mV):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; adc -n 1
adc_main: g_adcstate.count: 1
adc_main: Hardware initialized. Opening the ADC device: /dev/adc0
Sample:
1: channel: 0 value: 3713
2: channel: 1 value: 3714
3: channel: 2 value: 1
4: channel: 3 value: 0
</pre></div>
</div>
</section>
<section id="bmp180">
<h2>bmp180<a class="headerlink" href="#bmp180" title="Permalink to this heading"></a></h2>
<p>This configuration enables the use of the BMP180 pressure sensor over I2C.
You can check that the sensor is working by using the <code class="docutils literal notranslate"><span class="pre">bmp180</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; bmp180
Pressure value = 91531
Pressure value = 91526
Pressure value = 91525
</pre></div>
</div>
</section>
<section id="coremark">
<h2>coremark<a class="headerlink" href="#coremark" title="Permalink to this heading"></a></h2>
<p>This configuration sets the CoreMark benchmark up for running on the maximum
number of cores for this system. It also enables some optimization flags and
disables the NuttShell to get the best possible score.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the NSH is disabled, the application will start as soon as the
system is turned on.</p>
</div>
</section>
<section id="crypto">
<h2>crypto<a class="headerlink" href="#crypto" title="Permalink to this heading"></a></h2>
<p>This configuration enables support for the cryptographic hardware and
the <code class="docutils literal notranslate"><span class="pre">/dev/crypto</span></code> device file. Currently, we are supporting SHA-1,
SHA-224 and SHA-256 algorithms using hardware.
To test hardware acceleration, you can use <cite>hmac</cite> example and following output
should look like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; hmac
...
hmac sha1 success
hmac sha1 success
hmac sha1 success
hmac sha256 success
hmac sha256 success
hmac sha256 success
</pre></div>
</div>
</section>
<section id="efuse">
<h2>efuse<a class="headerlink" href="#efuse" title="Permalink to this heading"></a></h2>
<p>This configuration demonstrates the use of the eFuse driver. It can be accessed
through the <code class="docutils literal notranslate"><span class="pre">/dev/efuse</span></code> device file.
Virtual eFuse mode can be used by enabling <cite>CONFIG_ESPRESSIF_EFUSE_VIRTUAL</cite>
option to prevent possible damages on chip.</p>
<p>The following snippet demonstrates how to read MAC address:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="n">mac</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">efuse_param_s</span><span class="w"> </span><span class="n">param</span><span class="p">;</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">efuse_desc_s</span><span class="w"> </span><span class="n">mac_addr</span><span class="w"> </span><span class="o">=</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">.</span><span class="n">bit_offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">  </span><span class="p">.</span><span class="n">bit_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span>
<span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="n">efuse_desc_t</span><span class="o">*</span><span class="w"> </span><span class="n">desc</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span>
<span class="p">{</span>
<span class="w">    </span><span class="o">&amp;</span><span class="n">mac_addr</span><span class="p">,</span>
<span class="w">    </span><span class="nb">NULL</span>
<span class="p">};</span>
<span class="n">param</span><span class="p">.</span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">desc</span><span class="p">;</span>
<span class="n">param</span><span class="p">.</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="p">;</span>
<span class="n">param</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mac</span><span class="p">;</span>

<span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="s">&quot;/dev/efuse&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">O_RDONLY</span><span class="p">);</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">EFUSEIOC_READ_FIELD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">param</span><span class="p">);</span>
</pre></div>
</div>
<p>To find offset and count variables for related eFuse,
please refer to Espressif’s Technical Reference Manuals.</p>
</section>
<section id="gpio">
<h2>gpio<a class="headerlink" href="#gpio" title="Permalink to this heading"></a></h2>
<p>This is a test for the GPIO driver. It uses GPIO1 and GPIO2 as outputs and
GPIO9 as an interrupt pin.</p>
<p>At the nsh, we can turn the outputs on and off with the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; gpio -o 1 /dev/gpio0
nsh&gt; gpio -o 1 /dev/gpio1

nsh&gt; gpio -o 0 /dev/gpio0
nsh&gt; gpio -o 0 /dev/gpio1
</pre></div>
</div>
<p>We can use the interrupt pin to send a signal when the interrupt fires:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; gpio -w 14 /dev/gpio2
</pre></div>
</div>
<p>The pin is configured as a rising edge interrupt, so after issuing the
above command, connect it to 3.3V.</p>
<p>To use dedicated gpio for controlling multiple gpio pin at the same time
or having better response time, you need to enable
<cite>CONFIG_ESPRESSIF_DEDICATED_GPIO</cite> option. Dedicated GPIO is suitable
for faster response times required applications like simulate serial/parallel
interfaces in a bit-banging way.
After this option enabled GPIO4 and GPIO5 pins are ready to used as dedicated GPIO pins
as input/output mode. These pins are for example, you can use any pin up to 8 pins for
input and 8 pins for output for dedicated gpio.
To write and read data from dedicated gpio, you need to use
<cite>write</cite> and <cite>read</cite> calls.</p>
<p>The following snippet demonstrates how to read/write to dedicated GPIO pins:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="s">&quot;/dev/dedic_gpio0&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">O_RDWR</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">rd_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">wr_mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffff</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">wr_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>

<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wr_val</span><span class="p">,</span><span class="w"> </span><span class="n">wr_mask</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="n">wr_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="n">wr_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rd_val</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">));</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;rd_val: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="i2c">
<h2>i2c<a class="headerlink" href="#i2c" title="Permalink to this heading"></a></h2>
<p>This configuration can be used to scan and manipulate I2C devices.
You can scan for all I2C devices using the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; i2c dev 0x00 0x7f
</pre></div>
</div>
<p>To use slave mode, you can enable <cite>ESPRESSIF_I2C0_SLAVE_MODE</cite> option.
To use slave mode driver following snippet demonstrates how write to i2c bus
using slave driver:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#define ESP_I2C_SLAVE_PATH  &quot;/dev/i2cslv0&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i2c_slave_fd</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0xAA</span><span class="p">};</span>
<span class="w">    </span><span class="n">i2c_slave_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">ESP_I2C_SLAVE_PATH</span><span class="p">,</span><span class="w"> </span><span class="n">O_RDWR</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">write</span><span class="p">(</span><span class="n">i2c_slave_fd</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="w">    </span><span class="n">close</span><span class="p">(</span><span class="n">i2c_slave_fd</span><span class="p">);</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="i2schar">
<h2>i2schar<a class="headerlink" href="#i2schar" title="Permalink to this heading"></a></h2>
<p>This configuration enables the I2S character device and the i2schar example
app, which provides an easy-to-use way of testing the I2S peripheral,
enabling both the TX and the RX for those peripherals.</p>
<p><strong>I2S pinout</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ESP32-C3 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>SCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>LRCK</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>DIN</p></td>
<td><p>Data In</p></td>
</tr>
</tbody>
</table>
<p>After successfully built and flashed, run on the boards’s terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; i2schar
</pre></div>
</div>
</section>
<section id="mcuboot-nsh">
<h2>mcuboot_nsh<a class="headerlink" href="#mcuboot-nsh" title="Permalink to this heading"></a></h2>
<p>This configuration is the same as the <code class="docutils literal notranslate"><span class="pre">nsh</span></code> configuration, but it generates the application
image in a format that can be used by MCUboot. It also makes the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">bootloader</span></code> command to
build the MCUboot bootloader image using the Espressif HAL.</p>
</section>
<section id="nsh">
<h2>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h2>
<p>Basic configuration to run the NuttShell (nsh).</p>
</section>
<section id="ostest">
<h2>ostest<a class="headerlink" href="#ostest" title="Permalink to this heading"></a></h2>
<p>This is the NuttX test at <code class="docutils literal notranslate"><span class="pre">apps/testing/ostest</span></code> that is run against all new
architecture ports to assure a correct implementation of the OS.</p>
</section>
<section id="pwm">
<h2>pwm<a class="headerlink" href="#pwm" title="Permalink to this heading"></a></h2>
<p>This configuration demonstrates the use of PWM through a LED connected to GPIO8.
To test it, just execute the <code class="docutils literal notranslate"><span class="pre">pwm</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; pwm
pwm_main: starting output with frequency: 10000 duty: 00008000
pwm_main: stopping output
</pre></div>
</div>
<p>qencoder
—</p>
<p>This configuration demonstrates the use of Quadrature Encoder connected to pins
GPIO10 and GPIO11. You can start measurement of pulses using the following
command (by default, it will open <code class="docutils literal notranslate"><span class="pre">\dev\qe0</span></code> device and print 20 samples
using 1 second delay):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; qe
</pre></div>
</div>
</section>
<section id="rmt">
<h2>rmt<a class="headerlink" href="#rmt" title="Permalink to this heading"></a></h2>
<p>This configuration configures the transmitter and the receiver of the
Remote Control Transceiver (RMT) peripheral on the ESP32-H2 using GPIOs 8
and 2, respectively. The RMT peripheral is better explained
<a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32h2/api-reference/peripherals/rmt.html">here</a>,
in the ESP-IDF documentation. The minimal data unit in the frame is called the
RMT symbol, which is represented by <code class="docutils literal notranslate"><span class="pre">rmt_item32_t</span></code> in the driver:</p>
<figure class="align-center">
<img alt="../../../../../_images/rmt_symbol3.png" src="../../../../../_images/rmt_symbol3.png" />
</figure>
<p>The example <code class="docutils literal notranslate"><span class="pre">rmtchar</span></code> can be used to test the RMT peripheral. Connecting
these pins externally to each other will make the transmitter send RMT items
and demonstrates the usage of the RMT peripheral:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; rmtchar
</pre></div>
</div>
<p><strong>WS2812 addressable RGB LEDs</strong></p>
<p>This same configuration enables the usage of the RMT peripheral and the example
<code class="docutils literal notranslate"><span class="pre">ws2812</span></code> to drive addressable RGB LEDs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ws2812
</pre></div>
</div>
<p>Please note that this board contains an on-board WS2812 LED connected to GPIO8
and, by default, this config configures the RMT transmitter in the same pin.</p>
</section>
<section id="rtc">
<h2>rtc<a class="headerlink" href="#rtc" title="Permalink to this heading"></a></h2>
<p>This configuration demonstrates the use of the RTC driver through alarms.
You can set an alarm, check its progress and receive a notification after it expires:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; alarm 10
alarm_daemon started
alarm_daemon: Running
Opening /dev/rtc0
Alarm 0 set in 10 seconds
nsh&gt; alarm -r
Opening /dev/rtc0
Alarm 0 is active with 10 seconds to expiration
nsh&gt; alarm_daemon: alarm 0 received
</pre></div>
</div>
</section>
<section id="sdm">
<h2>sdm<a class="headerlink" href="#sdm" title="Permalink to this heading"></a></h2>
<p>This configuration enables the support for the Sigma-Delta Modulation (SDM) driver
which can be used for LED dimming, simple dac with help of an low pass filter either
active or passive and so on. ESP32-H2 supports 1 group of SDM up to 4 channels with
any GPIO up to user. This configuration enables 1 channel of SDM on GPIO5. You can test
DAC feature with following command with connecting simple LED on GPIO5</p>
<blockquote>
<div><p>nsh&gt; dac -d 100 -s 10 test</p>
</div></blockquote>
<p>After this command you will see LED will light up in different brightness.</p>
</section>
<section id="sdmmc-spi">
<h2>sdmmc_spi<a class="headerlink" href="#sdmmc-spi" title="Permalink to this heading"></a></h2>
<p>This configuration is used to mount a FAT/FAT32 SD Card into the OS’ filesystem.
It uses SPI to communicate with the SD Card, defaulting to SPI2.</p>
<p>The SD slot number, SPI port number and minor number can be modified in <code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">Configuration</span> <span class="pre">→</span> <span class="pre">NSH</span> <span class="pre">Library</span></code>.</p>
<p>To access the card’s files, make sure <code class="docutils literal notranslate"><span class="pre">/dev/mmcsd0</span></code> exists and then execute the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ls /dev
/dev:
console
mmcsd0
null
ttyS0
zero
nsh&gt; mount -t vfat /dev/mmcsd0 /mnt
</pre></div>
</div>
<p>This will mount the SD Card to <code class="docutils literal notranslate"><span class="pre">/mnt</span></code>. Now, you can use the SD Card as a normal filesystem.
For example, you can read a file and write to it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ls /mnt
/mnt:
hello.txt
nsh&gt; cat /mnt/hello.txt
Hello World
nsh&gt; echo &#39;NuttX RTOS&#39; &gt;&gt; /mnt/hello.txt
nsh&gt; cat /mnt/hello.txt
Hello World!
NuttX RTOS
nsh&gt;
</pre></div>
</div>
</section>
<section id="spi">
<h2>spi<a class="headerlink" href="#spi" title="Permalink to this heading"></a></h2>
<p>This configuration enables the support for the SPI driver.
You can test it by connecting MOSI and MISO pins which are GPIO5 and GPIO0
by default to each other and running the <code class="docutils literal notranslate"><span class="pre">spi</span></code> example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; spi exch -b 2 &quot;AB&quot;
Sending:    AB
Received:   AB
</pre></div>
</div>
<p>If SPI peripherals are already in use you can also use bitbang driver which is a
software implemented SPI peripheral by enabling <cite>CONFIG_ESPRESSIF_SPI_BITBANG</cite>
option.</p>
</section>
<section id="spiflash">
<h2>spiflash<a class="headerlink" href="#spiflash" title="Permalink to this heading"></a></h2>
<p>This config tests the external SPI that comes with the ESP32-H2 module connected
through SPI1.</p>
<p>By default a SmartFS file system is selected.
Once booted you can use the following commands to mount the file system:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mksmartfs /dev/smart0
nsh&gt; mount -t smartfs /dev/smart0 /mnt
</pre></div>
</div>
</section>
<section id="timer">
<h2>timer<a class="headerlink" href="#timer" title="Permalink to this heading"></a></h2>
<p>This config test the general use purpose timers. It includes the 4 timers,
adds driver support, registers the timers as devices and includes the timer
example.</p>
<p>To test it, just run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; timer -d /dev/timerx
</pre></div>
</div>
<p>Where x in the timer instance.</p>
</section>
<section id="twai">
<h2>twai<a class="headerlink" href="#twai" title="Permalink to this heading"></a></h2>
<p>This configuration enables the support for the TWAI (Two-Wire Automotive Interface) driver.
You can test it by connecting TWAI RX and TWAI TX pins which are GPIO0 and GPIO2 by default
to an external transceiver or connecting TWAI RX to TWAI TX pin by enabling
the <cite>CONFIG_CAN_LOOPBACK</cite> option (<code class="docutils literal notranslate"><span class="pre">Device</span> <span class="pre">Drivers</span> <span class="pre">-&gt;</span> <span class="pre">CAN</span> <span class="pre">Driver</span> <span class="pre">Support</span> <span class="pre">-&gt;</span> <span class="pre">CAN</span> <span class="pre">loopback</span> <span class="pre">mode</span></code>)
and running the <code class="docutils literal notranslate"><span class="pre">can</span></code> example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; can
nmsgs: 0
min ID: 1 max ID: 2047
Bit timing:
  Baud: 1000000
  TSEG1: 15
  TSEG2: 4
    SJW: 3
  ID:    1 DLC: 1
</pre></div>
</div>
</section>
<section id="usbconsole">
<h2>usbconsole<a class="headerlink" href="#usbconsole" title="Permalink to this heading"></a></h2>
<p>This configuration tests the built-in USB-to-serial converter found in ESP32-H2.
<code class="docutils literal notranslate"><span class="pre">esptool</span></code> can be used to check the version of the chip and if this feature is
supported.  Running <code class="docutils literal notranslate"><span class="pre">esptool.py</span> <span class="pre">-p</span> <span class="pre">&lt;port&gt;</span> <span class="pre">chip_id</span></code> should have <code class="docutils literal notranslate"><span class="pre">Chip</span> <span class="pre">is</span>
<span class="pre">ESP32-H2</span></code> in its output.
When connecting the board a new device should appear, a <code class="docutils literal notranslate"><span class="pre">/dev/ttyACMX</span></code> on Linux
or a <code class="docutils literal notranslate"><span class="pre">/dev/cu.usbmodemXXX</span></code> om macOS.
This can be used to flash and monitor the device with the usual commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make download ESPTOOL_PORT=/dev/ttyACM0
minicom -D /dev/ttyACM0
</pre></div>
</div>
</section>
<section id="watchdog">
<h2>watchdog<a class="headerlink" href="#watchdog" title="Permalink to this heading"></a></h2>
<p>This configuration tests the watchdog timers. It includes the 1 MWDTS,
adds driver support, registers the WDTs as devices and includes the watchdog
example application.</p>
<p>To test it, just run the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wdog -i /dev/watchdogX
</pre></div>
</div>
<p>Where X is the watchdog instance.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../index.html" class="btn btn-neutral float-left" title="Espressif ESP32-H2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../fe310/index.html" class="btn btn-neutral float-right" title="SiFive FE310" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>