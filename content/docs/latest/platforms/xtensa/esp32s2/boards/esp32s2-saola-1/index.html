<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESP32-S2-Saola-1 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Espressif ESP32-S3" href="../../../esp32s3/index.html" />
    <link rel="prev" title="ESP32-S2-Kaluga-1 Kit v1.3" href="../esp32s2-kaluga-1/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../arm/index.html">ARM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Xtensa</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../esp32/index.html">Espressif ESP32</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Espressif ESP32-S2</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#esp32-s2-toolchain">ESP32-S2 Toolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#flashing">Flashing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#memory-map">Memory Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#bit-timers">64-bit Timers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#watchdog-timers">Watchdog Timers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#i2s">I2S</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#secure-boot-and-flash-encryption">Secure Boot and Flash Encryption</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../esp32s2-kaluga-1/index.html">ESP32-S2-Kaluga-1 Kit v1.3</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">ESP32-S2-Saola-1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32s3/index.html">Espressif ESP32-S3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Xtensa</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Espressif ESP32-S2</a></li>
      <li class="breadcrumb-item active">ESP32-S2-Saola-1</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/xtensa/esp32s2/boards/esp32s2-saola-1/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="esp32-s2-saola-1">
<h1>ESP32-S2-Saola-1<a class="headerlink" href="#esp32-s2-saola-1" title="Permalink to this heading"></a></h1>
<p>The <a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/hw-reference/esp32s2/user-guide-saola-1-v1.2.html">ESP32-S2-Saola-1</a>
is a development board for the ESP32-S2 SoC from Espressif, based on the following modules:</p>
<blockquote>
<div><ul class="simple">
<li><p>ESP32-S2-WROVER</p></li>
<li><p>ESP32-S2-WROVER-I</p></li>
<li><p>ESP32-S2-WROOM</p></li>
<li><p>ESP32-S2-WROOM-I</p></li>
</ul>
</div></blockquote>
<p>In this guide, we take ESP32-S2-Saola-1 equipped with ESP32-S2-WROVER as an example.</p>
<figure class="align-center align-default" id="id2">
<img alt="ESP32-S2-Saola-1" src="../../../../../_images/esp32-s2-saola-1-v1.2-isometric.png" />
<figcaption>
<p><span class="caption-text">ESP32-S2-Saola-1</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>ESP32-S2-WROVER
- 4 MB external SPI flash + 2 MB PSRAM</p></li>
<li><p>USB-to-UART bridge via micro USB port</p></li>
<li><p>Power LED</p></li>
<li><p>EN and BOOT buttons</p></li>
<li><p>RGB LED (Addressable RGB LED (WS2812), driven by GPIO18)</p></li>
</ul>
</div></blockquote>
</section>
<section id="serial-console">
<h2>Serial Console<a class="headerlink" href="#serial-console" title="Permalink to this heading"></a></h2>
<p>UART0 is, by default, the serial console.  It connects to the on-board
CP2102 converter and is available on the micro-USB connector (J1).</p>
<p>It will show up as /dev/ttyUSB[n] where [n] will probably be 0.</p>
</section>
<section id="buttons-and-leds">
<h2>Buttons and LEDs<a class="headerlink" href="#buttons-and-leds" title="Permalink to this heading"></a></h2>
<section id="board-buttons">
<h3>Board Buttons<a class="headerlink" href="#board-buttons" title="Permalink to this heading"></a></h3>
<p>There are two buttons labeled Boot and EN.  The EN button is not available
to the software.  It pulls the chip enable line that doubles as a reset line.</p>
<p>The BOOT button is connected to IO0.  On reset, it is used as a strapping
pin to determine whether the chip boots normally or into the serial
bootloader.  After resetting, however, the BOOT button can be used for
software input.</p>
</section>
<section id="board-leds">
<h3>Board LEDs<a class="headerlink" href="#board-leds" title="Permalink to this heading"></a></h3>
<p>There are two on-board LEDs. RED_LED (D5) indicates the presence of 3.3V
power and is not controlled by software. RGB LED (U6) is a WS2812 addressable
LED and is driven by GPIO18.</p>
</section>
</section>
<section id="i2s">
<h2>I2S<a class="headerlink" href="#i2s" title="Permalink to this heading"></a></h2>
<p>ESP32-S2 has an I2S peripheral accessible using either the generic I2S audio
driver or a specific audio codec driver
(<a class="reference external" href="https://www.cirrus.com/products/cs4344-45-48/">CS4344</a> bindings are
available at the moment). The generic I2S audio driver enables using both
the receiver module (RX) and the transmitter module (TX) without using any
specific codec. Also, it’s possible to use the I2S character device driver
to bypass the audio subsystem and write directly to the I2S peripheral.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using the audio system, sample rate and data width are
automatically set by the upper half audio driver.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above statement is not valid when using the I2S character
device driver.
It’s possible to use 8, 16, 24, and 32-bit-widths writing directly to the
I2S character device. Just make sure to set the bit-width:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make menuconfig
-&gt; System Type
    -&gt; ESP32-S2 Peripheral Selection
        -&gt; I2S
            -&gt; Bit Width
</pre></div>
</div>
</div>
<dl class="simple">
<dt>The following configurations use the I2S peripheral::</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#audio"><span class="std std-ref">audio</span></a></p></li>
<li><p><a class="reference internal" href="#i2schar"><span class="std std-ref">i2schar</span></a></p></li>
<li><p><a class="reference internal" href="#nxlooper"><span class="std std-ref">nxlooper</span></a></p></li>
</ul>
</dd>
</dl>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>All of the configurations presented below can be tested by running the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./tools/configure.sh esp32s2-saola-1:&lt;config_name&gt;
$ make flash ESPTOOL_PORT=/dev/ttyUSB0 -j
</pre></div>
</div>
<p>Where &lt;config_name&gt; is the name of board configuration you want to use, i.e.: nsh, buttons, wifi…
Then use a serial console terminal like <code class="docutils literal notranslate"><span class="pre">picocom</span></code> configured to 115200 8N1.</p>
<section id="audio">
<h3>audio<a class="headerlink" href="#audio" title="Permalink to this heading"></a></h3>
<p>This configuration uses the I2S peripheral and an externally connected audio
codec to play an audio file. The easiest way of playing an uncompressed file
is embedding into the firmware. This configuration selects
<a class="reference external" href="https://github.com/apache/nuttx-apps/tree/master/examples/romfs">romfs example</a>
to allow that.</p>
<p><strong>Audio Codec Setup</strong></p>
<p>The CS4344 audio codec is connected to the following pins:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ESP32-S2 Pin</p></th>
<th class="head"><p>CS4344 Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>33</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>SCLK</p></td>
<td><p>Serial Clock</p></td>
</tr>
<tr class="row-even"><td><p>34</p></td>
<td><p>LRCK</p></td>
<td><p>Left Right Clock (Word Select)</p></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>SDIN</p></td>
<td><p>Serial Data In on CS4344. (DOUT on ESP32)</p></td>
</tr>
</tbody>
</table>
<p><strong>ROMFS example</strong></p>
<p>Prepare and build the <code class="docutils literal notranslate"><span class="pre">audio</span></code> defconfig:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make -j distclean &amp;&amp; ./tools/configure.sh esp32s2-saola-1:audio &amp;&amp; make
</pre></div>
</div>
<p>This will create a temporary folder in <code class="docutils literal notranslate"><span class="pre">apps/examples/romfs/testdir</span></code>. Move
a PCM-encoded (<code class="docutils literal notranslate"><span class="pre">.wav</span></code>) audio file with 16 or 24 bits/sample (sampled at 16~48kHz)
to this folder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use <a class="reference download internal" download="" href="../../../../../_downloads/23e89ab38b78035176f15362834bea98/tone.wav"><code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">440</span> <span class="pre">Hz</span> <span class="pre">sinusoidal</span> <span class="pre">tone</span></code></a>.
The audio file should be located at <code class="docutils literal notranslate"><span class="pre">apps/examples/romfs/testdir/tone.wav</span></code></p>
</div>
<p>Build the project again and flash it (make sure not to clean it, just build)</p>
<p>After successfully built and flashed, load the romfs and play it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; romfs
nsh&gt; nxplayer
nxplayer&gt; play /usr/share/local/tone.wav
</pre></div>
</div>
</section>
<section id="buttons">
<h3>buttons<a class="headerlink" href="#buttons" title="Permalink to this heading"></a></h3>
<p>This configuration shows the use of the buttons subsystem. It can be used by executing
the <code class="docutils literal notranslate"><span class="pre">buttons</span></code> application and pressing on any of the available board buttons:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; buttons
buttons_main: Starting the button_daemon
buttons_main: button_daemon started
button_daemon: Running
button_daemon: Opening /dev/buttons
button_daemon: Supported BUTTONs 0x01
nsh&gt; Sample = 1
Sample = 0
</pre></div>
</div>
</section>
<section id="coremark">
<h3>coremark<a class="headerlink" href="#coremark" title="Permalink to this heading"></a></h3>
<p>This configuration sets the CoreMark benchmark up for running on the maximum
number of cores for this system. It also enables some optimization flags and
disables the NuttShell to get the best possible score.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the NSH is disabled, the application will start as soon as the
system is turned on.</p>
</div>
</section>
<section id="cxx">
<h3>cxx<a class="headerlink" href="#cxx" title="Permalink to this heading"></a></h3>
<p>Development environment ready for C++ applications. You can check if the setup
was successful by running <code class="docutils literal notranslate"><span class="pre">cxxtest</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; cxxtest
Test ofstream ================================
printf: Starting test_ostream
printf: Successfully opened /dev/console
cout: Successfully opened /dev/console
Writing this to /dev/console
Test iostream ================================
Hello, this is only a test
Print an int: 190
Print a char: d
Test std::vector =============================
v1=1 2 3
Hello World Good Luck
Test std::map ================================
Test C++17 features ==========================
File /proc/meminfo exists!
Invalid file! /invalid
File /proc/version exists!
</pre></div>
</div>
</section>
<section id="gpio">
<h3>gpio<a class="headerlink" href="#gpio" title="Permalink to this heading"></a></h3>
<p>This is a test for the GPIO driver. It includes one arbitrary GPIO.
For this example, GPIO1 was used (defined by the board implementation).
At the nsh, we can turn the GPIO output on and off with the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; gpio -o 1 /dev/gpio0
nsh&gt; gpio -o 0 /dev/gpio0
</pre></div>
</div>
</section>
<section id="i2c">
<h3>i2c<a class="headerlink" href="#i2c" title="Permalink to this heading"></a></h3>
<p>This configuration can be used to scan and manipulate I2C devices.
You can scan for all I2C devices using the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; i2c dev 0x00 0x7f
</pre></div>
</div>
</section>
<section id="i2schar">
<h3>i2schar<a class="headerlink" href="#i2schar" title="Permalink to this heading"></a></h3>
<p>This configuration enables the I2S character device and the i2schar example
app, which provides an easy-to-use way of testing the I2S peripheral,
enabling both the TX and the RX for those peripherals.</p>
<p><strong>I2S pinout</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ESP32-S2 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>33</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>SCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-even"><td><p>34</p></td>
<td><p>LRCK</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td><p>DIN</p></td>
<td><p>Data In</p></td>
</tr>
</tbody>
</table>
<p>After successfully built and flashed, run on the boards’s terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; i2schar
</pre></div>
</div>
<p>The corresponding output should show related debug information.</p>
</section>
<section id="mcuboot-nsh">
<h3>mcuboot_nsh<a class="headerlink" href="#mcuboot-nsh" title="Permalink to this heading"></a></h3>
<p>This configuration is the same as the <code class="docutils literal notranslate"><span class="pre">nsh</span></code> configuration, but it generates the application
image in a format that can be used by MCUboot. It also makes the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">bootloader</span></code> command to
build the MCUboot bootloader image using the Espressif HAL.</p>
</section>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Basic NuttShell configuration (console enabled in UART0, exposed via
USB connection by means of CP2102 converter, at 115200 bps).</p>
</section>
<section id="nxlooper">
<h3>nxlooper<a class="headerlink" href="#nxlooper" title="Permalink to this heading"></a></h3>
<p>This configuration uses the I2S peripheral as an I2S receiver and
transmitter at the same time. The idea is to capture an I2S data frame
using the RX module and reproduce the captured data on the TX module.</p>
<p><strong>Receiving and transmitting data on I2S</strong></p>
<p>The I2S will act as a receiver (master mode), capturing data from DIN, which
needs to be connected to an external source as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ESP32-S2 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>33</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>SCLK</p></td>
<td><p>Bit Clock (SCLK) Output</p></td>
</tr>
<tr class="row-even"><td><p>34</p></td>
<td><p>LRCK</p></td>
<td><p>Word Select (LRCLK) Output</p></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td><p>DIN</p></td>
<td><p>Data In</p></td>
</tr>
</tbody>
</table>
<p>The DOUT pin will output the captured data frame.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ESP32-S2 contains a single I2S peripheral, so the peripheral
works on “full-duplex” mode. The <cite>SCLK</cite> and <cite>LRCK</cite> signals are connected
internally and the TX module is set-up as slave and the RX as master.</p>
</div>
<p><strong>nxlooper</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">nxlooper</span></code> application captures data from the audio device with receiving
capabilities and forwards the audio data frame to the audio device with
transmitting capabilities.</p>
<p>After successfully built and flashed, run on the boards’s terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; nxlooper
nxlooper&gt; loopback
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">loopback</span></code> command default arguments for the channel configuration,
the data width and the sample rate are, respectively, 2 channels,
16 bits/sample and 48KHz. These arguments can be supplied to select
different audio formats, for instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nxlooper&gt; loopback 2 8 44100
</pre></div>
</div>
</div>
</section>
<section id="oneshot">
<h3>oneshot<a class="headerlink" href="#oneshot" title="Permalink to this heading"></a></h3>
<p>This config demonstrate the use of oneshot timers present on the ESP32-S2.
To test it, just run the <code class="docutils literal notranslate"><span class="pre">oneshot</span></code> example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; oneshot
Opening /dev/oneshot
Maximum delay is 4294967295999999
Starting oneshot timer with delay 2000000 microseconds
Waiting...
Finished
</pre></div>
</div>
</section>
<section id="ostest">
<h3>ostest<a class="headerlink" href="#ostest" title="Permalink to this heading"></a></h3>
<p>This is the NuttX test at apps/testing/ostest that is run against all new
architecture ports to assure a correct implementation of the OS.</p>
</section>
<section id="pwm">
<h3>pwm<a class="headerlink" href="#pwm" title="Permalink to this heading"></a></h3>
<p>This configuration demonstrates the use of PWM through a LED connected to GPIO2.
To test it, just execute the <code class="docutils literal notranslate"><span class="pre">pwm</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; pwm
pwm_main: starting output with frequency: 10000 duty: 00008000
pwm_main: stopping output
</pre></div>
</div>
</section>
<section id="random">
<h3>random<a class="headerlink" href="#random" title="Permalink to this heading"></a></h3>
<p>This configuration shows the use of the ESP32-S2’s True Random Number Generator with
entropy sourced from Wi-Fi and Bluetooth noise.
To test it, just run <code class="docutils literal notranslate"><span class="pre">rand</span></code> to get 32 randomly generated bytes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; rand
Reading 8 random numbers
Random values (0x3ffe0b00):
0000  98 b9 66 a2 a2 c0 a2 ae 09 70 93 d1 b5 91 86 c8  ..f......p......
0010  8f 0e 0b 04 29 64 21 72 01 92 7c a2 27 60 6f 90  ....)d!r..|.&#39;`o.
</pre></div>
</div>
</section>
<section id="rmt">
<h3>rmt<a class="headerlink" href="#rmt" title="Permalink to this heading"></a></h3>
<p>This configuration configures the transmitter and the receiver of the
Remote Control Transceiver (RMT) peripheral on the ESP32-S2 using GPIOs 18
and 2, respectively. The RMT peripheral is better explained
<a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32s2/api-reference/peripherals/rmt.html">here</a>,
in the ESP-IDF documentation. The minimal data unit in the frame is called the
RMT symbol, which is represented by <code class="docutils literal notranslate"><span class="pre">rmt_item32_t</span></code> in the driver:</p>
<figure class="align-center">
<img alt="../../../../../_images/rmt_symbol4.png" src="../../../../../_images/rmt_symbol4.png" />
</figure>
<p>The example <code class="docutils literal notranslate"><span class="pre">rmtchar</span></code> can be used to test the RMT peripheral. Connecting
these pins externally to each other will make the transmitter send RMT items
and demonstrates the usage of the RMT peripheral:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; rmtchar
</pre></div>
</div>
<p><strong>WS2812 addressable RGB LEDs</strong></p>
<p>This same configuration enables the usage of the RMT peripheral and the example
<code class="docutils literal notranslate"><span class="pre">ws2812</span></code> to drive addressable RGB LEDs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ws2812
</pre></div>
</div>
<p>Please note that this board contains an on-board WS2812 LED connected to GPIO18
and, by default, this config configures the RMT transmitter in the same pin.</p>
</section>
<section id="rtc">
<h3>rtc<a class="headerlink" href="#rtc" title="Permalink to this heading"></a></h3>
<p>This configuration demonstrates the use of the RTC driver through alarms.
You can set an alarm, check its progress and receive a notification after it expires:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; alarm 10
alarm_daemon started
alarm_daemon: Running
Opening /dev/rtc0
Alarm 0 set in 10 seconds
nsh&gt; alarm -r
Opening /dev/rtc0
Alarm 0 is active with 10 seconds to expiration
nsh&gt; alarm_daemon: alarm 0 received
</pre></div>
</div>
</section>
<section id="timer">
<h3>timer<a class="headerlink" href="#timer" title="Permalink to this heading"></a></h3>
<p>This config tests the general-use purpose timers. It includes the 4 timers,
adds driver support, registers the timers as devices and includes the timer
example.</p>
<p>To test it, just run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; timer -d /dev/timerx
</pre></div>
</div>
<p>Where x in the timer instance.</p>
</section>
<section id="twai">
<h3>twai<a class="headerlink" href="#twai" title="Permalink to this heading"></a></h3>
<p>This configuration enables the support for the TWAI (Two-Wire Automotive Interface) driver.
You can test it by connecting TWAI RX and TWAI TX pins which are GPIO0 and GPIO2 by default
to a external transceiver or connecting TWAI RX to TWAI TX pin by enabling
the <code class="docutils literal notranslate"><span class="pre">Device</span> <span class="pre">Drivers</span> <span class="pre">-&gt;</span> <span class="pre">CAN</span> <span class="pre">Driver</span> <span class="pre">Support</span> <span class="pre">-&gt;</span> <span class="pre">CAN</span> <span class="pre">loopback</span> <span class="pre">mode</span></code> option and running the <code class="docutils literal notranslate"><span class="pre">can</span></code> example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; can
nmsgs: 0
min ID: 1 max ID: 2047
Bit timing:
  Baud: 1000000
  TSEG1: 15
  TSEG2: 4
    SJW: 3
  ID:    1 DLC: 1
</pre></div>
</div>
</section>
<section id="watchdog">
<h3>watchdog<a class="headerlink" href="#watchdog" title="Permalink to this heading"></a></h3>
<p>This config test the watchdog timers. It includes the 2 MWDTs,
adds driver support, registers the WDTs as devices and includes the watchdog
example.</p>
<p>To test it, just run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wdog -i /dev/watchdogx
</pre></div>
</div>
<p>Where x is the watchdog instance.</p>
<p>To test the XTWDT(/dev/watchdog3) an interrupt handler needs to be
implemented because XTWDT does not have system reset feature. To implement
an interrupt handler <cite>WDIOC_CAPTURE</cite> command can be used. When interrupt
rises, XTAL32K clock can be restored with <cite>WDIOC_RSTCLK</cite> command.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../esp32s2-kaluga-1/index.html" class="btn btn-neutral float-left" title="ESP32-S2-Kaluga-1 Kit v1.3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../esp32s3/index.html" class="btn btn-neutral float-right" title="Espressif ESP32-S3" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>