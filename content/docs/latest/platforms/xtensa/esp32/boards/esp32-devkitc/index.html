<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESP32 DevKitC &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="ESP32-Ethernet-Kit V1.2" href="../esp32-ethernet-kit/index.html" />
    <link rel="prev" title="ESP32-AUDIO-KIT" href="../esp32-audio-kit/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
    
    <img src="../../../../../_static/NuttX.png" class="logo" alt="Logo"/>
  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../arm/index.html">ARM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">AVR8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Xtensa</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Espressif ESP32</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#toolchain">Toolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#flashing">Flashing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#memory-map">Memory Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#bit-timers">64-bit Timers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#watchdog-timers">Watchdog Timers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#smp">SMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#wi-fi">Wi-Fi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#wi-fi-softap">Wi-Fi SoftAP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#bluetooth">Bluetooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#i2s">I2S</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#using-qemu">Using QEMU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#secure-boot-and-flash-encryption">Secure Boot and Flash Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#things-to-do">Things to Do</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../esp32-audio-kit/index.html">ESP32-AUDIO-KIT</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">ESP32 DevKitC</a></li>
<li class="toctree-l5"><a class="reference internal" href="../esp32-ethernet-kit/index.html">ESP32-Ethernet-Kit V1.2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../esp32-lyrat/index.html">ESP32-LyraT V4.3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../esp32-wrover-kit/index.html">ESP-WROVER-KIT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32s2/index.html">Espressif ESP32-S2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../esp32s3/index.html">Espressif ESP32-S3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../../index.html">Supported Platforms</a> &raquo;</li>
          <li><a href="../../../index.html">Xtensa</a> &raquo;</li>
          <li><a href="../../index.html">Espressif ESP32</a> &raquo;</li>
      <li>ESP32 DevKitC</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/xtensa/esp32/boards/esp32-devkitc/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="esp32-devkitc">
<h1>ESP32 DevKitC<a class="headerlink" href="#esp32-devkitc" title="Permalink to this headline"></a></h1>
<p>The <a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/modules-and-boards.html#esp32-devkitc-v4">ESP32 DevKitC</a> is a development board for the ESP32 SoC from Espressif, based on a ESP-WROOM-32 module. You can find the original V2 version and the newer V4 variant. They are
pin compatible.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center" id="id4">
<img alt="../../../../../_images/esp32-core-board-v2.jpg" src="../../../../../_images/esp32-core-board-v2.jpg" />
<figcaption>
<p><span class="caption-text">ESP32 DevKitC/Core V2</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-center" id="id5">
<img alt="../../../../../_images/esp32-devkitc-v4-front.jpg" src="../../../../../_images/esp32-devkitc-v4-front.jpg" />
<figcaption>
<p><span class="caption-text">ESP32 DevKitC V4</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>ESP32 WROOM Module</p></li>
<li><p>USB-to-UART bridge via micro USB port</p></li>
<li><p>Power LED</p></li>
<li><p>EN and BOOT buttons (BOOT accessible to user)</p></li>
<li><p>SPI FLASH (size varies according to model</p></li>
</ul>
</div></blockquote>
</section>
<section id="serial-console">
<h2>Serial Console<a class="headerlink" href="#serial-console" title="Permalink to this headline"></a></h2>
<p>UART0 is, by default, the serial console. It connects to the on-board
CP2102 converter and is available on the USB connector USB CON8 (J1).</p>
<p>It will show up as /dev/ttypUSB[n] where [n] will probably be 0 (is it 1
on my PC because I have a another device at ttyUSB0).</p>
</section>
<section id="buttons-and-leds">
<h2>Buttons and LEDs<a class="headerlink" href="#buttons-and-leds" title="Permalink to this headline"></a></h2>
<section id="board-buttons">
<h3>Board Buttons<a class="headerlink" href="#board-buttons" title="Permalink to this headline"></a></h3>
<p>There are two buttons labeled Boot and EN. The EN button is not available
to software. It pulls the chip enable line that doubles as a reset line.</p>
<p>The BOOT button is connected to IO0. On reset it is used as a strapping
pin to determine whether the chip boots normally or into the serial
bootloader. After reset, however, the BOOT button can be used for software
input.</p>
</section>
<section id="board-leds">
<h3>Board LEDs<a class="headerlink" href="#board-leds" title="Permalink to this headline"></a></h3>
<p>There are several on-board LEDs for that indicate the presence of power
and USB activity. None of these are available for use by software.</p>
</section>
</section>
<section id="ethernet">
<h2>Ethernet<a class="headerlink" href="#ethernet" title="Permalink to this headline"></a></h2>
<p>ESP32 has a 802.11 hardware MAC, so just connects to external PHY chip.
Due to the limited number of GPIOs in ESP32, it’s recommended to use RMII to
connect to an external PHY chip. Current driver also only supports RMII option.</p>
<p>The RMII GPIO pins are fixed, but the SMI and functional GPIO pins are optional.</p>
<p>RMII GPIO pins are as following:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 GPIO</p></th>
<th class="head"><p>PHY Chip GPIO</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IO25</p></td>
<td><p>RXD[0]</p></td>
</tr>
<tr class="row-odd"><td><p>IO26</p></td>
<td><p>RXD[1]</p></td>
</tr>
<tr class="row-even"><td><p>IO27</p></td>
<td><p>CRS_DV</p></td>
</tr>
<tr class="row-odd"><td><p>IO0</p></td>
<td><p>REF_CLK</p></td>
</tr>
<tr class="row-even"><td><p>IO19</p></td>
<td><p>TXD[0]</p></td>
</tr>
<tr class="row-odd"><td><p>IO21</p></td>
<td><p>TX_EN</p></td>
</tr>
<tr class="row-even"><td><p>IO22</p></td>
<td><p>TXD[1]</p></td>
</tr>
</tbody>
</table>
<p>SMI GPIO pins (default option) are as following:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 GPIO</p></th>
<th class="head"><p>PHY Chip GPIO</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IO18</p></td>
<td><p>MDIO</p></td>
</tr>
<tr class="row-odd"><td><p>IO23</p></td>
<td><p>MDC</p></td>
</tr>
</tbody>
</table>
<p>Functional GPIO pins(default option) are as following:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 GPIO</p></th>
<th class="head"><p>PHY Chip GPIO</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IO5</p></td>
<td><p>Reset_N</p></td>
</tr>
</tbody>
</table>
<p>Espressif has an <a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/esp32/get-started-ethernet-kit.html">official Ethernet development
board</a>.</p>
<p>This driver has been tested according to this board and ESP32 core
board + LAN8720 module. If users have some issue about using this driver,
please refer the upper official document, specially the issue that GPIO0
causes failing to bring the ESP32 chip up.</p>
</section>
<section id="i2s">
<h2>I2S<a class="headerlink" href="#i2s" title="Permalink to this headline"></a></h2>
<p>ESP32 has two I2S peripherals accessible using either the generic I2S audio
driver or a specific audio codec driver
(<a class="reference external" href="https://www.cirrus.com/products/cs4344-45-48/">CS4344</a> bindings are
available at the moment). The generic I2S audio driver enables using both
the receiver module (RX) and the transmitter module (TX) without using any
specific codec. Also, it’s possible to use the I2S character device driver
to bypass the audio subsystem and write directly to the I2S peripheral.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The I2S peripheral is able to work on two functional modes
internally: 16 and 32-bit width.
ESP32’s I2S driver, however, uses an internal buffer to enable inserting
padding bytes and provide the ability to play 8, 16, 24 or 32-bits/sample
audio files. Sample rate and data width are automatically set by the upper
half audio driver.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Also, it’s possible to use 8, 16, 24, and 32-bit-widths writing
directly to the I2S character device. Just make sure to set the bit-width:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make menuconfig
-&gt; System Type
    -&gt; ESP32 Peripheral Selection
        -&gt; I2S
            -&gt; I2S0/1
                -&gt; Bit Witdh
</pre></div>
</div>
<p>And make sure the data stream buffer being written to the I2S peripheral is
aligned to the next boundary i.e. 16 bits for the 8 and 16-bit-widths and
32 bits for 24 and 32-bit-widths.</p>
</div>
<dl class="simple">
<dt>The following configurations use the I2S peripheral::</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#audio"><span class="std std-ref">audio</span></a></p></li>
<li><p><a class="reference internal" href="#i2schar"><span class="std std-ref">i2schar</span></a></p></li>
<li><p><a class="reference internal" href="#nxlooper"><span class="std std-ref">nxlooper</span></a></p></li>
</ul>
</dd>
</dl>
</section>
<section id="pin-mapping">
<h2>Pin Mapping<a class="headerlink" href="#pin-mapping" title="Permalink to this headline"></a></h2>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>To be updated</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 40%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Pin</p></th>
<th class="head"><p>Signal</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>?</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this headline"></a></h2>
<p>All of the configurations presented below can be tested by running the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./tools/configure.sh esp32-devkitc:&lt;config_name&gt;
$ make flash ESPTOOL_PORT=/dev/ttyUSB0 -j
</pre></div>
</div>
<p>Where &lt;config_name&gt; is the name of board configuration you want to use, i.e.: nsh, buttons, wifi…
Then use a serial console terminal like <code class="docutils literal notranslate"><span class="pre">picocom</span></code> configured to 115200 8N1.</p>
<section id="audio">
<h3>audio<a class="headerlink" href="#audio" title="Permalink to this headline"></a></h3>
<p>This configuration uses the I2S0 peripheral and an externally connected audio
codec to play an audio file streamed over an HTTP connection while connected
to a Wi-Fi network.</p>
<p><strong>Audio Codec Setup</strong></p>
<p>The CS4344 audio codec is connected on the following pins:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 Pin</p></th>
<th class="head"><p>CS4344 Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>SCLK</p></td>
<td><p>Serial Clock</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>LRCK</p></td>
<td><p>Left Right Clock (Word Select)</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>SDIN</p></td>
<td><p>Serial Data In on CS4344. (DOUT on ESP32)</p></td>
</tr>
</tbody>
</table>
<p><strong>Simple HTTP server</strong></p>
<p>Prepare a PCM-encoded (<cite>.wav</cite>) audio file with 16 or 24 bits/sample (sampled at
16~48kHz). This file must be placed into a folder in a computer that could
be accessed on the same Wi-Fi network the ESP32 will be connecting to.</p>
<p>Python provides a simple HTTP server. <code class="docutils literal notranslate"><span class="pre">cd</span></code> to the audio file folder on the
PC and run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/)
</pre></div>
</div>
<p>Look for your PC IP address and test playing the prepared audio on your
browser:</p>
<figure class="align-center">
<img alt="../../../../../_images/esp32-audio-config-file1.png" src="../../../../../_images/esp32-audio-config-file1.png" />
</figure>
<p>After successfully built and flashed, connect the board to the Wi-Fi network:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wapi psk wlan0 mypasswd 1
nsh&gt; wapi essid wlan0 myssid 1
nsh&gt; renew wlan0
</pre></div>
</div>
<p>Once connected, open NuttX’s player and play the file according to its file
name and the IP address of the HTTP server:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; nxplayer
nxplayer&gt; play http://192.168.1.239:8000/tones.wav
</pre></div>
</div>
</section>
<section id="autopm">
<h3>autopm<a class="headerlink" href="#autopm" title="Permalink to this headline"></a></h3>
<p>This configuration makes the device automatically enter the low power consumption mode
when in the idle state, powering off the cpu and other peripherals.</p>
<p>In minimum power save mode, the station wakes up every DTIM to receive a beacon. The broadcast
data will not be lost because it is transmitted after DTIM. However, it can not save much more
power if DTIM is short as the DTIM is determined by the access point.</p>
</section>
<section id="ble">
<h3>ble<a class="headerlink" href="#ble" title="Permalink to this headline"></a></h3>
<p>This configuration is used to enable Bluetooth Low Energy support for this board. You can scan
for Bluetooth devices using the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NuttShell (NSH) NuttX-10.2.0
nsh&gt; ifconfig
bnep0   Link encap:UNSPEC at DOWN
        inet addr:0.0.0.0 DRaddr:0.0.0.0 Mask:0.0.0.0
wlan0   Link encap:Ethernet HWaddr ac:67:b2:53:8b:ec at UP
        inet addr:10.0.0.2 DRaddr:10.0.0.1 Mask:255.255.255.0
nsh&gt; bt bnep0 scan start
nsh&gt; bt bnep0 scan stop
nsh&gt; bt bnep0 scan get
Scan result:
1.     addr:           63:14:2f:b9:9f:83 type: 1
      rssi:            -90
      response type:   3
      advertiser data: 1e ff 06 00 01 09 20 02 7c 33 a3 a7 cd c9 44 5b
2.     addr:           52:ca:05:b5:ad:77 type: 1
      rssi:            -82
      response type:   3
      advertiser data: 1e ff 06 00 01 09 20 02 03 d1 21 57 bf 19 b3 7a
3.     addr:           46:8e:b2:cd:94:27 type: 1
      rssi:            -92
      response type:   2
      advertiser data: 02 01 1a 09 ff c4 00 10 33 14 12 16 80 02 0a d4
4.     addr:           46:8e:b2:cd:94:27 type: 1
      rssi:            -92
      response type:   4
      advertiser data: 18 09 5b 4c 47 5d 20 77 65 62 4f 53 20 54 56 20
5.     addr:           63:14:2f:b9:9f:83 type: 1
      rssi:            -80
      response type:   3
    advertiser data: 1e ff 06 00 01 09 20 02 7c 33 a3 a7 cd c9 44 5b
</pre></div>
</div>
</section>
<section id="blewifi">
<h3>blewifi<a class="headerlink" href="#blewifi" title="Permalink to this headline"></a></h3>
<p>Combines the capabilities of the <code class="docutils literal notranslate"><span class="pre">ble</span></code> and <code class="docutils literal notranslate"><span class="pre">wifi</span></code> configurations. ESP32 has only one 2.4 GHz
ISM band RF module, which is shared by Bluetooth (BT &amp; BLE) and Wi-Fi, so Bluetooth can’t receive
or transmit data while Wi-Fi is receiving or transmitting data and vice versa. Under such circumstances,
ESP32 uses the time-division multiplexing method to receive and transmit packets.</p>
</section>
<section id="bmp280">
<h3>bmp280<a class="headerlink" href="#bmp280" title="Permalink to this headline"></a></h3>
<p>This configuration enables the use of the BMP280 temperature and pressure sensor over I2C.
You can check that the sensor is working by using the <code class="docutils literal notranslate"><span class="pre">sensortest</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; sensortest baro0
baro0: timestamp:66870000 value1:1008.37 value2:31.70
baro0: timestamp:66890000 value1:1008.31 value2:31.70
</pre></div>
</div>
</section>
<section id="buttons">
<h3>buttons<a class="headerlink" href="#buttons" title="Permalink to this headline"></a></h3>
<p>This configuration shows the use of the buttons subsystem. It can be used by executing
the <code class="docutils literal notranslate"><span class="pre">buttons</span></code> application and pressing on any of the available board buttons:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; buttons
buttons_main: Starting the button_daemon
buttons_main: button_daemon started
button_daemon: Running
button_daemon: Opening /dev/buttons
button_daemon: Supported BUTTONs 0x01
nsh&gt; Sample = 1
Sample = 0
</pre></div>
</div>
</section>
<section id="coremark">
<h3>coremark<a class="headerlink" href="#coremark" title="Permalink to this headline"></a></h3>
<p>This configuration sets the CoreMark benchmark up for running on the maximum
number of cores for this system. It also enables some optimization flags and
disables the NuttShell to get the best possible score.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the NSH is disabled, the application will start as soon as the
system is turned on.</p>
</div>
</section>
<section id="cxx">
<h3>cxx<a class="headerlink" href="#cxx" title="Permalink to this headline"></a></h3>
<p>Development enviroment ready for C++ applications. You can check if the setup
was successfull by running <code class="docutils literal notranslate"><span class="pre">cxxtest</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; cxxtest
Test ofstream ================================
printf: Starting test_ostream
printf: Successfully opened /dev/console
cout: Successfully opened /dev/console
Writing this to /dev/console
Test iostream ================================
Hello, this is only a test
Print an int: 190
Print a char: d
Test std::vector =============================
v1=1 2 3
Hello World Good Luck
Test std::map ================================
Test C++17 features ==========================
File /proc/meminfo exists!
Invalid file! /invalid
File /proc/version exists!
</pre></div>
</div>
</section>
<section id="efuse">
<h3>efuse<a class="headerlink" href="#efuse" title="Permalink to this headline"></a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">wifi</span></code> configuration with the eFuse driver enabled. It can be accessed
through the <code class="docutils literal notranslate"><span class="pre">/dev/efuse</span></code> device file.</p>
</section>
<section id="elf">
<h3>elf<a class="headerlink" href="#elf" title="Permalink to this headline"></a></h3>
<p>This configuration uses apps/examples/elf in order to test the ELF loader.
It can be tested by executing the <code class="docutils literal notranslate"><span class="pre">elf</span></code> application.</p>
</section>
<section id="i2schar">
<h3>i2schar<a class="headerlink" href="#i2schar" title="Permalink to this headline"></a></h3>
<p>This configuration enables the I2S character device and the i2schar example
app, which provides an easy-to-use way of testing the I2S peripherals (I2S0
and I2S1), enabling both the TX and the RX for those peripherals.</p>
<p><strong>I2S0 pinout</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>BCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>WS</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>DIN</p></td>
<td><p>Data IN</p></td>
</tr>
</tbody>
</table>
<p><strong>I2S1 pinout</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>22</p></td>
<td><p>BCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>WS</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-even"><td><p>25</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
<tr class="row-odd"><td><p>26</p></td>
<td><p>DIN</p></td>
<td><p>Data IN</p></td>
</tr>
</tbody>
</table>
<p>After successfully built and flashed, run on the boards’s terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>i2schar -p /dev/i2schar[0-1]
</pre></div>
</div>
<p>The corresponding output should show related debug informations.</p>
</section>
<section id="knsh">
<h3>knsh<a class="headerlink" href="#knsh" title="Permalink to this headline"></a></h3>
<p>This is identical to the nsh configuration except that (1) NuttX
is built as PROTECTED mode, monolithic module and the user applications
are built separately and, as a consequence, (2) some features that are
only available in the FLAT build are disabled.</p>
<p>Protected Mode support for ESP32 relies on the PID Controller peripheral
for implementing isolation between Kernel and Userspace.</p>
<p>By working together with the MMU and Static MPUs of the ESP32, the PID
Controller is able to restrict the application access to peripherals, on-chip
memories (Internal ROM and Internal SRAM) and off-chip memories (External
Flash and PSRAM).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The PID Controller driver is in <strong>EXPERIMENTAL</strong> state, so please
consider the Protected Mode feature for ESP32 a <strong>Proof-of-Concept</strong>.</p></li>
<li><p>The PID Controller <strong>does not</strong> prevent the application from accessing
CPU System Registers.</p></li>
</ul>
</div>
</section>
<section id="leds">
<h3>leds<a class="headerlink" href="#leds" title="Permalink to this headline"></a></h3>
<p>This configuration uses the on-board LED (or an external LED connected to GPIO2)
to demonstrate the use of the userleds subsystem:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; leds
leds_main: Starting the led_daemon
leds_main: led_daemon started
led_daemon (pid# 3): Running
led_daemon: Opening /dev/userleds
led_daemon: Supported LEDs 0x01
led_daemon: LED set 0x01
led_daemon: LED set 0x00
led_daemon: LED set 0x01
led_daemon: LED set 0x00
led_daemon: LED set 0x01
</pre></div>
</div>
</section>
<section id="max6675">
<h3>max6675<a class="headerlink" href="#max6675" title="Permalink to this headline"></a></h3>
<p>This configuration enables the use of the MAX6675 temperature sensor over SPI.
The following pin configuration is used to connect the sensor:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Pin</p></th>
<th class="head"><p>Signal</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>15</p></td>
<td><p>CS</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>SCK</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>MISO</p></td>
</tr>
</tbody>
</table>
<p>You can check that the sensor is working by using the <code class="docutils literal notranslate"><span class="pre">max6675</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; max6675
Unable to open file /dev/temp1
Unable to open file /dev/temp2
Unable to open file /dev/temp3
Starting...
Channel SSP0/SPI1 Device 0: Temperature = 24!
Channel SSP0/SPI1 Device 1: Not enabled!
Channel SSP1/SPI2 Device 0: Not enabled!
Channel SSP1/SPI2 Device 1: Not enabled!
</pre></div>
</div>
</section>
<section id="mcp2515">
<h3>mcp2515<a class="headerlink" href="#mcp2515" title="Permalink to this headline"></a></h3>
<p>This config is used to communicate with MCP2515 CAN over SPI chip.
SPI3 is used and kept with the default IOMUX pins, i.e.:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Pin</p></th>
<th class="head"><p>Signal</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>5</p></td>
<td><p>CS</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>SCK</p></td>
</tr>
<tr class="row-even"><td><p>23</p></td>
<td><p>MOSI</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>MISO</p></td>
</tr>
</tbody>
</table>
<p>The MCP2515 interrupt (INT) pin is connected to the pin 22 of the
ESP32-Devkit.</p>
</section>
<section id="mcuboot-slot-confirm">
<h3>mcuboot_slot_confirm<a class="headerlink" href="#mcuboot-slot-confirm" title="Permalink to this headline"></a></h3>
<p>This configuration is used to represent an MCUboot update image that needs to be confirmed
after flashing. The image can be confirmed by using the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mcuboot_confirm
Application Image successfully confirmed!
</pre></div>
</div>
<p>For more information, check <a class="reference external" href="https://www.youtube.com/watch?v=Vzy0rl-ixbc">this demo</a>.</p>
</section>
<section id="mcuboot-update-agent">
<h3>mcuboot_update_agent<a class="headerlink" href="#mcuboot-update-agent" title="Permalink to this headline"></a></h3>
<p>This configuration is used to represent an MCUboot image that contains an update agent
to perform OTA updates. First, you will have to setup a HTTP server to provide the update
image. To do that, we can run a simple Python server on the same folder that contains our
binary file on the computer:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo python -m http.server 8080
</pre></div>
</div>
<p>After this, we can use NSH to connect to our network and use the agent to perform the firmware
update:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ifup wlan0
nsh&gt; wapi mode wlan0 2
nsh&gt; wapi psk wlan0 mypasswd 3
nsh&gt; wapi essid wlan0 myssid 1
nsh&gt; renew wlan0
nsh&gt; mcuboot_agent http://&lt;SERVER_IP&gt;:8080/nuttx.bin
</pre></div>
</div>
<p>For more information, check <a class="reference external" href="https://www.youtube.com/watch?v=Vzy0rl-ixbc">this demo</a>.</p>
</section>
<section id="modbus">
<h3>modbus<a class="headerlink" href="#modbus" title="Permalink to this headline"></a></h3>
<p>This configurations shows how to use this device as a ModBus RTU Slave. After
configuring the desired pins on menuconfig and wiring the RS485 converter, you
can enable the ModBus to respond to queries:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; modbus -e
</pre></div>
</div>
<p>Now you will be able to read the ModBus registers using an application like <code class="docutils literal notranslate"><span class="pre">mbpoll</span></code>.
For more information, check <a class="reference external" href="https://www.youtube.com/watch?v=bLUGLJIjt4E">this video</a>.</p>
</section>
<section id="module">
<h3>module<a class="headerlink" href="#module" title="Permalink to this headline"></a></h3>
<p>This config is to run apps/examples/module.</p>
</section>
<section id="mqttc">
<h3>mqttc<a class="headerlink" href="#mqttc" title="Permalink to this headline"></a></h3>
<p>This configuration tests the MQTT-C publisher example.</p>
<p>From the host, start the broker and subscribe to the <code class="code docutils literal notranslate"><span class="pre">test</span></code> topic.  Using
<code class="docutils literal notranslate"><span class="pre">mosquitto</span></code> this should be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mosquitto&amp;
$ mosquitto_sub -t test
</pre></div>
</div>
<p>From the NSH, connect to an access point:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wapi psk wlan0 mypasswd 1
nsh&gt; wapi essid wlan0 myssid 1
nsh&gt; renew wlan0
</pre></div>
</div>
<p>Publish to the broker:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mqttc_pub -h 192.168.1.11
</pre></div>
</div>
<p>The default behavior is to publish the message <code class="code docutils literal notranslate"><span class="pre">test</span></code>.  The following should be
outputted:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mqttc_pub -h 192.168.1.11
     Success: Connected to broker!
     Success: Published to broker!

     Disconnecting from 192.168.1.11
</pre></div>
</div>
<p>From the host the message <code class="code docutils literal notranslate"><span class="pre">test</span></code> should be outputted.</p>
</section>
<section id="ms5611">
<h3>ms5611<a class="headerlink" href="#ms5611" title="Permalink to this headline"></a></h3>
<p>This configuration enables the use of the MS5611 pressure sensor over I2C.
You can check that the sensor is working by using the <code class="docutils literal notranslate"><span class="pre">sensortest</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; sensortest baro0
baro0: timestamp:66870000 value1:1008.37 value2:31.70
baro0: timestamp:66890000 value1:1008.31 value2:31.70
</pre></div>
</div>
</section>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this headline"></a></h3>
<p>Basic NuttShell configuration (console enabled in UART0, exposed via
USB connection by means of CP2102 converter, at 115200 bps).</p>
</section>
<section id="nxlooper">
<h3>nxlooper<a class="headerlink" href="#nxlooper" title="Permalink to this headline"></a></h3>
<p>This configuration uses the I2S1 peripheral as an I2S receiver and the I2S0
peripheral as an I2S transmitter. The idea is to capture an I2S data frame
using an I2S peripheral and reproduce the captured data on the other.</p>
<p><strong>Receiving data on I2S1</strong></p>
<p>The I2S1 will act as a receiver (master mode), capturing data from DIN, which
needs to be connected to an external source as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>22</p></td>
<td><p>BCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>WS</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>DIN</p></td>
<td><p>Data IN</p></td>
</tr>
</tbody>
</table>
<p><strong>Transmitting data on I2S0</strong></p>
<p>The I2S0 will act as a transmitter (master mode), replicating the data
captured on I2S1. The pinout for the transmitter is as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ESP32 Pin</p></th>
<th class="head"><p>Signal Pin</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>MCLK</p></td>
<td><p>Master Clock</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>BCLK</p></td>
<td><p>Bit Clock (SCLK)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>WS</p></td>
<td><p>Word Select (LRCLK)</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>DOUT</p></td>
<td><p>Data Out</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The audio codec CS4344 can be connected to the transmitter pins
to reproduce the captured data if the receiver’s source is an audio data.</p>
</div>
<p><strong>nxlooper</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">nxlooper</span></code> application captures data from the audio device with receiving
capabilities (the I2S1 on this example) and forwards the audio data frame to
the audio device with transmitting capabilities (the I2S0 on this example).</p>
<p>After successfully built and flashed, run on the boards’s terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; nxlooper
nxlooper&gt; loopback
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">loopback</span></code> command default arguments for the channel configuration,
the data width and the sample rate are, respectively, 2 channels,
16 bits/sample and 48KHz. These arguments can be supplied to select
different audio formats, for instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nxlooper&gt; loopback 2 8 44100
</pre></div>
</div>
</div>
</section>
<section id="oneshot">
<h3>oneshot<a class="headerlink" href="#oneshot" title="Permalink to this headline"></a></h3>
<p>This config demonstrate the use of oneshot timers present on the ESP32.
To test it, just run the <code class="docutils literal notranslate"><span class="pre">oneshot</span></code> example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; oneshot
Opening /dev/oneshot
Maximum delay is 4294967295999999
Starting oneshot timer with delay 2000000 microseconds
Waiting...
Finished
</pre></div>
</div>
</section>
<section id="ostest">
<h3>ostest<a class="headerlink" href="#ostest" title="Permalink to this headline"></a></h3>
<p>This is the NuttX test at <code class="docutils literal notranslate"><span class="pre">apps/testing/ostest</span></code> that is run against all new
architecture ports to assure a correct implementation of the OS. The default
version is for a single CPU but can be modified for an SMP test by adding:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_SMP=y
CONFIG_SMP_NCPUS=2
CONFIG_SPINLOCK=y
</pre></div>
</div>
</section>
<section id="pm">
<h3>pm<a class="headerlink" href="#pm" title="Permalink to this headline"></a></h3>
<p>This configuration enables the CPU power management through governors.</p>
</section>
<section id="psram">
<h3>psram<a class="headerlink" href="#psram" title="Permalink to this headline"></a></h3>
<p>This config tests the PSRAM driver over SPIRAM interface.
You can use the ramtest command to test the PSRAM memory. We are testing
only 64KB on this example (64 * 1024), but you can change this number to
2MB or 4MB depending on PSRAM chip used on your board:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ramtest -w 0x3F800000 65536
RAMTest: Marching ones: 3f800000 65536
RAMTest: Marching zeroes: 3f800000 65536
RAMTest: Pattern test: 3f800000 65536 55555555 aaaaaaaa
RAMTest: Pattern test: 3f800000 65536 66666666 99999999
RAMTest: Pattern test: 3f800000 65536 33333333 cccccccc
RAMTest: Address-in-address test: 3f800000 65536
</pre></div>
</div>
</section>
<section id="psram-usrheap">
<h3>psram_usrheap<a class="headerlink" href="#psram-usrheap" title="Permalink to this headline"></a></h3>
<p>This configuration works just like <code class="docutils literal notranslate"><span class="pre">psram</span></code> but allocating the user
heap on the PSRAM.</p>
</section>
<section id="pwm">
<h3>pwm<a class="headerlink" href="#pwm" title="Permalink to this headline"></a></h3>
<p>This configuration demonstrates the use of PWM through a LED connected to GPIO12.
To test it, just execute the <code class="docutils literal notranslate"><span class="pre">pwm</span></code> application:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; pwm
pwm_main: starting output with frequency: 10000 duty: 00008000
pwm_main: stopping output
</pre></div>
</div>
</section>
<section id="random">
<h3>random<a class="headerlink" href="#random" title="Permalink to this headline"></a></h3>
<p>This configuration shows the use of the ESP32’s True Random Number Generator with
entropy sourced from Wi-Fi and Bluetooth noise.
To test it, just run <code class="docutils literal notranslate"><span class="pre">rand</span></code> to get 32 randomly generated bytes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; rand
Reading 8 random numbers
Random values (0x3ffe0b00):
0000  98 b9 66 a2 a2 c0 a2 ae 09 70 93 d1 b5 91 86 c8  ..f......p......
0010  8f 0e 0b 04 29 64 21 72 01 92 7c a2 27 60 6f 90  ....)d!r..|.&#39;`o.
</pre></div>
</div>
</section>
<section id="rtc">
<h3>rtc<a class="headerlink" href="#rtc" title="Permalink to this headline"></a></h3>
<p>This configuration demonstrates the use of the RTC driver through alarms.
You can set an alarm, check its progress and receive a notification after it expires:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; alarm 10
alarm_daemon started
alarm_daemon: Running
Opening /dev/rtc0
Alarm 0 set in 10 seconds
nsh&gt; alarm -r
Opening /dev/rtc0
Alarm 0 is active with 10 seconds to expiration
nsh&gt; alarm_daemon: alarm 0 received
</pre></div>
</div>
</section>
<section id="smp">
<h3>smp<a class="headerlink" href="#smp" title="Permalink to this headline"></a></h3>
<p>Another NSH configuration, similar to nsh, but also enables
SMP operation. It differs from the nsh configuration only in these
additional settings:</p>
<p>SMP is enabled:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_SMP=y
CONFIG_SMP_NCPUS=2
CONFIG_SPINLOCK=y
</pre></div>
</div>
<p>The apps/testing/smp test is included:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_TESTING_SMP=y
CONFIG_TESTING_SMP_NBARRIER_THREADS=8
CONFIG_TESTING_SMP_PRIORITY=100
CONFIG_TESTING_SMP_STACKSIZE=2048
</pre></div>
</div>
</section>
<section id="sotest">
<h3>sotest<a class="headerlink" href="#sotest" title="Permalink to this headline"></a></h3>
<p>This config is to run <code class="docutils literal notranslate"><span class="pre">apps/examples/sotest</span></code>.</p>
</section>
<section id="spiflash">
<h3>spiflash<a class="headerlink" href="#spiflash" title="Permalink to this headline"></a></h3>
<p>This config tests the external flash memory that comes with the ESP32 module
connected through SPI1.</p>
<p>By default a SmartFS file system is selected.
Once booted you can use the following commands to mount the file system:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mksmartfs /dev/smart0
nsh&gt; mount -t smartfs /dev/smart0 /mnt
</pre></div>
</div>
<p>Note that mksmartfs is only needed the first time.</p>
</section>
<section id="sta-softap">
<h3>sta_softap<a class="headerlink" href="#sta-softap" title="Permalink to this headline"></a></h3>
<p>With this configuration you can run these commands to be able
to connect your smartphone or laptop to your board:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; ifup wlan1
nsh&gt; dhcpd_start wlan1
nsh&gt; wapi psk wlan1 mypasswd 3
nsh&gt; wapi essid wlan1 nuttxap 1
</pre></div>
</div>
<p>In this case, you are creating the access point <code class="docutils literal notranslate"><span class="pre">nuttxapp</span></code> in your board and to
connect to it on your smartphone you will be required to type the password <code class="docutils literal notranslate"><span class="pre">mypasswd</span></code>
using WPA2.
The <code class="docutils literal notranslate"><span class="pre">dhcpd_start</span></code> is necessary to let your board to associate an IP to your smartphone.</p>
</section>
<section id="tickless">
<h3>tickless<a class="headerlink" href="#tickless" title="Permalink to this headline"></a></h3>
<p>This configuration enables the support for tickless scheduler mode.</p>
</section>
<section id="timer">
<h3>timer<a class="headerlink" href="#timer" title="Permalink to this headline"></a></h3>
<p>This config test the general use purpose timers. It includes the 4 timers,
adds driver support, registers the timers as devices and includes the timer
example.</p>
<p>To test it, just run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; timer -d /dev/timerx
</pre></div>
</div>
<p>Where x in the timer instance.</p>
</section>
<section id="wamr-wasi-debug">
<h3>wamr_wasi_debug<a class="headerlink" href="#wamr-wasi-debug" title="Permalink to this headline"></a></h3>
<p>This config is an example to use wasm-micro-runtime.
It can run both of wasm bytecode and AoT compiled modules.</p>
<p>This example uses littlefs on ESP32’s SPI flash to store wasm modules.</p>
<ol class="arabic">
<li><p>Create a littlefs image which contains wasm modules.</p>
<p><a class="reference external" href="https://github.com/jrast/littlefs-python/blob/master/examples/mkfsimg.py">https://github.com/jrast/littlefs-python/blob/master/examples/mkfsimg.py</a>
is used in the following example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% python3 mkfsimg.py \
  --img-filename ..../littlefs.bin \
  --img-size 3080192 \
  --block-size 4096 \
  --prog-size 256 \
  --read-size 256 \
  ..../wasm_binary_directory
</pre></div>
</div>
</li>
<li><p>Write the NuttX image and the filesystem to ESP32:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% esptool.py \
  --chip esp32 \
  --port /dev/tty.SLAB_USBtoUART \
  --baud 921600 \
  write_flash \
  0x1000 ..../bootloader-esp32.bin \
  0x8000 ..../partition-table-esp32.bin \
  0x10000 nuttx.bin \
  0x180000 ..../littlefs.bin
</pre></div>
</div>
</li>
<li><p>Mount the filesystem and run a wasm module on it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mount -t littlefs /dev/esp32flash /mnt
nsh&gt; iwasm /mnt/....
</pre></div>
</div>
</li>
</ol>
</section>
<section id="wifi">
<h3>wifi<a class="headerlink" href="#wifi" title="Permalink to this headline"></a></h3>
<p>Enables Wi-Fi support. You can define your credentials this way:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make menuconfig
-&gt; Application Configuration
    -&gt; Network Utilities
        -&gt; Network initialization (NETUTILS_NETINIT [=y])
            -&gt; WAPI Configuration
</pre></div>
</div>
<p>Or if you don’t want to keep it saved in the firmware you can do it
at runtime:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wapi psk wlan0 mypasswd 3
nsh&gt; wapi essid wlan0 myssid 1
nsh&gt; renew wlan0
</pre></div>
</div>
</section>
<section id="wifi-smp">
<h3>wifi_smp<a class="headerlink" href="#wifi-smp" title="Permalink to this headline"></a></h3>
<p>This configuration is similar to <code class="docutils literal notranslate"><span class="pre">wifi</span></code>. It also enables multiple cores on the CPU.</p>
</section>
<section id="watchdog">
<h3>watchdog<a class="headerlink" href="#watchdog" title="Permalink to this headline"></a></h3>
<p>This config test the watchdog timers. It includes the 2 MWDTS,
adds driver support, registers the WDTs as devices and includes the watchdog
example.</p>
<p>To test it, just run the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; wdog -i /dev/watchdogx
</pre></div>
</div>
<p>Where x is the watchdog instance.</p>
</section>
<section id="watcher">
<h3>watcher<a class="headerlink" href="#watcher" title="Permalink to this headline"></a></h3>
<p>This configuration is an example of monitoring watchdog interrupts. To test it, enable
the watcher daemon with <code class="docutils literal notranslate"><span class="pre">watcher</span></code> and monitor the tasks using <code class="docutils literal notranslate"><span class="pre">watched</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; watcher
Watcher Daemon has started!
nsh&gt; watched
Starting watched tasks
Creating Watched Task 1 - It will not feed the dog
Creating Watched Task 2 - It will feed the dog
Creating Watched Task 3 - It will feed the dog
Creating Watched Task 4 - It will not feed the dog
nsh&gt; *** Printing Tasks Status ***
Watched Task 1 starved the dog.
Watched Task 2 fed the dog.
Watched Task 3 fed the dog.
Watched Task 4 fed the dog.
*** Printing Tasks Status ***
Watched Task 1 starved the dog.
Watched Task 2 fed the dog.
Watched Task 3 fed the dog.
Watched Task 4 starved the dog.
</pre></div>
</div>
</section>
<section id="wifinsh">
<h3>wifinsh<a class="headerlink" href="#wifinsh" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">wifinsh</span></code> is similar to the <code class="docutils literal notranslate"><span class="pre">wifi</span></code> board example, but it will connect
automatically to your Access Point (Wi-Fi Router) and will run telnet daemon
in the board. Then you can connect to your board from your computer using the
telnet program.</p>
<p>After configuring the <code class="docutils literal notranslate"><span class="pre">esp32-devkit:wifinsh</span></code> you need to define your creden-
tials in the menuconfig. You can define your credentials this way:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make menuconfig
-&gt; Application Configuration
    -&gt; Network Utilities
        -&gt; Network initialization (NETUTILS_NETINIT [=y])
            -&gt; WAPI Configuration
</pre></div>
</div>
<p>Find your board IP using <code class="docutils literal notranslate"><span class="pre">nsh&gt;</span> <span class="pre">ifconfig</span></code> and then from your computer:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ telnet 192.168.x.y
</pre></div>
</div>
<p>Where x and y are the last two numbers of the IP that your router gave to
your board.</p>
</section>
</section>
<section id="debugging-with-openocd">
<h2>Debugging with OpenOCD<a class="headerlink" href="#debugging-with-openocd" title="Permalink to this headline"></a></h2>
<section id="akizukidenshi-ft232hl">
<h3>Akizukidenshi FT232HL<a class="headerlink" href="#akizukidenshi-ft232hl" title="Permalink to this headline"></a></h3>
<p>Akizukidenshi’s FT232HL, a FT232H based JTAG adapter
(<a class="reference external" href="http://akizukidenshi.com/catalog/g/gK-06503/">http://akizukidenshi.com/catalog/g/gK-06503/</a>) with JP3 and JP4 closed,
and connected to ESP32 as:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 33%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>ESP32-DevKitC V4</p></th>
<th class="head"><p>FT232HL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>J2</p></td>
<td><p>J3</p></td>
<td><p>J2</p></td>
</tr>
<tr class="row-odd"><td><p>IO13</p></td>
<td></td>
<td><p>AD0   (TCK)</p></td>
</tr>
<tr class="row-even"><td><p>IO12</p></td>
<td></td>
<td><p>AD1   (TDI)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>IO15</p></td>
<td><p>AD2   (TDO)</p></td>
</tr>
<tr class="row-even"><td><p>IO14</p></td>
<td></td>
<td><p>AD3   (TMS)</p></td>
</tr>
<tr class="row-odd"><td><p>GND</p></td>
<td></td>
<td><p>GND</p></td>
</tr>
</tbody>
</table>
<p>can be used with ESP-IDF version of openocd with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>% openocd -f board/esp32-wrover-kit-1.8v.cfg
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../esp32-audio-kit/index.html" class="btn btn-neutral float-left" title="ESP32-AUDIO-KIT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../esp32-ethernet-kit/index.html" class="btn btn-neutral float-right" title="ESP32-Ethernet-Kit V1.2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>