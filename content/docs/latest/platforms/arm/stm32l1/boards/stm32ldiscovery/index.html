<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ST STM32L Discovery &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="ST STM32L4" href="../../../stm32l4/index.html" />
    <link rel="prev" title="ST Nucleo-L152RE" href="../nucleo-l152re/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a64/index.html">Allwinner A64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">ST STM32L1</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#supported-mcus">Supported MCUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../nucleo-l152re/index.html">ST Nucleo-L152RE</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">ST STM32L Discovery</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l4/index.html">ST STM32L4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">AVR8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">ST STM32L1</a></li>
      <li class="breadcrumb-item active">ST STM32L Discovery</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/stm32l1/boards/stm32ldiscovery/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="st-stm32l-discovery">
<h1>ST STM32L Discovery<a class="headerlink" href="#st-stm32l-discovery" title="Permalink to this heading"></a></h1>
<p>This page discusses issues unique to NuttX configurations for the
STMicro STM32L-Discovery development board.  The STM32L-Discovery board
is based on the STM32L152RBT6 MCU (128KB FLASH and 16KB of SRAM).</p>
<p>The STM32L-Discovery and 32L152CDISCOVERY kits are functionally
equivalent. The difference is the internal Flash memory size (STM32L152RBT6
with 128 Kbytes or STM32L152RCT6 with 256 Kbytes).</p>
<p>Both boards feature:</p>
<ul class="simple">
<li><p>An ST-LINK/V2 embedded debug tool interface,</p></li>
<li><p>LCD (24 segments, 4 commons),</p></li>
<li><p>LEDs,</p></li>
<li><p>Pushbuttons,</p></li>
<li><p>A linear touch sensor, and</p></li>
<li><p>Four touchkeys.</p></li>
</ul>
<section id="leds">
<h2>LEDs<a class="headerlink" href="#leds" title="Permalink to this heading"></a></h2>
<p>The STM32L-Discovery board has four LEDs.  Two of these are controlled by
logic on the board and are not available for software control:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>LD1 COM:   LD2 default status is red. LD2 turns to green to indicate
           that communications are in progress between the PC and the
           ST-LINK/V2.
LD2 PWR:   Red LED indicates that the board is powered.
</pre></div>
</div>
<p>And two LEDs can be controlled by software:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>User LD3:  Green LED is a user LED connected to the I/O PB7 of the
           STM32L152 MCU.
User LD4:  Blue LED is a user LED connected to the I/O PB6 of the
           STM32L152 MCU.
</pre></div>
</div>
<p>These LEDs are not used by the board port unless CONFIG_ARCH_LEDS is
defined.  In that case, the usage by the board port is defined in
include/board.h and src/stm32_autoleds.c. The LEDs are used to encode
OS-related events as follows:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SYMBOL</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>LED3</p></th>
<th class="head"><p>LED4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LED_STARTED</p></td>
<td><p>NuttX has been started</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_HEAPALLOCATE</p></td>
<td><p>Heap has been allocated</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_IRQSENABLED</p></td>
<td><p>Interrupts enabled</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_STACKCREATED</p></td>
<td><p>Idle stack created</p></td>
<td><p>ON</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-even"><td><p>LED_INIRQ</p></td>
<td><p>In an interrupt</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
</tr>
<tr class="row-odd"><td><p>LED_SIGNAL</p></td>
<td><p>In a signal handler</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
</tr>
<tr class="row-even"><td><p>LED_ASSERTION</p></td>
<td><p>An assertion failed</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
</tr>
<tr class="row-odd"><td><p>LED_PANIC</p></td>
<td><p>The system has crashed</p></td>
<td><p>OFF</p></td>
<td><p>Blinking</p></td>
</tr>
<tr class="row-even"><td><p>LED_IDLE</p></td>
<td><p>STM32 is is sleep mode</p></td>
<td><p>N/U</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="serial-console">
<h2>Serial Console<a class="headerlink" href="#serial-console" title="Permalink to this heading"></a></h2>
<p>The STM32L-Discovery has no on-board RS-232 driver.  Further, there are no
USART pins that do not conflict with the on board resources, in particular,
the LCD:  Most USART pins are available if the LCD is enabled; USART2 may
be used if either the LCD or the on-board LEDs are disabled.</p>
<blockquote>
<div><p>PA9   USART1_TX  LCD glass COM1  P2, pin 22
PA10  USART1_RX  LCD glass COM2  P2, pin 21
PB6   USART1_TX  LED Blue        P2, pin 8
PB7   USART1_RX  LED Green       P2, pin 7</p>
<p>PA2   USART2_TX  LCD SEG1        P1, pin 17
PA3   USART2_RX  LCD SEG2        P1, pin 18</p>
<p>PB10  USART3_TX LCD SEG6         P1, pin 22
PB11  USART3_RX LCD SEG7         P1, pin 23
PC10  USART3_TX LCD SEG22        P2, pin 15
PC11  USART3_RX LCD SEG23        P2, pin 14</p>
</div></blockquote>
<p>NOTES:</p>
<ul>
<li><p>GND and (external) 5V are available on both P1 and P2.  Note:  These
signals may be at lower voltage levels and, hence, may not properly
drive an external RS-232 transceiver.</p></li>
<li><p>The crystal X3 is not installed on the STM32L3-Discovery.  As a result,
the HSE clock is not available and the less accurate HSI must be used.
This may limit the accuracy of the computed baud, especially at higher
BAUD.  The HSI is supposedly calibrated in the factory to within 1% at
room temperatures so perhaps this not a issue.</p></li>
<li><p>According to the STM32L-Discovery User Manual, the LCD should be removed
from its socket if you use any of the LCD pins for any other purpose.</p>
<p>I have had no problems using the USART1 with PA9 and PA10 with a 3.3-5V
RS-232 transceiver module at 57600 baud.  I have not tried higher baud
rates.</p>
</li>
<li><p>There is no support for a USB serial connector on the STM32L-Discovery
board.  The STM32L152 does support USB, but the USB pins are “free I/O”
on the board and no USB connector is provided. So the use of a USB
console is not option.  If you need console output, you will need to
disable either LCD (and use any USART) or the LEDs (and use USART1)</p></li>
</ul>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading"></a></h2>
<p>If you are going to use a debugger, you should make sure that the following
settings are selection in your configuration file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_DEBUG_SYMBOLS=y     : Enable debug symbols in the build
CONFIG_ARMV7M_USEBASEPRI=y : Use the BASEPRI register to disable interrupts
</pre></div>
</div>
<section id="stm32-st-link-utility">
<h3>STM32 ST-LINK Utility<a class="headerlink" href="#stm32-st-link-utility" title="Permalink to this heading"></a></h3>
<p>For simply writing to FLASH, I use the STM32 ST-LINK Utility.  At least
version 2.4.0 is required (older versions do not recognize the STM32 F3
device).  This utility is available from free from the STMicro website.</p>
</section>
<section id="openocd">
<h3>OpenOCD<a class="headerlink" href="#openocd" title="Permalink to this heading"></a></h3>
<p>I am told that OpenOCD will work with the ST-Link, but I have never tried
it.</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/texane/stlink">https://github.com/texane/stlink</a></p>
</div></blockquote>
<p>This is an open source server for the ST-Link that I have never used.</p>
</section>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>Each STM32L-Discovery configuration is maintained in a sub-directory and
can be selected as follow:</p>
<blockquote>
<div><p>tools/configure.sh STM32L-Discovery:&lt;subdir&gt;</p>
</div></blockquote>
<p>Where &lt;subdir&gt; is one of the following sub-directories.</p>
<p>NOTE:  These configurations use the mconf-based configuration tool.  To
change any of these configurations using that tool, you should:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Build and install the kconfig-mconf tool.  See nuttx/README.txt
see additional README.txt files in the NuttX tools repository.</p></li>
<li><p>Execute ‘make menuconfig’ in nuttx/ in order to start the
reconfiguration process.</p></li>
</ol>
</div></blockquote>
<section id="configuration-sub-directories">
<h3>Configuration sub-directories<a class="headerlink" href="#configuration-sub-directories" title="Permalink to this heading"></a></h3>
</section>
<section id="nsh">
<h3>nsh:<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at apps/examples/nsh.</p>
<p>NOTES:</p>
<ol class="arabic">
<li><p>The serial console is on UART1 and NuttX LED support is enabled.
Therefore, you will need an external RS232 driver or TTL serial-to-
USB converter.  The UART1 TX and RX pins should be available on
PA9 and PA10, respectively.</p>
<p>The serial console is configured for 57600 8N1 by default.</p>
</li>
<li><p>Support for NSH built-in applications is <em>not</em> enabled.</p></li>
<li><p>By default, this configuration uses the ARM EABI toolchain
for Windows and builds under Cygwin (or probably MSYS).  That
can easily be reconfigured, of course.</p>
<p>Build Setup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    CONFIG_HOST_WINDOWS=y                   : Builds under Windows
    CONFIG_WINDOWS_CYGWIN=y                 : Using Cygwin

System Type::

    CONFIG_ARM_TOOLCHAIN_GNU_EABI=y      : GNU EABI toolchain for Windows
</pre></div>
</div>
</li>
<li><p>SLCD.
When the LCD is enabled and the LEDs are disabled, the USART1
serial console will automatically move to PB6 and PB7 (you will get
a compilation error if you forget to disable the LEDs).</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SIGNAL</p></th>
<th class="head"><p>FUNCTION</p></th>
<th class="head"><p>LED</p></th>
<th class="head"><p>CONNECTION</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PB6</p></td>
<td><p>USART1_TX</p></td>
<td><p>LED Blue</p></td>
<td><p>P2, pin 8</p></td>
</tr>
<tr class="row-odd"><td><p>PB7</p></td>
<td><p>USART1_RX</p></td>
<td><p>LED Green</p></td>
<td><p>P2, pin 7</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>To enable apps/examples/slcd to test the SLCD:</p>
<p>Binary Formats:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_BINFMT_DISABLE=n                 : Don&#39;t disable binary support
CONFIG_BUILTIN=y                        : Enable support for built-in binaries
</pre></div>
</div>
<p>Application Configuration -&gt; NSH Library:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_NSH_BUILTIN_APPS=y               : Enable builtin apps in NSH
CONFIG_NSH_ARCHINIT=y                   : Needed to initialize the SLCD
</pre></div>
</div>
<p>Application Configuration -&gt; Examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_EXAMPLES_SLCD=y                  : Enable apps/examples/slcd
</pre></div>
</div>
</li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../nucleo-l152re/index.html" class="btn btn-neutral float-left" title="ST Nucleo-L152RE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../stm32l4/index.html" class="btn btn-neutral float-right" title="ST STM32L4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>