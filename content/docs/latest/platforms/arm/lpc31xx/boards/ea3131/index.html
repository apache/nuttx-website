<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EA3131 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
      <script src="../../../../../_static/jquery.js"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
      <script src="../../../../../_static/doctools.js"></script>
      <script src="../../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../../_static/clipboard.min.js"></script>
      <script src="../../../../../_static/copybutton.js"></script>
      <script src="../../../../../_static/design-tabs.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="EA3152" href="../ea3152/index.html" />
    <link rel="prev" title="NXP LPC31xx" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../../../12.9.0" >12.9.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a1x/index.html">Allwinner A10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../am335x/index.html">TI/Sitara AM335x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../at32/index.html">Artery AT32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bcm2708/index.html">Broadcom BCM2708 (removed)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c5471/index.html">TI TMS320-C5471</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cxd56xx/index.html">Sony CXD56xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dm320/index.html">TI TMS320-DM320</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../efm32/index.html">SiLabs EFM32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eoss3/index.html">EOSS3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fvp-v8r-aarch32/index.html">FVP ARMv8-R Virt Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gd32f4/index.html">GD32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/goldfish_timer.html">GOLDFISH TIMER</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/index.html">GOLDFISH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx1/index.html">NXP/Freescale i.MX1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx6/index.html">NXP/Freescale i.MX6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx9/index.html">NXP i.MX9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">NXP i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kinetis/index.html">NXP/FreeScale Kinetis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kl/index.html">NXP/FreeScale KLxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lc823450/index.html">ON Semiconductor LC823450</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc17xx/index.html">NXP LPC17xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc214x/index.html">NXP LPC214x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc2378/index.html">NXP LPC2378</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">NXP LPC31xx</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">EA3131</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ea3152/index.html">EA3152</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimex-lpc-h3131/index.html">Olimex LPC-H3131</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc40xx/index.html">NXP LPC40xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc43xx/index.html">NXP LPC43xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc54xx/index.html">NXP LPC54xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../max326xx/index.html">Maxim Integrated MAX32660</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../moxart/index.html">Moxa NP51x0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mps/index.html">MPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/ieee802154.html">Nordic nRF52 IEEE 802.15.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nuc1xx/index.html">nuvoTon NUC120</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phy62xx/index.html">PHY+ PHY62</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu/index.html">QEMU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ra4m1/index.html">Renesas RA4M1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">RaspberryPi rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp23xx/index.html">RaspberryPi rp2350</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sam34/index.html">Microchip SAM34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sama5/index.html">Microchip SAMA5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd2l2/index.html">Microchip SAMD2x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd5e5/index.html">Microchip samd5e5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">Microchip SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32c0/index.html">ST STM32C0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h5/index.html">ST STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l4/index.html">ST STM32L4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../str71x/index.html">ST STR71</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tiva/index.html">TI/Stellaris Tiva</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tms570/index.html">TI/Hercules TMS570xxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/context-switch-notes.html">Notes on AVR context switch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_linux.html">Network Support on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_vpnkit.html">Network support with VPNKit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">NXP LPC31xx</a></li>
      <li class="breadcrumb-item active">EA3131</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/lpc31xx/boards/ea3131/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ea3131">
<h1>EA3131<a class="headerlink" href="#ea3131" title="Permalink to this heading"></a></h1>
<p>This documentation discusses the port of NuttX to the Embedded Artists EA3131 board.</p>
<section id="development-environment">
<h2>Development Environment<a class="headerlink" href="#development-environment" title="Permalink to this heading"></a></h2>
<p>Either Linux or Cygwin on Windows can be used for the development environment.
The source has been built only using the GNU toolchain (see below). Other
toolchains will likely cause problems.</p>
</section>
<section id="gnu-toolchain-options">
<h2>GNU Toolchain Options<a class="headerlink" href="#gnu-toolchain-options" title="Permalink to this heading"></a></h2>
<p>The NuttX make system has been modified to support the following different
toolchain options.</p>
<ol class="arabic simple">
<li><p>The NuttX buildroot Toolchain (see below), or</p></li>
<li><p>Any generic arm-none-eabi GNU toolchain.</p></li>
</ol>
<p>All testing has been conducted using the NuttX buildroot toolchain.  To use
a different toolchain, you simply need to modify the configuration.  As an
example:</p>
<p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARM_TOOLCHAIN_GNU_EABI</span></code>: Generic arm-none-eabi toolchain</p>
<section id="generic-arm-none-eabi-gnu-toolchain">
<h3>Generic arm-none-eabi GNU Toolchain<a class="headerlink" href="#generic-arm-none-eabi-gnu-toolchain" title="Permalink to this heading"></a></h3>
<p>There are a number of toolchain projects providing support for ARMv4/v5 class
processors, including <a class="reference external" href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm">GCC ARM Embedded</a></p>
<p>Others exist for various Linux distributions, MacPorts, etc.  Any version based
on GCC 4.6.3 or later should work.</p>
</section>
</section>
<section id="ides">
<h2>IDEs<a class="headerlink" href="#ides" title="Permalink to this heading"></a></h2>
<p>NuttX is built using command-line make.  It can be used with an IDE, but some
effort will be required to create the project.</p>
<section id="makefile-build">
<h3>Makefile Build<a class="headerlink" href="#makefile-build" title="Permalink to this heading"></a></h3>
<p>Under Eclipse, it is pretty easy to set up an “empty makefile project” and
simply use the NuttX makefile to build the system.  That is almost for free
under Linux.  Under Windows, you will need to set up the “Cygwin GCC” empty
makefile project in order to work with Windows (Google for “Eclipse Cygwin” -
there is a lot of help on the internet).</p>
</section>
<section id="native-build">
<h3>Native Build<a class="headerlink" href="#native-build" title="Permalink to this heading"></a></h3>
<p>Here are a few tips before you start that effort:</p>
<ol class="arabic simple">
<li><p>Select the toolchain that you will be using in your .config file</p></li>
<li><p>Start the NuttX build at least one time from the Cygwin command line before
trying to create your project. This is necessary to create certain
auto-generated files and directories that will be needed.</p></li>
<li><p>Set up include paths: You will need <code class="docutils literal notranslate"><span class="pre">include/</span></code>, <code class="docutils literal notranslate"><span class="pre">arch/arm/src/lpc31xx</span></code>,
<code class="docutils literal notranslate"><span class="pre">arch/arm/src/common</span></code>, <code class="docutils literal notranslate"><span class="pre">arch/arm/src/arm</span></code>, and <code class="docutils literal notranslate"><span class="pre">sched/</span></code>.</p></li>
<li><p>All assembly files need to have the definition option <code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">__ASSEMBLY__</span></code> on
the command line.</p></li>
</ol>
<p>Startup files will probably cause you some headaches. The NuttX startup file is
<code class="docutils literal notranslate"><span class="pre">arch/arm/src/lpc31xx/lpc31_vectors.S</span></code>. You may have to build NuttX one time
from the Cygwin command line in order to obtain the pre-built startup object
needed by an IDE.</p>
</section>
</section>
<section id="nuttx-buildroot-toolchain">
<h2>NuttX buildroot Toolchain<a class="headerlink" href="#nuttx-buildroot-toolchain" title="Permalink to this heading"></a></h2>
<p>A GNU GCC-based toolchain is assumed.  The PATH environment variable should
be modified to point to the correct path to the Cortex-M3 GCC toolchain (if
different from the default in your PATH variable).</p>
<p>If you have no Cortex-M3 toolchain, one can be downloaded from the NuttX
Bitbucket download site (<a class="reference external" href="https://bitbucket.org/nuttx/buildroot/downloads/">https://bitbucket.org/nuttx/buildroot/downloads/</a>).
This GNU toolchain builds and executes in the Linux or Cygwin environment.</p>
<ol class="arabic simple">
<li><p>You must have already configured NuttX in <code class="docutils literal notranslate"><span class="pre">&lt;some-dir&gt;/nuttx</span></code>.</p></li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tools/configure.sh<span class="w"> </span>ea3131:&lt;sub-dir&gt;
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p>Download the latest buildroot package into <code class="docutils literal notranslate"><span class="pre">&lt;some-dir&gt;</span></code></p></li>
<li><p>Unpack the buildroot tarball.  The resulting directory may have versioning
information on it like <code class="docutils literal notranslate"><span class="pre">buildroot-x.y.z</span></code>.  If so, rename
<code class="docutils literal notranslate"><span class="pre">&lt;some-dir&gt;/buildroot-x.y.z</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;some-dir&gt;/buildroot</span></code>.</p></li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>&lt;some-dir&gt;/buildroot
<span class="gp">$ </span>cp<span class="w"> </span>boards/arm926t-defconfig-4.2.4<span class="w"> </span>.config
<span class="gp">$ </span>make<span class="w"> </span>oldconfig
<span class="gp">$ </span>make
</pre></div>
</div>
</li>
<li><p>Make sure that the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable includes the path to the newly built
binaries.</p></li>
</ol>
<p>See the file <code class="docutils literal notranslate"><span class="pre">boards/README.txt</span></code> in the buildroot source tree. That has more
detailed PLUS some special instructions that you will need to follow if you are
building a Cortex-M3 toolchain for Cygwin under Windows.</p>
</section>
<section id="boot-sequence">
<h2>Boot Sequence<a class="headerlink" href="#boot-sequence" title="Permalink to this heading"></a></h2>
<p>LPC313x has on chip bootrom which loads properly formatted images from multiple
sources into SRAM.  These sources include including SPI Flash, NOR Flash, UART,
USB, SD Card, and NAND Flash.</p>
<p>In all configurations, NuttX is loaded directly into ISRAM.  NuttX is linked
to execute from ISRAM, regardless of the boot source.</p>
</section>
<section id="image-format">
<h2>Image Format<a class="headerlink" href="#image-format" title="Permalink to this heading"></a></h2>
<p>In order to use the bootrom bootloader, a special header must be added to the
beginning of the binary image that includes information about the binary (things
like the entry point, the size, and CRC’s to verify the image.</p>
<p>NXP provides a Windows program to append such a header to the binary image.
However, (1) that program won’t run under Linux, and (2) when I try it under
WinXP, Symantec immediately claims that the program is misbehaving and deletes
it!</p>
<p>To work around both of these issues, I have created a small program under
<code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/tools</span></code> to add the header. This program can be built
under either Linux or Cygwin (and probably other tool environments as well).
That tool can be built as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>boards/arm/lpc31xx/ea3131/tools
<span class="gp">$ </span>make
</pre></div>
</div>
<p>Then, to build the NuttX binary ready to load with the bootloader, just
following these steps:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tools/configure.sh<span class="w"> </span>ea3131:nsh<span class="w"> </span><span class="c1"># (using the nsh configuration for this example)</span>
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>..<span class="w">                         </span><span class="c1"># Set up environment</span>
<span class="gp">$ </span>make<span class="w">                          </span><span class="c1"># Make NuttX.  This will produce nuttx.bin</span>
<span class="gp">$ </span>mklpc.sh<span class="w">                      </span><span class="c1"># Make the bootloader binary (nuttx.lpc)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic">
<li><p>You will need to set your <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable appropriately or use the full
path to <code class="docutils literal notranslate"><span class="pre">mklpc.sh</span></code> in the final step.</p></li>
<li><p>You can instruct Symantec to ignore the errors and it will stop quarantining
the NXP program.</p></li>
<li><p>The CRC32 logic in <code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/tools</span></code> doesn’t seem to work. As a result,
the CRC is currently disabled in the header:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span>RCS file: /cvsroot/nuttx/nuttx/boards/arm/lpc31xx/ea3131/tools/lpchdr.c,v
retrieving revision 1.2
<span class="gh">diff -r1.2 lpchdr.c</span>
264c264
<span class="gd">&lt;   g_hdr.imagetype       = 0x0000000b;</span>
<span class="gs">---</span>
<span class="gi">&gt;   g_hdr.imagetype       = 0x0000000a;</span>
</pre></div>
</div>
</li>
</ol>
</div>
</section>
<section id="image-download-to-isram">
<h2>Image Download to ISRAM<a class="headerlink" href="#image-download-to-isram" title="Permalink to this heading"></a></h2>
<p>Assuming that you already have the FTDI driver installed*, then here is the
are the steps that I use for loading new code into the EA3131:</p>
<ul class="simple">
<li><p>Create the bootloader binary, <code class="docutils literal notranslate"><span class="pre">nuttx.lpc</span></code>, as described above.</p></li>
<li><p>Connected the EA3131 using the FTDI USB port (not the lpc3131 USB port)
This will power up the EA3131 and start the bootloader.</p></li>
<li><p>Start a terminal emulator (such as TeraTerm) at 115200 8NI.</p></li>
<li><p>Reset the EA3131 and you should see: <code class="docutils literal notranslate"><span class="pre">LPC31xx</span> <span class="pre">READY</span> <span class="pre">FOR</span> <span class="pre">PLAIN</span> <span class="pre">IMAGE&gt;</span></code></p></li>
<li><p>Send the <code class="docutils literal notranslate"><span class="pre">nuttx.lpc</span></code> file and you should see: “Download finished”</p></li>
</ul>
<p>That will load the NuttX binary into ISRAM and attempt to execute it.</p>
<p><cite>See the LPC313x documentation if you do not have the FTDI driver installed.</cite></p>
</section>
<section id="using-openocd-and-gdb">
<h2>Using OpenOCD and GDB<a class="headerlink" href="#using-openocd-and-gdb" title="Permalink to this heading"></a></h2>
<p>I have been using the Olimex ARM-USB-OCD JTAG debugger with the EA3131
(<a class="reference external" href="http://www.olimex.com">http://www.olimex.com</a>). The OpenOCD configuration file is here:
tools/armusbocb.cfg. There is also a script on the tools directory that I used
to start the OpenOCD daemon on my system called oocd.sh. That script would
probably require some modifications to work in another environment:</p>
<ul class="simple">
<li><p>Possibly the value of <code class="docutils literal notranslate"><span class="pre">OPENOCD_PATH</span></code></p></li>
<li><p>If you are working under Linux you will need to change any
occurrences of <code class="docutils literal notranslate"><span class="pre">cygpath</span> <span class="pre">-w</span> <span class="pre">blablabla</span></code> to just blablabla</p></li>
</ul>
<p>Then you should be able to start the OpenOCD daemon like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>boards/arm/lpc31xx/ea3131/tools/oocd.sh<span class="w"> </span><span class="nv">$PWD</span>
</pre></div>
</div>
<p>Where it is assumed that you are executing oocd.sh from the top level
directory where NuttX is installed.</p>
<p>Once the OpenOCD daemon has been started, you can connect to it via
GDB using the following GDB command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">arm-nuttx-elf-gdb</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">target remote localhost:3333</span>
</pre></div>
</div>
<p>And you can load the NuttX ELF file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">symbol-file nuttx</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">load nuttx</span>
</pre></div>
</div>
</section>
<section id="on-demand-paging">
<h2>On-Demand Paging<a class="headerlink" href="#on-demand-paging" title="Permalink to this heading"></a></h2>
<p>There is a configuration that was used to verify the On-Demand Paging feature
for the ARM926 (see
<a class="reference external" href="https://bitbucket.org/nuttx/documentation/src/master/NuttXDemandPaging.html">https://bitbucket.org/nuttx/documentation/src/master/NuttXDemandPaging.html</a>).
That configuration is contained in the pgnsh sub-directory.  The pgnsh
configuration is only a test configuration, and lacks some logic to provide the
full On-Demand Paging solution (see below).</p>
<section id="page-table-layout">
<h3>Page Table Layout:<a class="headerlink" href="#page-table-layout" title="Permalink to this heading"></a></h3>
<p>The ARM926 MMU uses a page table in memory. The page table is divided
into (1) a level 1 (L1) page table that maps 1Mb memory regions to level 2
page tables (except in the case of 1Mb sections, of course), and (2) a level
2 (L2) page table that maps the 1Mb memory regions into individual 64Kb, 4kb,
or 1kb pages. The pgnsh configuration uses 1Kb pages: it positions 48x1Kb
pages at beginning of SRAM (the “locked” memory region), 16x1Kb pages at
the end of SRAM for the L1 page table, and 44x1Kb pages just before the
L1 page table. That leaves 96x1Kb virtual pages in the middle of SRAM for
the paged memory region; up to 384x1kb of physical pages may be paged into
this region. Physical memory map:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>11028000 &quot;locked&quot; text region   48x1Kb
11034000 &quot;paged&quot; text region    96x1Kb
1104c000 &quot;data&quot; region          32x1Kb
11054000 L1 page table          16x1Kb
-------- --------------------- ------
11058000                       192x1Kb
</pre></div>
</div>
<p>The virtual memory map allows more space for the paged region:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>11028000 &quot;locked&quot; text region   48x1Kb
11034000 &quot;paged&quot; text region   384x1Kb
11094000 &quot;data&quot; region          32x1Kb
1109c000 L1 page table          16x1Kb
-------- --------------------- ------
110a0000                       480x1Kb
</pre></div>
</div>
<p>The L1 contains a single 1Mb entry to span the entire LPC3131 SRAM memory
region. The virtual address for this region is <code class="docutils literal notranslate"><span class="pre">0x11028000</span></code>. The offset into
the L1 page table is given by:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="mh">0x11028000</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00000440</span>
</pre></div>
</div>
<p>The value at that offset into the L1 page table contains the address of the
L2 page table (<code class="docutils literal notranslate"><span class="pre">0x11056000</span></code>) plus some extra bits to specify that that entry
is valid and and points to a 1Kb L1 page table:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>11054440 11056013
</pre></div>
</div>
<p>Why is the address 11056000 used for the address of the L2 page table?  Isn’t
that inside of the L1 page table?  Yes, this was done to use the preceious SRAM
memory more conservatively.  If you look at the LPC313x virtual memory map, you
can see that no virtual addresses above <code class="docutils literal notranslate"><span class="pre">0x60100000</span></code> are used.  That
corresponds to L1 page table offset <code class="docutils literal notranslate"><span class="pre">0x0001800</span></code> (physical address
<code class="docutils literal notranslate"><span class="pre">0x11055800</span></code>). The rest of the L1 page table is unused and so we reuse it to
hold the L2 page table (or course, this could cause some really weird addressing
L1 mapping issues if bad virtual addresses were used in that region – oh well).
The address <code class="docutils literal notranslate"><span class="pre">0x11056000</span></code> is then the first properly aligned memory that can be
used in that L2 page table area.</p>
<p>Only only L2 page table will be used to span the LPC3131 SRAM virtual text
address region (480x1Kb).  That one entry maps the virtual address range of
<code class="docutils literal notranslate"><span class="pre">0x11000000</span></code> through <code class="docutils literal notranslate"><span class="pre">0x110ffc00</span></code>.  Each entry maps a 1Kb page of physical
memory:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PAGE      VIRTUAL ADDR L2 OFFSET
--------- ------------ ---------
Page 0    0x11000000   0x00000000
Page 1    0x11000400   0x00000004
Page 2    0x11000800   0x00000008
...
Page 1023 0x110ffc00   0x00000ffc
</pre></div>
</div>
<p>The “locked” text region begins at an offset of <code class="docutils literal notranslate"><span class="pre">0x00028000</span></code> into that region.
The 48 page table entries needed to make this region begin at:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="mh">0x00028000</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00000280</span>
</pre></div>
</div>
<p>Each entry contains the address of a physical page in the “locked” text region
(plus some extra bits to identify domains, page sizes, access privileges, etc.):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="mh">0x11000280</span><span class="w"> </span><span class="mh">0x1102800b</span>
<span class="mh">0x11000284</span><span class="w"> </span><span class="mh">0x1102840b</span>
<span class="mh">0x11000288</span><span class="w"> </span><span class="mh">0x1102880b</span>
<span class="p">...</span>
</pre></div>
</div>
<p>The locked region is initially unmapped. But the data region and page table
regions must be mapped in a similar manner. Those</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Data:
   Virtual address  = 0x11094000 Offset = 0x00064000
   Physical address = 0x1104c000
   L2 offset        = ((0x00094000 &gt;&gt; 10) &lt;&lt; 2) = 0x00000940

Page table:
   Virtual address  = 0x1109c000 Offset = 0x0009c000
   Physical address = 0x11054000
   L2 offset        = ((0x0009c000 &gt;&gt; 10) &lt;&lt; 2) = 0x000009c0
</pre></div>
</div>
</section>
<section id="build-sequence">
<h3>Build Sequence:<a class="headerlink" href="#build-sequence" title="Permalink to this heading"></a></h3>
<p>This example uses a two-pass build.  The top-level Makefile recognizes the
configuration option <code class="docutils literal notranslate"><span class="pre">CONFIG_BUILD_2PASS</span></code> and will execute the Makefile in
<code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/locked/Makefile</span></code> to build the first pass object,
locked.r. This first pass object contains all of the code that must be in the
locked text region. The Makefile in <code class="docutils literal notranslate"><span class="pre">arch/arm/src/Makefile</span></code> then includes this
1st pass in build, positioning it as controlled by
<code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/scripts/pg-ld.script</span></code>.</p>
</section>
<section id="finishing-the-example">
<h3>Finishing the Example:<a class="headerlink" href="#finishing-the-example" title="Permalink to this heading"></a></h3>
<p>This example is incomplete in that it does not have any media to reload the page
text region from: the file <code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/src/up_fillpage.c</span></code> is
only a stub. That logic to actually reload the page from some storage medium
(among other things) would have to be implemented in order to complete this
example. At present, the example works correctly up to the point where
<code class="docutils literal notranslate"><span class="pre">up_fillpage()</span></code> is first called and then fails in the expected way.</p>
<p>Here are the detailed list of things that would need to be done in addition to
finishing th <code class="docutils literal notranslate"><span class="pre">up_fillpage()</span></code> logic (this assumes that SPI NOR FLASH is the
media on which the NuttX image is stored):</p>
<ol class="arabic simple">
<li><p>Develop a NOR FLASH layout can can be used to (1) boot the locked text
section into memory on a reset, and (2) map a virtual fault address to an
offset into paged text section in NOR FLASH.</p></li>
<li><p>Develop/modify the build logic to build the binaries for this NOR flash
layout: Can the NuttX image be formed as a single image that is larger than
the IRAM?  Can we boot from such a large image?  If so, then no special build
modifications are required.  Or, does the locked section have to be smaller
with a separate paged text section image in FLASH?  In this case, some tool
will be needed to break the nuttx.bin file into the two pieces.</p></li>
<li><p>Develop a mechanism to load the NuttX image into SPI NOR FLASH.  A basic
procedure is already documented in NXP publications: “LPC313x Linux Quick
Start Guide, Version 2.0” and “AN10811 Programming SPI flash on EA3131
boards, V1 (May 1, 2009).”  That procedure may be sufficient, depending on
the decisions made in (1) and (2):</p></li>
<li><p>Develop a procedure to boot the locked text image from SPI NOR. The
references and issues related to this are discussed in (2) and (3) above.</p></li>
</ol>
<p>Basic support for paging from SPI NOR FLASH can be enabled by adding
<code class="docutils literal notranslate"><span class="pre">CONFIG_PAGING_AT45DB=y</span></code> or <code class="docutils literal notranslate"><span class="pre">CONFIG_PAGING_M25PX=y</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the TODO list in the top-level directory:</p>
<dl class="simple">
<dt>“<code class="docutils literal notranslate"><span class="pre">arch/arm/src/lpc31xx/lpc31_spi.c</span></code> may or may not be functional.  It was</dt><dd><p>reported to be working, but I was unable to get it working with the
Atmel at45dbxx serial FLASH driver.”</p>
</dd>
</dl>
</div>
</section>
<section id="alternative">
<h3>Alternative:<a class="headerlink" href="#alternative" title="Permalink to this heading"></a></h3>
<p>I have implemented an alternative within
<code class="docutils literal notranslate"><span class="pre">boards/arm/lpc31xx/ea3131/src/up_fillpage.c</span></code> which is probably only useful
for testing. Here is the usage module for this alternative:</p>
<ol class="arabic">
<li><p>Place the nuttx.bin file on an SD card.</p></li>
<li><p>Insert the SD card prior to booting</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">up_fillpage()</span></code>, use the virtual miss address (minus the virtual base
address) as an offset into the <code class="docutils literal notranslate"><span class="pre">nuttx.bin</span></code> file, and read the required page
from that offset in the <code class="docutils literal notranslate"><span class="pre">nuttx.bin</span></code> file:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">off_t</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">off_t</span><span class="p">)</span><span class="n">vpage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">PG_LOCKED_VBASE</span><span class="p">;</span>
<span class="kt">off_t</span><span class="w"> </span><span class="n">pos</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">lseek</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_SET</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="kt">off_t</span><span class="p">)</span><span class="mi">-1</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">vpage</span><span class="p">,</span><span class="w"> </span><span class="n">PAGESIZE</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
<p>In this way, the paging implementation can do on-demand paging
from an image file on the SD card.  Problems/issues with this
approach probably make it only useful for testing:</p>
<ol class="arabic simple">
<li><p>You would still have to boot the locked section over serial or using a
bootloader – it is not clear how the power up boot would occur.  For
testing, the nuttx.bin file could be both provided on the SD card and loaded
over serial.</p></li>
<li><p>If the SD card is not in place, the system will crash.</p></li>
<li><p>This means that all of the file system logic and FAT file system would have
to reside in the locked text region.</p></li>
</ol>
<p>And the show-stopper:</p>
<ol class="arabic simple" start="4">
<li><p>There is no MCI driver for the ea3131, yet!</p></li>
</ol>
</section>
</section>
<section id="arm-ea3131-specific-configuration-options">
<h2>ARM/EA3131-specific Configuration Options<a class="headerlink" href="#arm-ea3131-specific-configuration-options" title="Permalink to this heading"></a></h2>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">arch/</span></code> subdirectory.  This should be set
to:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH=arm</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_family</span></code>: For use in C code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_ARM=y</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_architecture</span></code>: For use in C code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_ARM926EJS=y</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">arch/*/chip</span></code> subdirectory</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP=lpc313x</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_name</span></code>: For use in C code</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_LPC3131</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">boards/</span></code> subdirectory and hence, the
board that supports the particular chip or SoC.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD=ea3131</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD_name</span></code>: For use in C code</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD_EA3131</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LOOPSPERMSEC</span></code>: Must be calibrated for correct operation of
delay loops</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ENDIAN_BIG</span></code>: define if big endian (default is little endian)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_SIZE</span></code>: For most ARM9 architectures, this describes the size of
installed DRAM.  For the LPC313X, it is used only to determine how to map the
executable regions.  It is SDRAM size only if you are executing out of the
external SDRAM; or it could be NOR FLASH size, external SRAM size, or internal
SRAM size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_START</span></code>: The start address of installed DRAM (physical)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_VSTART</span></code>: The startaddress of DRAM (virtual)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LEDS</span></code>: Use LEDs to show state. Unique to boards that have LEDs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_INTERRUPTSTACK</span></code>: This architecture supports an interrupt stack.
If defined, this symbol is the size of the interrupt stack in bytes.  If not
defined, the user task stacks will be used during interrupt handling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_STACKDUMP</span></code>: Do stack dumps after assertions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LEDS</span></code>:  Use LEDs to show state. Unique to board architecture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BUTTONS</span></code>:  Enable support for buttons. Unique to board
architecture.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_DMA</span></code>: Support DMA initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LOWVECTORS</span></code>: define if vectors reside at address
<code class="docutils literal notranslate"><span class="pre">0x0000:00000</span></code> Undefine if vectors reside at address <code class="docutils literal notranslate"><span class="pre">0xffff:0000</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_ROMPGTABLE</span></code>: A pre-initialized, read-only page table is
available. If defined, then board-specific logic must also define
<code class="docutils literal notranslate"><span class="pre">PGTABLE_BASE_PADDR</span></code>, <code class="docutils literal notranslate"><span class="pre">`PGTABLE_BASE_VADDR`</span></code>, and all memory section
mapping in a file named board_memorymap.h.</p></li>
</ul>
<p>Individual subsystems can be enabled:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_MCI</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_SPI</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_UART</span></code></p></li>
</ul>
<p>External memory available on the board (see also CONFIG_MM_REGIONS)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM0</span></code>: Select if external SRAM0 is present</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM0HEAP</span></code>: Select if external SRAM0 should be configured
as part of the NuttX heap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM0SIZE</span></code>: Size (in bytes) of the installed external SRAM0
memory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM1</span></code>: Select if external SRAM1 is present</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM1HEAP</span></code>: Select if external SRAM1 should be configured
as part of the NuttX heap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTSRAM1SIZE</span></code>: Size (in bytes) of the installed external SRAM1
memory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTDRAM</span></code>: Select if external SDRAM is present</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTDRAMHEAP</span></code>: Select if external SDRAM should be configured as
part of the NuttX heap.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTDRAMSIZE</span></code>: Size (in bytes) of the installed external SDRAM
memory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTNAND</span></code>: Select if external NAND is present</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LPC31_EXTNANDSIZE</span></code>: Size (in bytes) of the installed external NAND
memory</p></li>
</ul>
<p>LPC313X specific device driver settings</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_SERIAL_CONSOLE</span></code>: selects the UART for the console and ttys0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_RXBUFSIZE</span></code>: Characters are buffered as received. This specific
the size of the receive buffer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_TXBUFSIZE</span></code>: Characters are buffered before being sent.  This
specific the size of the transmit buffer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_BAUD</span></code>: The configure BAUD of the UART.  Must be</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_BITS</span></code>: The number of bits.  Must be either 7 or 8.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_PARTIY</span></code>: 0=no parity, 1=odd parity, 2=even parity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART_2STOP</span></code>: Two stop bits</p></li>
</ul>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<section id="common-configuration-notes">
<h3>Common Configuration Notes<a class="headerlink" href="#common-configuration-notes" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Each EA3131 configuration is maintained in a sub-directory and can be
selected as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">tools/configure.sh ea3131:&lt;subdir&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;subdir&gt;</span></code> is one of the configuration sub-directories described in
the following paragraph.</p>
</li>
<li><p>These configurations use the mconf-based configuration tool.  To change a
configurations using that tool, you should:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Build and install the <code class="docutils literal notranslate"><span class="pre">kconfig-mconf</span></code> tool. See <code class="docutils literal notranslate"><span class="pre">nuttx/README.txt</span></code>
see additional README.txt files in the NuttX tools repository.</p></li>
<li><p>Execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">menuconfig</span></code> in nuttx/ in order to start the
reconfiguration process.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>By default, all configurations assume the ARM EABI toolchain under Cygwin
with Windows.  This is easily reconfigured, however:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_HOST_WINDOWS=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_WINDOWS_CYGWIN=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARM_TOOLCHAIN_GNU_EABI=y</span></code></p></li>
</ul>
</li>
</ol>
</section>
<section id="locked">
<h3>locked<a class="headerlink" href="#locked" title="Permalink to this heading"></a></h3>
<p>This is not a configuration. When on-demand page is enabled then we must do a
two pass link: The first pass creates an intermediate object that has all of
the code that must be placed in the locked memory partition. This is logic that
must be locked in memory at all times.</p>
<p>The directory contains the logic necessary to do the platform specific first
pass link for the EA313x.</p>
</section>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at <code class="docutils literal notranslate"><span class="pre">examples/nsh</span></code>. The Configuration
enables only the serial NSH interface.</p>
</section>
<section id="pgnsh">
<h3>pgnsh<a class="headerlink" href="#pgnsh" title="Permalink to this heading"></a></h3>
<p>This is the same configuration as nsh, but with On-Demand paging enabled.  See
<a class="reference external" href="https://nuttx.apache.org/docs/latest/components/paging.html">https://nuttx.apache.org/docs/latest/components/paging.html</a>. This configuration
is an experiment for the purposes of test and debug.  At present, this does not
produce functioning, usable system</p>
</section>
<section id="usbserial">
<h3>usbserial<a class="headerlink" href="#usbserial" title="Permalink to this heading"></a></h3>
<p>This configuration directory exercises the USB serial class driver at
<code class="docutils literal notranslate"><span class="pre">examples/usbserial</span></code>. See <code class="docutils literal notranslate"><span class="pre">examples/README.txt</span></code> for more information.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../index.html" class="btn btn-neutral float-left" title="NXP LPC31xx" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ea3152/index.html" class="btn btn-neutral float-right" title="EA3152" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>