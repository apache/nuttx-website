<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SAM4E-EK &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
      <script src="../../../../../_static/jquery.js"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
      <script src="../../../../../_static/doctools.js"></script>
      <script src="../../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../../_static/clipboard.min.js"></script>
      <script src="../../../../../_static/copybutton.js"></script>
      <script src="../../../../../_static/design-tabs.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="SAM4L Xplained" href="../sam4l-xplained/index.html" />
    <link rel="prev" title="sam4cmp-db" href="../sam4cmp-db/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../../../12.10.0" >12.10.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a1x/index.html">Allwinner A10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../am335x/index.html">TI/Sitara AM335x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../at32/index.html">Artery AT32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bcm2708/index.html">Broadcom BCM2708 (removed)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c5471/index.html">TI TMS320-C5471</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cxd56xx/index.html">Sony CXD56xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dm320/index.html">TI TMS320-DM320</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../efm32/index.html">SiLabs EFM32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eoss3/index.html">EOSS3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fvp-v8r-aarch32/index.html">FVP ARMv8-R Virt Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gd32f4/index.html">GD32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/goldfish_timer.html">GOLDFISH TIMER</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/index.html">GOLDFISH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx1/index.html">NXP/Freescale i.MX1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx6/index.html">NXP/Freescale i.MX6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx9/index.html">NXP i.MX9</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">NXP i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kinetis/index.html">NXP/FreeScale Kinetis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kl/index.html">NXP/FreeScale KLxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lc823450/index.html">ON Semiconductor LC823450</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc17xx/index.html">NXP LPC17xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc214x/index.html">NXP LPC214x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc2378/index.html">NXP LPC2378</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc31xx/index.html">NXP LPC31xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc40xx/index.html">NXP LPC40xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc43xx/index.html">NXP LPC43xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc54xx/index.html">NXP LPC54xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../max326xx/index.html">Maxim Integrated MAX32660</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../moxart/index.html">Moxa NP51x0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../mps/index.html">MPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/ieee802154.html">Nordic nRF52 IEEE 802.15.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nuc1xx/index.html">nuvoTon NUC120</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phy62xx/index.html">PHY+ PHY62</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu/index.html">QEMU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ra4m1/index.html">Renesas RA4M1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">Raspberry Pi rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp23xx/index.html">Raspberry Pi rp2350</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Microchip SAM34</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#microchip-sam3u">Microchip SAM3U</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#microchip-sam3x">Microchip SAM3X</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#microchip-sam4l">Microchip SAM4L</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#microchip-sam4cm">Microchip SAM4CM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#microchip-sam4e">Microchip SAM4E</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#microchip-sam4s">Microchip SAM4S</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../sama5/index.html">Microchip SAMA5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd2l2/index.html">Microchip SAMD2x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd5e5/index.html">Microchip samd5e5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">Microchip SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32c0/index.html">ST STM32C0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h5/index.html">ST STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l4/index.html">ST STM32L4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../str71x/index.html">ST STR71</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tiva/index.html">TI/Stellaris Tiva</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tms570/index.html">TI/Hercules TMS570xxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_linux.html">Network Support on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/network_vpnkit.html">Network support with VPNKit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Microchip SAM34</a></li>
      <li class="breadcrumb-item active">SAM4E-EK</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/platforms/arm/sam34/boards/sam4e-ek/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sam4e-ek">
<h1>SAM4E-EK<a class="headerlink" href="#sam4e-ek" title="Permalink to this heading"></a></h1>
<p>This README discusses issues unique to NuttX configurations for the Atmel
SAM4E-EK development. This board features the SAM4E16 MCU running at 96 or
120MHz.</p>
<section id="atmel-studio-6-1">
<h2>Atmel Studio 6.1<a class="headerlink" href="#atmel-studio-6-1" title="Permalink to this heading"></a></h2>
<p>You can use Atmel Studio 6.1 to load and debug code.</p>
<ul>
<li><p>To load code into FLASH:</p>
<p>Tools menus:  Tools -&gt; Device Programming.</p>
<p>Configure the debugger and chip and you are in business.</p>
</li>
<li><p>Debugging the NuttX Object File:</p>
<ol class="arabic">
<li><p>Rename object file from <code class="docutils literal notranslate"><span class="pre">nuttx</span></code> to <code class="docutils literal notranslate"><span class="pre">nuttx.elf</span></code>. That is an extension
that will be recognized by the file menu.</p></li>
<li><p>Select the project name, the full path to the NuttX object (called just
<code class="docutils literal notranslate"><span class="pre">nuttx</span></code> with no extension), and chip. Take the time to resolve all of the
source file linkages or else you will not have source level debug!</p>
<p>File menu: File -&gt; Open -&gt; Open object file for debugging</p>
<ul class="simple">
<li><p>Select nuttx.elf object file</p></li>
<li><p>Select AT91SAM4E16</p></li>
<li><p>Select files for symbols as desired</p></li>
<li><p>Select debugger</p></li>
</ul>
</li>
<li><p>Debug menu: Debug -&gt; Start debugging and break</p>
<ul class="simple">
<li><p>This will reload the nuttx.elf file into FLASH</p></li>
</ul>
</li>
</ol>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At this point, Atmel Studio 6.1 claims that my object files are not readable.
A little more needs to be done to wring out this procedure.</p>
</div>
</section>
<section id="loading-code-with-j-link">
<h2>Loading Code with J-Link<a class="headerlink" href="#loading-code-with-j-link" title="Permalink to this heading"></a></h2>
<section id="loading-code-with-the-segger-tools-and-gdb">
<h3>Loading code with the Segger tools and GDB<a class="headerlink" href="#loading-code-with-the-segger-tools-and-gdb" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Change directories into the directory where you built NuttX.</p></li>
<li><p>Start the GDB server and wait until it is ready to accept GDB
connections.</p></li>
<li><p>Then run GDB like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arm-none-eabi-gdb
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">target remote localhost:2331</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">mon reset</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">load nuttx</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">... start debugging ...</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="loading-code-using-j-link-commander">
<h3>Loading code using J-Link Commander<a class="headerlink" href="#loading-code-using-j-link-commander" title="Permalink to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">J-Link&gt; r</span>
<span class="go">J-Link&gt; loadbin &lt;file&gt; &lt;address&gt;</span>
<span class="go">J-Link&gt; setpc &lt;address of __start&gt;</span>
<span class="go">J-Link&gt; ... start debugging ...</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As of this writing, I have not been successful writing to FLASH using the GDB
server; the write succeeds with no complaints, but the contents of the FLASH
memory remain unchanged. This may be because of issues with GPNVM1 settings
and flash lock bits? In any event, the GDB server works great for debugging
after writing the program to FLASH using SAM-BA.</p>
</div>
</section>
</section>
<section id="loading-code-openocd">
<h2>Loading Code OpenOCD<a class="headerlink" href="#loading-code-openocd" title="Permalink to this heading"></a></h2>
<p>OpenOCD scripts are available in the <code class="docutils literal notranslate"><span class="pre">boards/sam4e-ek/tools</span></code> directory. These
scripts were used with OpenOCD 0.8.0. If you use a version after OpenOCD 0.8.0,
then you should comment out the following lines in the <code class="docutils literal notranslate"><span class="pre">openocd.cfg</span></code> file:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1"># set CHIPNAME SAM4E16E</span>
<span class="c1"># source [find target/at91sam4sXX.cfg]</span>
</pre></div>
</div>
<p>And uncomment this line:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">source [find board/atmel_sam4e_ek.cfg]</span>
</pre></div>
</div>
<p>This have been reported to work under Linux, but I have not been
successful using it under Windows OpenOCD 0.8.0 with libUSB. I get:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Open On-Chip Debugger 0.8.0 (2014-04-28-08:42)</span>
<span class="go">...</span>
<span class="go">Error: libusb_open() failed with LIBUSB_ERROR_NOT_SUPPORTED</span>
<span class="go">Error: Cannot find jlink Interface! Please check connection and permissions.</span>
<span class="go">...</span>
</pre></div>
</div>
<p>This is telling me that the Segger J-Link USB driver is incompatible with
libUSB. It may be necessary to replace the Segger J-Link driver with the driver
from <code class="docutils literal notranslate"><span class="pre">libusb-win32-device-bin</span></code> on sourceforge.</p>
<ul class="simple">
<li><p>Go into Control Panel/System/Device Manager and update the J-Link driver to
point at the new <code class="docutils literal notranslate"><span class="pre">jlink.inf</span></code> file made with the <code class="docutils literal notranslate"><span class="pre">libusb-win32/bin</span>
<span class="pre">inf-wizard</span></code>. Browse to the unsigned driver pointed to by the inf, libusb0.dll
from the <code class="docutils literal notranslate"><span class="pre">libusb-win32-device-bin</span></code> distribution to complete the
installation.</p></li>
<li><p>The Segger driver appeared under “Universal Serial Bus Controllers”
in Device Manager (winXP) while the libusb-win32 driver appears as
new top level Dev Mgr category “LibUSB-Win32 Devices”.</p></li>
</ul>
</section>
<section id="writing-to-flash-using-sam-ba">
<h2>Writing to FLASH using SAM-BA<a class="headerlink" href="#writing-to-flash-using-sam-ba" title="Permalink to this heading"></a></h2>
<p>Assumed starting configuration:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>You have installed the J-Link USB driver</p></li>
</ol>
</div></blockquote>
<p>Using SAM-BA to write to FLASH:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Start the SAM-BA application, selecting (1) the SAM-ICE/J-Link
port, and (2) board = at91sam4e16-ek.</p></li>
<li><p>The SAM-BA menu should appear.</p></li>
<li><p>Select the FLASH tab and enable FLASH access</p></li>
<li><p>“Send” the file to flash</p></li>
<li><p>Enable “Boot from Flash (GPNVM1)</p></li>
<li><p>Reset the board.</p></li>
</ol>
</div></blockquote>
</section>
<section id="leds">
<h2>LEDs<a class="headerlink" href="#leds" title="Permalink to this heading"></a></h2>
<p>The SAM4E-EK board has three, user-controllable LEDs labelled D2 (blue), D3
(amber), and D4 (green) on the board. Usage of these LEDs is defined in
<code class="docutils literal notranslate"><span class="pre">include/board.h</span></code> and <code class="docutils literal notranslate"><span class="pre">src/up_leds.c</span></code>. They are encoded as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SYMBOL</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>D3</p></th>
<th class="head"><p>D2</p></th>
<th class="head"><p>D4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LED_STARTED</p></td>
<td><p>NuttX has been started</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_HEAPALLOCATE</p></td>
<td><p>Heap has been allocated</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>ON</p></td>
</tr>
<tr class="row-even"><td><p>LED_IRQSENABLED</p></td>
<td><p>Interrupts enabled</p></td>
<td><p>OFF</p></td>
<td><p>ON</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>LED_STACKCREATED</p></td>
<td><p>Idle stack created</p></td>
<td><p>OFF</p></td>
<td><p>ON</p></td>
<td><p>ON</p></td>
</tr>
<tr class="row-even"><td><p>LED_INIRQ</p></td>
<td><p>In an interrupt (note 2)</p></td>
<td><p>N/C</p></td>
<td><p>FLASH</p></td>
<td><p>N/C</p></td>
</tr>
<tr class="row-odd"><td><p>LED_SIGNAL</p></td>
<td><p>In a signal handler (note 3)</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
<td><p>FLASH</p></td>
</tr>
<tr class="row-even"><td><p>LED_ASSERTION</p></td>
<td><p>An assertion failed</p></td>
<td><p>FLASH</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
</tr>
<tr class="row-odd"><td><p>LED_PANIC</p></td>
<td><p>The system has crashed</p></td>
<td><p>FLASH</p></td>
<td><p>N/C</p></td>
<td><p>N/C</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If D2 and D4 are statically on, then NuttX probably failed to boot and these
LEDs will give you some indication of where the failure was</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The normal state is D3=OFF, D4=ON and D2 faintly glowing. This faint glow is
because of timer interrupts that result in the LED being illuminated on a
small proportion of the time.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>D4 may also flicker normally if signals are processed.</p>
</div>
</section>
<section id="serial-console">
<h2>Serial Console<a class="headerlink" href="#serial-console" title="Permalink to this heading"></a></h2>
<p>By default, all of these configurations use UART0 for the NuttX serial
console. UART0 corresponds to the DB-9 connector J17 labelled “DBGU”.
This is a male connector and will require a female-to-female, NUL modem
cable to connect to a PC.</p>
<p>An alternate is USART1 which connects to the other DB-9 connector labelled
“USART1”. USART1 is not enabled by default unless specifically noted
otherwise in the configuration description. A NUL modem cable must be
used with the port as well.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To avoid any electrical conflict, the RS232 and RS485 transceiver are
isolated from the receiving line PA21.</p>
</div>
<ul class="simple">
<li><p>Chose RS485 channel: Close 1-2 pins on JP11 and set PA23 to high level</p></li>
<li><p>Chose RS232 channel: Close 2-3 pins on JP11 and set PA23 to low level</p></li>
</ul>
<p>By default serial console is configured for 115000, 8-bit, 1 stop bit, and
no parity.</p>
</section>
<section id="networking-support">
<h2>Networking Support<a class="headerlink" href="#networking-support" title="Permalink to this heading"></a></h2>
<p>Networking support via the can be added to NSH by selecting the following
configuration options.</p>
<section id="selecting-the-emac-peripheral">
<h3>Selecting the EMAC peripheral<a class="headerlink" href="#selecting-the-emac-peripheral" title="Permalink to this heading"></a></h3>
<p>System Type -&gt; SAM34 Peripheral Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC=y</span></code>: Enable the EMAC peripheral</p></li>
</ul>
<p>System Type -&gt; EMAC device driver options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_NRXBUFFERS=16</span></code>: Set aside some RS and TX buffers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_NTXBUFFERS=4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYADDR=1</span></code>: KSZ8051 PHY is at address 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_AUTONEG=y</span></code>: Use autonegotiation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_MII=y</span></code>: Only the MII interface is supported</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR=30</span></code>: Address of PHY status register on KSZ8051</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_ALTCONFIG=y</span></code>: Needed for KSZ8051</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_ALTMODE=0x7</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_10HD=0x1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_100HD=0x2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_10FD=0x5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC_PHYSR_100FD=0x6</span></code></p></li>
</ul>
<p>PHY selection. Later in the configuration steps, you will need to select
the KSZ8051 PHY for EMAC (See below)</p>
<p>Networking Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET=y</span></code>: Enable Neworking</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_SOCKOPTS=y</span></code>: Enable socket operations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_ETH_PKTSIZE=562</span></code>: Maximum packet size 1518 is more standard</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_TCP=y</span></code>: Enable TCP/IP networking</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_TCPBACKLOG=y</span></code>: Support TCP/IP backlog</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_UDP=y</span></code>: Enable UDP networking</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_BROADCAST=y</span></code>: Needed for DNS name resolution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_ICMP=y</span></code>: Enable ICMP networking</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_ICMP_SOCKET=y</span></code>: Needed for NSH ping command</p></li>
</ul>
<p>Defaults should be okay for other options.</p>
<p>Device drivers -&gt; Network Device/PHY Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETDEVICES=y</span></code>: Enabled PHY selection</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ETH0_PHY_KSZ8051=y</span></code>: Select the KSZ8051 PHY (for EMAC)</p></li>
</ul>
<p>Application Configuration -&gt; Network Utilities</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETDB_DNSCLIENT=y</span></code>: Enable host address resolution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_TELNETD=y</span></code>: Enable the Telnet daemon</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_TFTPC=y</span></code>: Enable TFTP data file transfers for get and put commands</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_NETLIB=y</span></code>: Network library support is needed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_WEBCLIENT=y</span></code>: Needed for wget support</p></li>
</ul>
<p>Defaults should be okay for other options</p>
<p>Application Configuration -&gt; NSH Library</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_TELNET=y</span></code>: Enable NSH session via Telnet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_IPADDR=0x0a000002</span></code>: Select a fixed IP address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_DRIPADDR=0x0a000001</span></code>: IP address of gateway/host PC</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_NETMASK=0xffffff00</span></code>: Netmask</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_NOMAC=y</span></code>: Need to make up a bogus MAC address</p></li>
</ul>
<p>Defaults should be okay for other options</p>
<p>You can also enable enable the DHCPC client for networks that use dynamically
assigned address:</p>
<p>Application Configuration -&gt; Network Utilities</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_DHCPC=y</span></code>: Enables the DHCP client</p></li>
</ul>
<p>Networking Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_UDP=y</span></code>: Depends on broadcast UDP</p></li>
</ul>
<p>Application Configuration -&gt; NSH Library</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_BROADCAST=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_DHCPC=y</span></code>: Tells NSH to use DHCPC, not the fixed addresses</p></li>
</ul>
</section>
<section id="using-the-network-with-nsh">
<h3>Using the network with NSH<a class="headerlink" href="#using-the-network-with-nsh" title="Permalink to this heading"></a></h3>
<p>So what can you do with this networking support? First you see that NSH has
several new network related commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ifconfig</span></code>, <code class="docutils literal notranslate"><span class="pre">ifdown</span></code>, <code class="docutils literal notranslate"><span class="pre">ifup</span></code>: Commands to help manage your network</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get</span></code> and <code class="docutils literal notranslate"><span class="pre">put</span></code>: TFTP file transfers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wget</span></code>: HTML file transfers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ping</span></code>: Check for access to peers on the network</p></li>
<li><p>Telnet console: You can access the NSH remotely via telnet.</p></li>
</ul>
<p>You can also enable other add on features like full FTP or a Web Server or XML
RPC and others. There are also other features that you can enable like DHCP
client (or server) or network name resolution.</p>
<p>By default, the IP address of the SAM4E-EK will be <code class="docutils literal notranslate"><span class="pre">10.0.0.2</span></code> and it will
assume that your host is the gateway and has the IP address <code class="docutils literal notranslate"><span class="pre">10.0.0.1</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; ifconfig</span>
<span class="go">eth0    HWaddr 00:e0:de:ad:be:ef at UP</span>
<span class="go">        IPaddr:10.0.0.2 DRaddr:10.0.0.1 Mask:255.255.255.0</span>
</pre></div>
</div>
<p>You can use ping to test for connectivity to the host (Careful, Window firewalls
usually block ping-related ICMP traffic). On the target side, you can:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; ping 10.0.0.1</span>
<span class="go">PING 10.0.0.1 56 bytes of data</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=1 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=2 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=3 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=4 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=5 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=6 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=7 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=8 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=9 time=0 ms</span>
<span class="go">56 bytes from 10.0.0.1: icmp_seq=10 time=0 ms</span>
<span class="go">10 packets transmitted, 10 received, 0% packet loss, time 10100 ms</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this configuration is is normal to have packet loss &gt; 0% the first time
you ping due to the default handling of the ARP
table.</p>
</div>
<p>On the host side, you should also be able to ping the SAM4E-EK:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ping<span class="w"> </span><span class="m">10</span>.0.0.2
</pre></div>
</div>
<p>You can also log into the NSH from the host PC like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>telnet<span class="w"> </span><span class="m">10</span>.0.0.2
<span class="go">Trying 10.0.0.2...</span>
<span class="go">Connected to 10.0.0.2.</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="go">sh_telnetmain: Session [3] Started</span>

<span class="go">NuttShell (NSH) NuttX-6.31</span>
<span class="go">nsh&gt; help</span>
<span class="go">help usage:  help [-v] [&lt;cmd&gt;]</span>

<span class="go">  [           echo        ifconfig    mkdir       mw          sleep</span>
<span class="go">  ?           exec        ifdown      mkfatfs     ping        test</span>
<span class="go">  cat         exit        ifup        mkfifo      ps          umount</span>
<span class="go">  cp          free        kill        mkrd        put         usleep</span>
<span class="go">  cmp         get         losetup     mh          rm          wget</span>
<span class="go">  dd          help        ls          mount       rmdir       xd</span>
<span class="go">  df          hexdump     mb          mv          source</span>

<span class="go">Builtin Apps:</span>
<span class="go">nsh&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you enable this feature, you experience a delay on booting. That is
because the start-up logic waits for the network connection to be established
before starting NuttX. In a real application, you would probably want to do
the network bringup on a separate thread so that access to the NSH prompt is
not delayed.</p>
<p>This delay will be especially long if the board is not connected to a network
because additional time will be required to fail with timeout errors.</p>
<p>This delay will be especially long if the board is not connected to a
network. On the order of a minute! You will probably think that NuttX has
crashed! And then, when it finally does come up, the network will not be
available.</p>
</div>
</section>
<section id="network-initialization-thread">
<h3>Network Initialization Thread<a class="headerlink" href="#network-initialization-thread" title="Permalink to this heading"></a></h3>
<p>There is a configuration option enabled by <code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_NETINIT_THREAD</span></code> that
will do the NSH network bring-up asynchronously in parallel on a separate
thread. This eliminates the (visible) networking delay altogether. This current
implementation, however, has some limitations:</p>
<blockquote>
<div><ul class="simple">
<li><p>If no network is connected, the network bring-up will fail and the network
initialization thread will simply exit.  There are no retries and no
mechanism to know if the network initialization was successful (it could
perform a network Ioctl to see if the link is up and it now, keep trying,
but it does not do that now).</p></li>
<li><p>Furthermore, there is currently no support for detecting loss of network
connection and recovery of the connection (similarly, this thread could poll
periodically for network status, but does not).</p></li>
</ul>
</div></blockquote>
<p>Both of these shortcomings could be eliminated by enabling the network
monitor. See the SAMA5 configurations for a description of what it would
take to incorporate the network monitor feature.</p>
</section>
</section>
<section id="at25-serial-flash">
<h2>AT25 Serial FLASH<a class="headerlink" href="#at25-serial-flash" title="Permalink to this heading"></a></h2>
<section id="connections">
<h3>Connections<a class="headerlink" href="#connections" title="Permalink to this heading"></a></h3>
<p>Both the SAM4E-EK include an Atmel AT25DF321A, 32-megabit, 2.7-volt
SPI serial flash.  The SPI
connection is as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SAM4E</p></th>
<th class="head"><p>AT25</p></th>
<th class="head"><p>SAM4E</p></th>
</tr>
<tr class="row-even"><th class="head"><p>GPIO</p></th>
<th class="head"><p>PIN</p></th>
<th class="head"><p>FUNCTION</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>PA13</p></td>
<td><p>SI</p></td>
<td><p>MOSI</p></td>
</tr>
<tr class="row-even"><td><p>PA12</p></td>
<td><p>SO</p></td>
<td><p>MIS0</p></td>
</tr>
<tr class="row-odd"><td><p>PA14</p></td>
<td><p>SCK</p></td>
<td><p>SPCK</p></td>
</tr>
<tr class="row-even"><td><p>PA5</p></td>
<td><p>/CS</p></td>
<td><p>NPCS3 (pulled high externally)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h3>
<p>Support for the serial FLASH can be enabled in these configurations. These are
the relevant configuration settings. These settings (1) Enable SPI0, (2) Enable
DMAC0 to support DMA transfers on SPI for best performance, (3) Enable the AT25
Serial FLASH, and (3) Set up NuttX to configure the file system on the AT25
FLASH:</p>
<blockquote>
<div><p>System Type -&gt; ATSAM3/4 Peripheral Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI0=y</span></code>: Enable SPI0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_DMAC0=y</span></code>: Enable DMA controller 0</p></li>
</ul>
<p>System Type -&gt; SPI device driver options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI_DMA=y</span></code>: Use DMA for SPI transfers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI_DMATHRESHOLD=4</span></code>: Don’t DMA for small transfers</p></li>
</ul>
<p>Device Drivers -&gt; SPI Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI=y</span></code>: Enable SPI support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI_EXCHANGE=y</span></code>: Support the exchange method</p></li>
</ul>
<p>Device Drivers -&gt; Memory Technology Device (MTD) Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MTD=y</span></code>: Enable MTD support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MTD_AT25=y</span></code>: Enable the AT25 driver</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_AT25_SPIMODE=0</span></code>: Use SPI mode 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_AT25_SPIFREQUENCY=20000000</span></code>: Use SPI frequency 12MHz</p></li>
</ul>
<p>The AT25 is capable of operation at 20MHz. However, if you experience any
issues with the AT25, then lower this frequency may give more predictable
performance.</p>
<p>File Systems -&gt; FAT</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_FS_FAT=y</span></code>: Enable and configure FAT</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_FAT_LCNAMES=y</span></code>: Upper/lower case names</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_FAT_LFN=y</span></code>: Long file name support (See NOTE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_FAT_MAXFNAME=32</span></code>: Limit filename sizes to 32 bytes</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use care if you plan to use FAT long file name feature in a product; There
are issues with certain Microsoft patents on the long file name technology.</p>
</div>
<p>Application Configuration -&gt; NSH Library</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_ARCHINIT=y</span></code>: NSH board-initialization</p></li>
</ul>
<p>Board Selection</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_AT25_BLOCKMOUNT=y</span></code>: Mounts AT25 for NSH</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_AT25_FTL=y</span></code>: Create block driver for FAT</p></li>
</ul>
</div></blockquote>
<p>You can then format the AT25 FLASH for a FAT file system and mount the
file system at <code class="docutils literal notranslate"><span class="pre">/mnt/at25</span></code> using these NSH commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; mkfatfs /dev/mtdblock0</span>
<span class="go">nsh&gt; mount -t vfat /dev/mtdblock0 /mnt/at25</span>
</pre></div>
</div>
<p>Then you an use the FLASH as a normal FAT file system:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; echo &quot;This is a test&quot; &gt;/mnt/at25/atest.txt</span>
<span class="go">nsh&gt; ls -l /mnt/at25</span>
<span class="go">/mnt/at25:</span>
<span class="go"> -rw-rw-rw-      16 atest.txt</span>
<span class="go">nsh&gt; cat /mnt/at25/atest.txt</span>
<span class="go">This is a test</span>
</pre></div>
</div>
</section>
</section>
<section id="usb-full-speed-device">
<h2>USB Full-Speed Device<a class="headerlink" href="#usb-full-speed-device" title="Permalink to this heading"></a></h2>
<section id="basic-usb-full-speed-device-configuration">
<h3>Basic USB Full-Speed Device Configuration<a class="headerlink" href="#basic-usb-full-speed-device-configuration" title="Permalink to this heading"></a></h3>
<p>Support the USB full-speed device (UDP) driver can be enabled with these NuttX
configuration settings.</p>
<p>Device Drivers -&gt; USB Device Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV=y</span></code>: Enable USB device support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_DUALSPEED=n</span></code>: Device does not support High-Speed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_DMA=n</span></code>: Device does not use DMA</p></li>
</ul>
<p>System Type -&gt; ATSAM3/4 Peripheral Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_UDP=y</span></code>: Enable UDP Full Speed USB device</p></li>
</ul>
<p>Application Configuration -&gt; NSH Library</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_ARCHINIT=y</span></code>: NSH board-initialization</p></li>
</ul>
</section>
<section id="mass-storage-class">
<h3>Mass Storage Class<a class="headerlink" href="#mass-storage-class" title="Permalink to this heading"></a></h3>
<p>The Mass Storage Class (MSC) class driver can be selected for use with UDP.
Note: The following assumes that the internal AT25 Serial FLASH is configured to
support a FAT file system through an FTL layer as described about under “AT25
Serial FLASH”.</p>
<p>Device Drivers -&gt; USB Device Driver Support
* <code class="docutils literal notranslate"><span class="pre">CONFIG_USBMSC=y</span></code>: Enable the USB MSC class driver
* <code class="docutils literal notranslate"><span class="pre">CONFIG_USBMSC_EPBULKOUT=1</span></code>: Use EP1 for the BULK OUT endpoint
* <code class="docutils literal notranslate"><span class="pre">CONFIG_USBMSC_EPBULKIN=2</span></code>: Use EP2 for the BULK IN endpoint
* <code class="docutils literal notranslate"><span class="pre">CONFIG_USBMSC_BULKINREQLEN=64</span></code>: (Defaults for full speed)
* <code class="docutils literal notranslate"><span class="pre">CONFIG_USBMSC_BULKOUTREQLEN=64</span></code></p>
<p>Defaults for other settings as well?</p>
<p>Board Selection</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_AT25_BLOCKDEVICE=y</span></code>: Export AT25 serial FLASH device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_HSMCI_BLOCKDEVICE=n</span></code>: Don’t export HSMCI SD card</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If properly configured, you could export the HSMCI SD card instead of the
internal AT25 Serial FLASH.</p>
</div>
<p>The following setting enables an add-on that can can be used to control
the USB MSC device. It will add two new NSH commands:</p>
<ol class="arabic simple">
<li><p>msconn will connect the USB serial device and export the AT25 to the host,
and</p></li>
<li><p>msdis which will disconnect the USB serial device.</p></li>
</ol>
<p>Application Configuration -&gt; System Add-Ons:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_USBMSC=y</span></code>: Enable the USBMSC add-on</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_USBMSC_NLUNS=1</span></code>: One LUN</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_USBMSC_DEVMINOR1=0</span></code>: Minor device zero</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_USBMSC_DEVPATH1=&quot;/dev/mtdblock0&quot;</span></code> : Use a single, LUN; the AT25 block driver.</p></li>
</ul>
<ol class="arabic">
<li><p>To prevent file system corruption, make sure that the AT25 is un-
mounted <em>before</em> exporting the mass storage device to the host:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; umount /mnt/at25</span>
<span class="go">nsh&gt; mscon</span>
</pre></div>
</div>
<p>The AT25 can be re-mounted after the mass storage class is disconnected:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; msdis</span>
<span class="go">nsh&gt; mount -t vfat /dev/mtdblock0 /mnt/at25</span>
</pre></div>
</div>
</li>
<li><p>If you change the value <code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_USBMSC_DEVPATH1</span></code>, then you can
export other file systems:</p>
<p><code class="docutils literal notranslate"><span class="pre">/dev/mmcsd0</span></code> would export the HSMCI SD slot (not currently available, see
the “HSMCI” section).</p>
<p><code class="docutils literal notranslate"><span class="pre">/dev/ram0</span></code> could even be used to export a RAM disk. But you would first
have to use mkrd to create the RAM disk and <code class="docutils literal notranslate"><span class="pre">mkfatfs</span></code> to put a FAT file
system on it.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Marginally functional. Very slow to come up. USB analyzer shows several
resets before the host decides that it is happy with the device. There are
no obvious errors in the USB data capture. Testing is insufficient. This
needs to be revisited.</p>
<p>Last tested at 96MHz with the CMCC disabled.</p>
</div>
</section>
<section id="cdc-acm-serial-device-class">
<h3>CDC/ACM Serial Device Class<a class="headerlink" href="#cdc-acm-serial-device-class" title="Permalink to this heading"></a></h3>
<p>This will select the CDC/ACM serial device. Defaults for the other options
should be okay.</p>
<p>Device Drivers -&gt; USB Device Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM=y</span></code>: Enable the CDC/ACM device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_EPINTIN=1</span></code>: Select endpoint numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_EPBULKOUT=2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_EPBULKIN=3</span></code></p></li>
</ul>
<p>The following setting enables an example that can can be used to control
the CDC/ACM device. It will add two new NSH commands:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sercon</span></code> will connect the USB serial device (creating <code class="docutils literal notranslate"><span class="pre">/dev/ttyACM0</span></code>),
and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">serdis</span></code> which will disconnect the USB serial device (destroying
<code class="docutils literal notranslate"><span class="pre">/dev/ttyACM0</span></code>).</p></li>
</ol>
<p>Application Configuration -&gt; Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_CDCACM=y</span></code>: Enable an CDC/ACM example</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSTEM_CDCACM_DEVMINOR=0</span></code>: Use <code class="docutils literal notranslate"><span class="pre">/dev/ttyUSB0</span></code></p></li>
</ul>
<ol class="arabic">
<li><p>You cannot have both the CDC/ACM and the MSC class drivers enabled
simultaneously in the way described here.  If you want to use both, then
you will need to consider a USB “composite” devices that support supports
both interfaces.  There are no instructures here for setting up the USB
composite device, but there are other examples in the NuttX board support
directories that can be used for reference.</p></li>
<li><p>Linux supports the CDC/ACM driver out of the box.  Windows, on the other
than requires that you first install a serial driver (a .inf file).</p></li>
<li><p>There is hand-shaking to pace incoming serial data.  As a result, you may
experience data loss due to RX overrun errors.  The overrun errors occur
when more data is received than can be buffered in memory on the target.</p>
<p>At present, the only workaround is to increase the amount of buffering
in the target. That allow the target to accept short bursts of larger
volumes of data (but would still fail on sustained, high speed incoming
data. The following configuration options can be changed to increase
the buffering.</p>
<ol class="arabic">
<li><p>RX buffer size.  All incoming data is buffered by the serial driver
until it can be read by the application.  The default size of this
RX buffer is only 256 but can be increased as you see fit:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_RXBUFSIZE=256</span></code>: Default RX buffer size is only 256
bytes</p></li>
</ul>
</li>
<li><p>Upstream from the RX buffers are USB read request buffers.  Each
buffer is the maximum size of one USB packet (64 byte) and that cannot
really be changed. But if you want to increase this upstream buffering
capability, you can increase the number of available read requests.
The default is four, providing an additional buffering capability of
of 4*64=256 bytes.</p>
<p>Each read request receives data from USB, copies the data into the
serial RX buffer, and then is available to receive more data. This
recycling of read requests stalls as soon as the serial RX buffer is
full. Data loss occurs when there are no available read requests to
accept the next packet from the host. So increasing the number of
read requests can also help to minimize RX overrun:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_NRDREQS=4</span></code>: Default is only 4 read requests</p></li>
</ul>
</li>
</ol>
</li>
</ol>
</section>
<section id="debugging-usb-device">
<h3>Debugging USB Device<a class="headerlink" href="#debugging-usb-device" title="Permalink to this heading"></a></h3>
<p>There is normal console debug output available that can be enabled with
<code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_FEATURES</span></code> + <code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_USB</span></code>. However, USB device operation
is very time critical and enabling this debug output WILL interfere with the
operation of the UDP. USB device tracing is a less invasive way to get debug
information: If tracing is enabled, the USB device will save encoded trace
output in in-memory buffer; if the USB monitor is also enabled, that trace
buffer will be periodically emptied and dumped to the system logging device (the
serial console in this configuration):</p>
<blockquote>
<div><p>Device Drivers -&gt; “USB Device Driver Support:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_TRACE=y</span></code>: Enable USB trace feature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_TRACE_NRECORDS=256</span></code>: Buffer 256 records in memory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_TRACE_STRINGS=y</span></code>: (optional)</p></li>
</ul>
<p>If you get data loss in the trace buffer, then you may want to increase the
<code class="docutils literal notranslate"><span class="pre">CONFIG_USBDEV_TRACE_NRECORDS</span></code>. I have used buffers up to 4096 records to
avoid data loss.</p>
<p>Application Configuration -&gt; NSH LIbrary:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_USBDEV_TRACE=n</span></code>: No builtin tracing from NSH</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_ARCHINIT=y</span></code>: Automatically start the USB monitor</p></li>
</ul>
<p>Application Configuration -&gt; System NSH Add-Ons:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR=y</span></code>: Enable the USB monitor daemon</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_STACKSIZE=2048</span></code>: USB monitor daemon stack size</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_PRIORITY=50</span></code>: USB monitor daemon priority</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_INTERVAL=1</span></code>: Dump trace data every second</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_TRACEINIT=y</span></code>: Enable TRACE output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_TRACECLASS=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_TRACETRANSFERS=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_TRACECONTROLLER=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USBMONITOR_TRACEINTERRUPTS=y</span></code></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If USB debug output is also enabled, both outputs will appear on the serial
console. However, the debug output will be asynchronous with the trace
output and, hence, difficult to interpret.</p>
</div>
</section>
</section>
<section id="hsmci">
<h2>HSMCI<a class="headerlink" href="#hsmci" title="Permalink to this heading"></a></h2>
<p>Enabling HSMCI support. The SAM3U-KE provides a an SD memory card slot. Support
for the SD slot can be enabled with the following settings:</p>
<blockquote>
<div><p>System Type-&gt;ATSAM3/4 Peripheral Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_HSMCI=y</span></code>: Enable HSMCI support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_DMAC0=y</span></code>: DMAC support is needed by HSMCI</p></li>
</ul>
<p>System Type</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIO_IRQ=y</span></code>: PIO interrupts needed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOA_IRQ=y</span></code>: Card detect pin is on PIOA</p></li>
</ul>
<p>Device Drivers -&gt; MMC/SD Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MMCSD=y</span></code>: Enable MMC/SD support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MMCSD_NSLOTS=1</span></code>: One slot per driver instance</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MMCSD_HAVE_CARDDETECT=y</span></code>: Supports card-detect PIOs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MMCSD_SDIO=y</span></code>: SDIO-based MMC/SD support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_MMCSD_MULTIBLOCK_LIMIT=1</span></code>: Probably works but is untested</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SDIO_DMA=y</span></code>: Use SDIO DMA</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SDIO_BLOCKSETUP=y</span></code>: Needs to know block sizes</p></li>
</ul>
<p>Library Routines</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SCHED_WORKQUEUE=y</span></code>: Driver needs work queue support</p></li>
</ul>
<p>Defaults for other settings okay</p>
<p>Application Configuration -&gt; NSH Library</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_ARCHINIT=y</span></code>: NSH board-initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_MMCSDSLOTNO=0</span></code>: Only one slot, slot 0</p></li>
</ul>
</div></blockquote>
<p>After an SD card is successfully initialized, the block device <code class="docutils literal notranslate"><span class="pre">/dev/mmcsd0</span></code>
will be available. To mount the SD card, use the following NSH command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; mount -t vfat /dev/mmcsd0 /mnt/sdcard</span>
</pre></div>
</div>
<p>The SD card contents will then be available under <code class="docutils literal notranslate"><span class="pre">/mnt/sdcard</span></code>.</p>
<p>DMA is not currently functional and without DMA, there may not be reliable data
transfers at high speeds due to data overrun problems. The current HSMCI driver
supports DMA via the DMAC.  However, the data sheet only discusses PDC-based
HSMCI DMA (although there is a DMA channel interface definition for HSMCI).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Bottom line:  Untested and probably not usable on the SAM4E-EK in its current
form.</p>
</div>
</section>
<section id="touchscreen">
<h2>Touchscreen<a class="headerlink" href="#touchscreen" title="Permalink to this heading"></a></h2>
<p>The NSH configuration can be used to verify the ADS7843E touchscreen on the
SAM4E-EK LCD. With these modifications, you can include the touchscreen test
program at <code class="docutils literal notranslate"><span class="pre">apps/examples/touchscreen</span></code> as an NSH built-in application. You can
enable the touchscreen and test by modifying the default configuration in the
following ways:</p>
<blockquote>
<div><p>Device Drivers</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI=y</span></code>: Enable SPI support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI_EXCHANGE=y</span></code>: The exchange() method is supported</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_INPUT=y</span></code>: Enable support for input devices</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_INPUT_ADS7843E=y</span></code>: Enable support for the ADS7843E</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SPIDEV=0</span></code>: Use SPI CS 0 for communication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SPIMODE=0</span></code>: Use SPI mode 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_FREQUENCY=1000000</span></code>: SPI BAUD 1MHz</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SWAPXY=y</span></code>: If landscape orientation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_THRESHX=51</span></code>: These will probably need to be tuned</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_THRESHY=39</span></code></p></li>
</ul>
<p>System Type -&gt; Peripherals:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI0=y</span></code>: Enable support for SPI</p></li>
</ul>
<p>System Type:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIO_IRQ=y</span></code>: GPIO interrupt support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOA_IRQ=y</span></code>: Enable GPIO interrupts from port A</p></li>
</ul>
<p>Library Support:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SCHED_WORKQUEUE=y</span></code>: Work queue support required</p></li>
</ul>
<p>Application Configuration:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_TOUCHSCREEN=y</span></code>: Enable the touchscreen built-in test</p></li>
</ul>
<p>Defaults should be okay for related touchscreen settings. Touchscreen debug
output on UART0 can be enabled with:</p>
<p>Build Setup:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_FEATURES=y</span></code>: Enable debug features</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_INFO=y</span></code>: Enable verbose debug output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_INPUT=y</span></code>: Enable debug output from input devices</p></li>
</ul>
</div></blockquote>
</section>
<section id="ili9325-41-based-lcd">
<h2>ILI9325/41-Based LCD<a class="headerlink" href="#ili9325-41-based-lcd" title="Permalink to this heading"></a></h2>
<p>The SAM4E-EK carries a TFT transmissive LCD module with touch panel,
FTM280C34D. Its integrated driver IC is either a ILI9325 ILI9342 (the
original schematics said ILI9325, but I learned the hard way that I had
an ILI9341-based LCD). The LCD display area is 2.8 inches diagonally
measured, with a native resolution of 240 x 320
dots.</p>
<section id="connectivity">
<h3>Connectivity<a class="headerlink" href="#connectivity" title="Permalink to this heading"></a></h3>
<p>The SAM4E16 communicates with the LCD through PIOC where an 8-bit parallel
“8080-like” protocol data bus has to be implemented in software.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>PIN</p></th>
<th class="head"><p>PIO</p></th>
<th class="head"><p>SIGNAL</p></th>
<th class="head"><p>NOTES</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td></td>
<td></td>
<td><p>VDD</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>PC7</p></td>
<td><p>DB17</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>PC6</p></td>
<td><p>DB16</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>PC5</p></td>
<td><p>DB15</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>PC4</p></td>
<td><p>DB14</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>PC3</p></td>
<td><p>DB13</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>PC2</p></td>
<td><p>DB12</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>PC1</p></td>
<td><p>DB11</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>PC0</p></td>
<td><p>DB10</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td></td>
<td><p>DB9</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td></td>
<td><p>DB8</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td></td>
<td><p>DB7</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td></td>
<td><p>DB6</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td></td>
<td><p>DB5</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td></td>
<td><p>DB4</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td></td>
<td><p>DB3</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td></td>
<td><p>DB2</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td></td>
<td><p>DB1</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td></td>
<td><p>DB0</p></td>
<td><p>Pulled low</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td></td>
<td></td>
<td><p>VDD</p></td>
</tr>
<tr class="row-even"><td><p>21</p></td>
<td><p>PC11</p></td>
<td><p>RD</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>22</p></td>
<td><p>PC8</p></td>
<td><p>WR</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>23</p></td>
<td><p>PC19</p></td>
<td><p>RS</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>24</p></td>
<td><p>PD18</p></td>
<td><p>CS</p></td>
<td><p>Via J8, pulled high.</p></td>
</tr>
<tr class="row-even"><td><p>25</p></td>
<td></td>
<td><p>RESET</p></td>
<td><p>Connects to NSRST</p></td>
</tr>
<tr class="row-odd"><td><p>26</p></td>
<td></td>
<td><p>IM0</p></td>
<td><p>Pulled high</p></td>
</tr>
<tr class="row-even"><td><p>27</p></td>
<td></td>
<td><p>IM1</p></td>
<td><p>Grounded</p></td>
</tr>
<tr class="row-odd"><td><p>28</p></td>
<td></td>
<td><p>GND</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>29</p></td>
<td><p>[PC13]</p></td>
<td><p>LED-A</p></td>
<td><p>Backlight controls: PC13 enables AAT3155 charge pump that drives the backlight LEDs</p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>[PC13]</p></td>
<td><p>LEDK1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>31</p></td>
<td><p>[PC13]</p></td>
<td><p>LEDK2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>32</p></td>
<td><p>[PC13]</p></td>
<td><p>LEDK3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>33</p></td>
<td><p>[PC13]</p></td>
<td><p>LEDK4</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>34</p></td>
<td><p>[PC13]</p></td>
<td><p>LEDK1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>35</p></td>
<td></td>
<td><p>Y+</p></td>
<td><p>These go to the ADS7843 touchscreen controller.</p></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td></td>
<td><p>Y-</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td></td>
<td><p>X+</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>38</p></td>
<td></td>
<td><p>X-</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>39</p></td>
<td></td>
<td><p>NC</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="jumpers">
<h3>Jumpers<a class="headerlink" href="#jumpers" title="Permalink to this heading"></a></h3>
<p>Make sure the JP8 is closed. This connects PD18 as the LCD CS.</p>
</section>
<section id="backlight">
<h3>Backlight<a class="headerlink" href="#backlight" title="Permalink to this heading"></a></h3>
<p>LCD backlight is made of 4 white chip LEDs in parallel, driven by an AAT3155
charge pump, MN4. The AAT3155 is controlled by the SAM3U4E through a single line
Simple Serial Control (S2Cwire) interface, which permits to enable, disable, and
set the LED drive current (LED brightness control) from a 32-level logarithmic
scale. Four resistors R93/R94/R95/R96 are implemented for optional current
limitation.</p>
</section>
<section id="configuration-options">
<h3>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this heading"></a></h3>
<p>This is the basic configuration that enables the ILI9341-based LCD.
Of course additional settings would be necessary to enable the graphic
capabilities to do anything with the LCD.</p>
<p>System Type -&gt; AT91SAM3/4 Configuration Options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SMC=y</span></code>: SMC support</p></li>
</ul>
<p>Device Drivers -&gt; LCD Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD=y</span></code>: Enable LCD support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_MAXCONTRAST=1</span></code>: Value should not matter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_MAXPOWER=64</span></code>: Must be &gt; 16</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_LANDSCAPE=y</span></code>: Landscape orientation</p></li>
</ul>
<p>Board Selection</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_ILI9341=y</span></code>: For the ILI9341-based LCD</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_RGB565=y</span></code>: Color resolution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_BGCOLOR=0x00</span></code>: Initial background color</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>2014-8-20: Updated. The ILI9341 LCD has some basic functionality. Certainly
it can transfer and display data fine. But there are some issues with the
geometry of data that appears on the LCD..</p>
<p>The LCD backlight is functional.</p>
</div>
</section>
</section>
<section id="sam4e-ek-specific-configuration-options">
<h2>SAM4E-EK-specific Configuration Options<a class="headerlink" href="#sam4e-ek-specific-configuration-options" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">arch/</span></code> subdirectory.  This should be set
to:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH=arm</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_family</span></code>: For use in C code:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_ARM=y</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_architecture</span></code>: For use in C code:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CORTEXM3=y</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">arch/*/chip</span></code> subdirectory</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP=&quot;sam34&quot;</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_name</span></code>: For use in C code to identify the exact chip:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_SAM34</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_SAM3U</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_CHIP_ATSAM3U4</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD</span></code>: Identifies the <code class="docutils literal notranslate"><span class="pre">boards/</span></code> subdirectory and hence, the
board that supports the particular chip or SoC.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD=sam4e:ek</span></code> (for the SAM4E-EK development board)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD_name</span></code>: For use in C code</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_BOARD_SAM4EEK=y</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LOOPSPERMSEC</span></code>: Must be calibrated for correct operation of
delay loops</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ENDIAN_BIG</span></code>: define if big endian (default is little endian)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_SIZE</span></code>: Describes the installed DRAM (SRAM in this case):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_SIZE=0x00020000</span></code> (128Kb)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_START</span></code>: The start address of installed DRAM</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_RAM_START=0x20000000</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LEDS</span></code>: Use LEDs to show state. Unique to boards that have LEDs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_INTERRUPTSTACK</span></code>: This architecture supports an interrupt stack.
If defined, this symbol is the size of the interrupt stack in bytes. If not
defined, the user task stacks will be used during interrupt handling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_STACKDUMP</span></code>: Do stack dumps after assertions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_LEDS</span></code>:  Use LEDs to show state. Unique to board architecture.</p></li>
</ul>
<p>Individual subsystems can be enabled:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI0</span></code>: Serial Peripheral Interface 0 (SPI0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI1</span></code>: Serial Peripheral Interface 1 (SPI1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SSC</span></code>: Synchronous Serial Controller (SSC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC0</span></code>: Timer/Counter 0 (TC0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC1</span></code>: Timer/Counter 1 (TC1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC2</span></code>: Timer/Counter 2 (TC2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC3</span></code>: Timer/Counter 3 (TC3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC4</span></code>: Timer/Counter 4 (TC4)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC5</span></code>: Timer/Counter 5 (TC5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC6</span></code>: Timer/Counter 6 (TC6)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC7</span></code>: Timer/Counter 7 (TC6)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TC8</span></code>: Timer/Counter 6 (TC8)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_PWM</span></code>: Pulse Width Modulation (PWM) Controller</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TWIM0</span></code>: Two-wire Master Interface 0 (TWIM0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TWIS0</span></code>: Two-wire Slave Interface 0 (TWIS0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TWIM1B</span></code>: Two-wire Master Interface 1 (TWIM1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_TWIS1</span></code>: Two-wire Slave Interface 1 (TWIS1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_UART0</span></code>: UART 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_UART1</span></code>: UART 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_USART0</span></code>: USART 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_USART1</span></code>: USART 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_USART2</span></code>: USART 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_USART3</span></code>: USART 3</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_AFEC0</span></code>: Analog Front End 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_AFEC1</span></code>: Analog Front End 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_DACC</span></code>: Digital-to-Analog Converter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_ACC</span></code>: Analog Comparator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EMAC</span></code>: Ethernet MAC</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_CAN0</span></code>: CAN 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_CAN1</span></code>: CAN 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SMC</span></code>: Static Memory Controller</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_NAND</span></code>: NAND support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_PDCA</span></code>: Peripheral DMA controller</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_DMAC0</span></code>: DMA controller</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_UDP</span></code>: USB 2.0 Full-Speed device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_CHIPID</span></code>: Chip ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_RTC</span></code>: Real Time Clock</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_RTT</span></code>: Real Time Timer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_WDT</span></code>: Watchdog Timer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_EIC</span></code>: Interrupt controller</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_HSMCI</span></code>: High Speed Multimedia Card Interface</p></li>
</ul>
<p>Some subsystems can be configured to operate in different ways. The drivers need
to know how to configure the subsystem.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOA_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOB_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOC_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOD_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOE_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOF_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOG_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOH_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOJ_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOK_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOL_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOM_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPION_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOP_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOQ_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USART0_SERIALDRIVER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USART1_SERIALDRIVER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USART2_SERIALDRIVER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_USART3_SERIALDRIVER</span></code></p></li>
</ul>
<p>SAM3U specific device driver settings</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_SERIAL_CONSOLE</span></code>: selects the USARTn (n=0,1,2,3) or UART m
(m=4,5) for the console and ttys0 (default is the USART1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_RXBUFSIZE</span></code>: Characters are buffered as received. This
specific the size of the receive buffer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_TXBUFSIZE</span></code>: Characters are buffered before being sent.
This specific the size of the transmit buffer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_BAUD</span></code>: The configure BAUD of the UART.  Must be</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_BITS</span></code>: The number of bits.  Must be either 7 or 8.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_PARTIY</span></code>: 0=no parity, 1=odd parity, 2=even parity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_U[S]ARTn_2STOP</span></code>: Two stop bits</p></li>
</ul>
<p>LCD Options.  Other than the standard LCD configuration options (see
boards/README.txt), the SAM4E-EK driver also supports:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_LANDSCAPE</span></code>: Define for 320x240 display “landscape” support.
Default is this 320x240 “landscape” orientation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_RLANDSCAPE</span></code>: Define for 320x240 display “reverse landscape”
support.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_PORTRAIT</span></code>: Define for 240x320 display “portrait” orientation
support.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_RPORTRAIT</span></code>: Define for 240x320 display “reverse portrait”
orientation support.</p></li>
</ul>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>Each SAM4E-EK configuration is maintained in a sub-directory and can be selected
as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tools/configure.sh<span class="w"> </span>sam4e-ek:&lt;subdir&gt;
</pre></div>
</div>
<p>Before building, make sure the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> environment variable includes the correct
path to the directory than holds your toolchain binaries.</p>
<p>And then build NuttX by simply typing the following.  At the conclusion of
the make, the nuttx binary will reside in an ELF file called, simply, nuttx.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>make
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;subdir&gt;</span></code> that is provided above as an argument to the
<code class="docutils literal notranslate"><span class="pre">tools/configure.sh</span></code> must be is one of the following.</p>
<ol class="arabic simple">
<li><p>These configurations use the mconf-based configuration tool.  To change any
of these configurations using that tool, you should:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Build and install the kconfig-mconf tool.  See nuttx/README.txt
see additional README.txt files in the NuttX tools repository.</p></li>
<li><p>Execute ‘make menuconfig’ in nuttx/ in order to start the
reconfiguration process.</p></li>
</ol>
</div></blockquote>
<ol class="arabic" start="2">
<li><p>Unless stated otherwise, all configurations generate console
output on UART0 (J3).</p></li>
<li><p>All of these configurations are set up to build under Linux using the
EABI buildroot toolchain (unless stated otherwise in the description of
the configuration).  That build selection can easily be reconfigured
using ‘make menuconfig’.  Here are the relevant current settings:</p>
<p>Build Setup:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_HOST_LINUX=y</span></code>: Linux or other pure POSIX invironment</p></li>
</ul>
<p>System Type -&gt; Toolchain:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARM_TOOLCHAIN_BUILDROOT=y</span></code>: Buildroot toolchain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARM_TOOLCHAIN_BUILDROOT_OABI=n</span></code>: EABI (Not OABI</p></li>
</ul>
<p>If you want to use the Atmel GCC toolchain, for example, here are the
steps to do so:</p>
<p>Build Setup:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_HOST_WINDOWS=y</span></code>: Windows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_HOST_CYGWIN=y</span></code>: Using Cygwin or other POSIX environment</p></li>
</ul>
<p>System Type -&gt; Toolchain:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARM_TOOLCHAIN_GNU_EABI=y</span></code>: General GCC EABI toolchain under windows</p></li>
</ul>
<p>Library Routines -&gt;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ARCH_SIZET_LONG=n</span></code>: size_t is an unsigned int, not long</p></li>
</ul>
<p>This re-configuration should be done before making NuttX or else the
subsequent <code class="docutils literal notranslate"><span class="pre">make</span></code> will fail. If you have already attempted building
NuttX then you will have to 1) <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">distclean</span></code> to remove the old
configuration, 2) <code class="docutils literal notranslate"><span class="pre">tools/configure.sh</span> <span class="pre">sam4e-ek/ksnh</span></code> to start
with a fresh configuration, and 3) perform the configuration changes
above.</p>
<p>Also, make sure that your PATH variable has the new path to your Atmel tools.
Try <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">arm-none-eabi-gcc</span></code> to make sure that you are selecting the right
tool.</p>
<p>See also the “NOTE about Windows native toolchains” in the section call “GNU
Toolchain Options” above.</p>
</li>
</ol>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at <code class="docutils literal notranslate"><span class="pre">examples/nsh</span></code>. The Configuration
enables both the serial and telnetd NSH interfaces.</p>
<ol class="arabic">
<li><p>This configuration runs with a CPU clock of 120MHz and with the
the CMCC enabled. If you disable these, then you must also
re-calibrate the delay loop.</p></li>
<li><p>Default stack sizes are large and should really be tuned to reduce
the RAM footprint:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>CONFIG_ARCH_INTERRUPTSTACK=2048
CONFIG_IDLETHREAD_STACKSIZE=1024
CONFIG_INIT_STACKSIZE=2048
CONFIG_PTHREAD_STACK_DEFAULT=2048
... and others ...
</pre></div>
</div>
</li>
<li><p>NSH built-in applications are supported.</p>
<p>Binary Formats:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_BUILTIN=y</span></code>: Enable support for built-in programs</p></li>
</ul>
<p>Application Configuration:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_BUILTIN_APPS=y</span></code>: Enable starting apps from NSH command line</p></li>
</ul>
</li>
<li><p>This configuration has the network enabled by default. This can be easily
disabled or reconfigured (See see the network related configuration settings
above in the section entitled “Networking”).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In boot-up sequence is very simple in this example; all initialization is
done sequentially (vs. in parallel) and so you will not see the NSH prompt
until all initialization is complete.  The network bring-up in particular
will add some delay before the NSH prompt appears.  In a real application,
you would probably want to do the network bringup on a separate thread so
that access to the NSH prompt is not delayed.</p>
<p>This delay will be especially long if the board is not connected to a
network because additional time will be required to fail with timeout
errors.  This delay can be eliminated, however, if you enable an NSH
initialization option as described above in a paragraph entitled, “Network
Initialization Thread.”</p>
</div>
</li>
<li><p>This configuration supports a network with fixed IP address. You
may have to change these settings for your network:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_IPADDR=0x0a000002</span></code>: IP address: <code class="docutils literal notranslate"><span class="pre">10.0.0.2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_DRIPADDR=0x0a000001</span></code>: Gateway: <code class="docutils literal notranslate"><span class="pre">10.0.0.1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_NETMASK=0xffffff00</span></code>: Netmask: <code class="docutils literal notranslate"><span class="pre">255.255.255.0</span></code></p></li>
</ul>
<p>You can also enable enable the DHCPC client for networks that use dynamically
assigned address:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NETUTILS_DHCPC=y</span></code>: Enables the DHCP client</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_UDP=y</span></code>: Depends on broadcast UDP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NET_BROADCAST=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NSH_DHCPC=y</span></code>: Tells NSH to use DHCPC, not the fixed addresses</p></li>
</ul>
</li>
<li><p>This configuration has the DMA-based SPI0 and AT25 Serial FLASH support
enabled by default. This can be easily disabled or reconfigured (See see the
configuration settings and usage notes above in the section entitled “AT25
Serial FLASH”).</p>
<p>To mount the AT25 Serial FLASH as a FAT file system:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt;mount -t vfat /dev/mtdblock0 /mnt/at25</span>
</pre></div>
</div>
</li>
<li><p>USB device support is not enabled in this configuration by default.
To add USB device support to this configuration, see the instructions
above under “USB Full-Speed Device.”</p></li>
<li><p>Enabling HSMCI support. The SAM3U-KE provides a an SD memory card
slot. Support for the SD slot can be enabled following the
instructions provided above in the paragraph entitled “HSMCI.”</p></li>
<li><p>This configuration has been used for verifying the touchscreen on
on the SAM4E-EK LCD module.</p>
<p>The NSH configuration can be used to verify the ADS7843E touchscreen on
the SAM4E-EK LCD.  With these modifications, you can include the touchscreen
test program at apps/examples/touchscreen as an NSH built-in application.
You can enable the touchscreen and test by modifying the default
configuration in the following ways:</p>
<p>Device Drivers</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI=y</span></code>: Enable SPI support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SPI_EXCHANGE=y</span></code>: The exchange() method is supported</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_INPUT=y</span></code>: Enable support for input devices</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_INPUT_ADS7843E=y</span></code>: Enable support for the ADS7843E</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SPIDEV=0</span></code>: Use SPI CS 0 for communication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SPIMODE=0</span></code>: Use SPI mode 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_FREQUENCY=1000000</span></code>: SPI BAUD 1MHz</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_SWAPXY=y</span></code>: If landscape orientation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_THRESHX=51</span></code>: These will probably need to be tuned</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_ADS7843E_THRESHY=39</span></code></p></li>
</ul>
<p>System Type -&gt; Peripherals:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SPI0=y</span></code>: Enable support for SPI</p></li>
</ul>
<p>System Type:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIO_IRQ=y</span></code>: GPIO interrupt support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_GPIOA_IRQ=y</span></code>: Enable GPIO interrupts from port A</p></li>
</ul>
<p>Library Support:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SCHED_WORKQUEUE=y</span></code>: Work queue support required</p></li>
</ul>
<p>Application Configuration:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_TOUCHSCREEN=y</span></code>: Enable the touchscreen built-in test</p></li>
</ul>
<p>Defaults should be okay for related touchscreen settings. Touchscreen debug
output on UART0 can be enabled with:</p>
<p>Build Setup:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_FEATURES=y</span></code>: Enable debug features</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_INFO=y</span></code>: Enable verbose debug output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_INPUT=y</span></code>: Enable debug output from input devices</p></li>
</ul>
</li>
<li><p>This configuration can be re-configured to test the on-board LCD module.</p>
<p>System Type -&gt; AT91SAM3/4 Configuration Options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM34_SMC=y</span></code>: SMC support</p></li>
</ul>
<p>Device Drivers -&gt; LCD Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD=y</span></code>: Enable LCD support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_MAXCONTRAST=1</span></code>: Value should not matter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_MAXPOWER=64</span></code>: Must be &gt; 16</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_LCD_LANDSCAPE=y</span></code>: Landscape orientation</p></li>
</ul>
<p>Board Selection</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_ILI9341=y</span></code>: For the ILI9341-based LCD</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_RGB565=y</span></code>: Color resolution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SAM4EEK_LCD_BGCOLOR=0x00</span></code>: Initial background color</p></li>
</ul>
<p>Graphics Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX=y</span></code>: Enable Graphics support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_LCDDRIVER=y</span></code>: LCD graphics device</p></li>
</ul>
<p>Graphics Support -&gt; Supported Pixel Depths</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_1BPP=y</span></code>: Only 16BPP supported</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_2BPP=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_4BPP=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_8BPP=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_24BPP=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NX_DISABLE_32BPP=y</span></code></p></li>
</ul>
<p>Graphics Support -&gt; Font Selections</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NXFONTS_CHARBITS=7</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NXFONT_SANS23X27=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NXFONT_SANS22X29B=y</span></code></p></li>
</ul>
<p>Application Configuration -&gt; Examples</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES=y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_BGCOLOR=0x0320</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_LINEWIDTH=16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_LINECOLOR=0xffe0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_BORDERWIDTH=4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_BORDERCOLOR=0xffe0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_CIRCLECOLOR=0xf7bb</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_EXAMPLES_NXLINES_BPP=16</span></code></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>2014-08-20: The LCD interface is fully implemented and data appears to be
transferred okay.  However, there are errors in geometry that leave the
LCD unusable still.</p>
<p>The LCD backlight appears to be functional.</p>
</div>
</li>
</ol>
</section>
<section id="usbnsh">
<h3>usbnsh<a class="headerlink" href="#usbnsh" title="Permalink to this heading"></a></h3>
<p>This is another NSH example. If differs from the <code class="docutils literal notranslate"><span class="pre">nsh</span></code> configuration in that
this configurations uses a USB serial device for console I/O.</p>
<ol class="arabic">
<li><p>See the NOTES in the description of the nsh configuration. Those
notes all apply here as well. Some additional notes unique to
the USB console version follow:</p></li>
<li><p>The configuration differences between this configuration and the
nsh configuration is:</p>
<ol class="loweralpha">
<li><p>USB device support is enabled as described in the paragraph
entitled “USB Full-Speed Device”,</p></li>
<li><p>The CDC/ACM serial class is enabled as described in the paragraph
“CDC/ACM Serial Device Class”.</p></li>
<li><p>The serial console is disabled:</p>
<p>RTOS Features:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_DEV_CONSOLE=n</span></code>: No console at boot time</p></li>
</ul>
<p>Driver Support -&gt; USB Device Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_UART0_SERIAL_CONSOLE=n</span></code>: UART0 is not the console</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_NO_SERIAL_CONSOLE=y</span></code>: There is no serial console</p></li>
</ul>
<p>Driver Support -&gt; USB Device Driver Support</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_CONSOLE=y</span></code>: USB CDC/ACM console</p></li>
</ul>
</li>
<li><p>Support for debug output on UART0 is provided as described in the
next note.</p></li>
</ol>
</li>
<li><p>If you send large amounts of data to the target, you may see data
loss due to RX overrun errors.  See the NOTES in the section entitled
“CDC/ACM Serial Device Class” for an explanation and some possible
work-arounds.</p></li>
</ol>
<ol class="arabic" start="3">
<li><p>This configuration does have UART0 output enabled and set up as
the system logging device:</p>
<p>File Systems -&gt; Advanced SYSLOG Features</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSLOG_CHAR=y</span></code>: Use a character device for system logging</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SYSLOG_DEVPATH=&quot;/dev/ttyS0&quot;</span></code>: UART0 will be /dev/ttyS0</p></li>
</ul>
<p>However, there is nothing to generate SYSLOG output in the default
configuration so nothing should appear on UART0 unless you enable
some debug output or enable the USB monitor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the SYSLOG to get debug output has limitations. Among those are
that you cannot get debug output from interrupt handlers. So, in
particularly, debug output is not a useful way to debug the USB device
controller driver. Instead, use the USB monitor with USB debug off and
USB trace on (see below).</p>
</div>
</li>
<li><p>Enabling USB monitor SYSLOG output.  See the paragraph entitle
“Debugging USB Device” for a summary of the configuration settings
needed to enable the USB monitor and get USB debug data out UART0.</p></li>
<li><p>By default, this configuration uses the CDC/ACM serial device to
provide the USB console.  This works out-of-the-box for Linux.
Windows, on the other hand, will require a CDC/ACM device driver
(.inf file).</p></li>
</ol>
<ol class="arabic" start="5">
<li><p>Using the Prolifics PL2303 Emulation</p>
<p>You could also use the non-standard PL2303 serial device instead of
the standard CDC/ACM serial device by changing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM=n</span></code>: Disable the CDC/ACM serial device class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_CDCACM_CONSOLE=n</span></code>: The CDC/ACM serial device is NOT the console</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_PL2303=y</span></code>: The Prolifics PL2303 emulation is enabled</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_PL2303_CONSOLE=y</span></code>: The PL2303 serial device is the console</p></li>
</ul>
</li>
</ol>
</section>
<section id="nxwm">
<h3>nxwm<a class="headerlink" href="#nxwm" title="Permalink to this heading"></a></h3>
<p>This is a special configuration setup for the NxWM window manager UnitTest. It
integrates support for both the SAM4E-EK ILI9341 LCDC and the SAM4E-EK ADS7843E
touchscreen controller and provides a more advanced graphics demo. It provides
an interactive windowing experience.</p>
<p>The NxWM window manager is a tiny window manager tailored for use with smaller
LCDs. It supports a task, a start window, and multiple application windows with
toolbars. However, to make the best use of the visible LCD space, only one
application window is visible at at time.</p>
<p>The NxWM window manager can be found at <code class="docutils literal notranslate"><span class="pre">apps/graphics/NxWidgets/nxwm</span></code>.</p>
<p>The NxWM unit test can be found at <code class="docutils literal notranslate"><span class="pre">apps/graphics/NxWidgets/UnitTests/nxwm</span></code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>2014-08-20. I have seen the demo work well but it is not thoroughly
exercised.  I suspect some touchscreen issues.</p>
<p>2014-10-11. Today’s build crashes in nxwm_main on startup.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../sam4cmp-db/index.html" class="btn btn-neutral float-left" title="sam4cmp-db" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../sam4l-xplained/index.html" class="btn btn-neutral float-right" title="SAM4L Xplained" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>