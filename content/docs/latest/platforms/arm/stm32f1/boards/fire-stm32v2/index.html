<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fire-stm2v2 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="HY-MiniSTM32V" href="../hymini-stm32/index.html" />
    <link rel="prev" title="ET-STM32 Stamp" href="../et-stm32-stamp/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a1x/index.html">Allwinner A10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../am335x/index.html">TI/Sitara AM335x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../at32/index.html">Artery AT32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bcm2708/index.html">Broadcom BCM2708 (removed)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c5471/index.html">TI TMS320-C5471</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cxd56xx/index.html">Sony CXD56xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dm320/index.html">TI TMS320-DM320</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../efm32/index.html">SiLabs EFM32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eoss3/index.html">EOSS3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fvp-v8r-aarch32/index.html">FVP ARMv8-R Virt Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gd32f4/index.html">GD32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/index.html">GOLDFISH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx1/index.html">NXP/Freescale i.MX1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx6/index.html">NXP/Freescale i.MX6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">NXP i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kinetis/index.html">NXP/FreeScale Kinetis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kl/index.html">NXP/FreeScale KLxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lc823450/index.html">ON Semiconductor LC823450</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc17xx/index.html">NXP LPC17xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc214x/index.html">NXP LPC214x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc2378/index.html">NXP LPC2378</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc31xx/index.html">NXP LPC31xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc40xx/index.html">NXP LPC40xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc43xx/index.html">NXP LPC43xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc54xx/index.html">NXP LPC54xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../max326xx/index.html">Maxim Integrated MAX32660</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../moxart/index.html">Moxa NP51x0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/ieee802154.html">Nordic nRF52 IEEE 802.15.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nuc1xx/index.html">nuvoTon NUC120</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phy62xx/index.html">PHY+ PHY62</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu/index.html">QEMU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">RaspberryPi rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sam34/index.html">Microchip SAM34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sama5/index.html">Microchip SAMA5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd2l2/index.html">Microchip SAMD2x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd5e5/index.html">Microchip samd5e5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">Microchip SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">ST STM32F1</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#supported-mcus">Supported MCUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../cloudctrl/index.html">CloudController</a></li>
<li class="toctree-l5"><a class="reference internal" href="../et-stm32-stamp/index.html">ET-STM32 Stamp</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">fire-stm2v2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../hymini-stm32/index.html">HY-MiniSTM32V</a></li>
<li class="toctree-l5"><a class="reference internal" href="../maple/index.html">maple</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f103rb/index.html">ST Nucleo F103RB</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimexino-stm32/index.html">olimexino-stm32</a></li>
<li class="toctree-l5"><a class="reference internal" href="../shenzhou/index.html">Shenzhou IV</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm3210e-eval/index.html">ST STM3210E-EVAL</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32_tiny/index.html">STM32 Tiny</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32butterfly2/index.html">STM32BUTTERFLY2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32f103-minimum/index.html">stm32f103-minimum</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32vldiscovery/index.html">ST STM32VLDiscovery</a></li>
<li class="toctree-l5"><a class="reference internal" href="../viewtool-stm32f107/index.html">ViewTool STM32F103/F107</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f4/index.html">ST STM32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l4/index.html">ST STM32L4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../str71x/index.html">ST STR71</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tiva/index.html">TI/Stellaris Tiva</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tms570/index.html">TI/Hercules TMS570xxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">ST STM32F1</a></li>
      <li class="breadcrumb-item active">fire-stm2v2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/stm32f1/boards/fire-stm32v2/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fire-stm2v2">
<h1>fire-stm2v2<a class="headerlink" href="#fire-stm2v2" title="Permalink to this heading"></a></h1>
<p>This page discusses issues unique to NuttX configurations for the M3
Wildfire development board (STM32F103VET6).  See <a class="reference external" href="http://firestm32.taobao.com">http://firestm32.taobao.com</a></p>
<p>This configuration should support both the version 2 and version 3 of the
Wildfire board (using NuttX configuration options).  However, only version 2
has been verified.</p>
<section id="pin-configuration">
<h2>Pin Configuration<a class="headerlink" href="#pin-configuration" title="Permalink to this heading"></a></h2>
</section>
<section id="dfu-and-jtag">
<h2>DFU and JTAG<a class="headerlink" href="#dfu-and-jtag" title="Permalink to this heading"></a></h2>
<section id="enbling-support-for-the-dfu-bootloader">
<h3>Enbling Support for the DFU Bootloader<a class="headerlink" href="#enbling-support-for-the-dfu-bootloader" title="Permalink to this heading"></a></h3>
<p>The linker files in these projects can be configured to indicate that you
will be loading code using STMicro built-in USB Device Firmware Upgrade (DFU)
loader or via some JTAG emulator.  You can specify the DFU bootloader by
adding the following line:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_DFU=y
</pre></div>
</div>
<p>to your .config file. Most of the configurations in this directory are set
up to use the DFU loader.</p>
<p>If CONFIG_STM32_DFU is defined, the code will not be positioned at the beginning
of FLASH (0x08000000) but will be offset to 0x08003000.  This offset is needed
to make space for the DFU loader and 0x08003000 is where the DFU loader expects
to find new applications at boot time.  If you need to change that origin for some
other bootloader, you will need to edit the file(s) ld.script.dfu for the
configuration.</p>
<p>The DFU SE PC-based software is available from the STMicro website,
<a class="reference external" href="http://www.st.com">http://www.st.com</a>.  General usage instructions:</p>
<ol class="arabic simple">
<li><p>Convert the NuttX Intel Hex file (nuttx.hex) into a special DFU
file (nuttx.dfu)… see below for details.</p></li>
<li><p>Connect the M3 Wildfire board to your computer using a USB cable.</p></li>
<li><p>Start the DFU loader on the M3 Wildfire board.  You do this by
resetting the board while holding the <em>Key</em> button.  Windows should
recognize that the DFU loader has been installed.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Run the DFU SE program to load nuttx.dfu into FLASH.</p></li>
</ol>
<p>What if the DFU loader is not in FLASH?  The loader code is available
inside of the Demo directory of the USBLib ZIP file that can be downloaded
from the STMicro Website.  You can build it using RIDE (or other toolchains);
you will need a JTAG emulator to burn it into FLASH the first time.</p>
<p>In order to use STMicro’s built-in DFU loader, you will have to get
the NuttX binary into a special format with a .dfu extension.  The
DFU SE PC_based software installation includes a file “DFU File Manager”
conversion program that a file in Intel Hex format to the special DFU
format.  When you successfully build NuttX, you will find a file called
nutt.hex in the top-level directory.  That is the file that you should
provide to the DFU File Manager.  You will end up with a file called
nuttx.dfu that you can use with the STMicro DFU SE program.</p>
</section>
<section id="enabling-jtag">
<h3>Enabling JTAG<a class="headerlink" href="#enabling-jtag" title="Permalink to this heading"></a></h3>
<p>If you are not using the DFU, then you will probably also need to enable
JTAG support.  By default, all JTAG support is disabled but there NuttX
configuration options to enable JTAG in various different ways.</p>
<p>These configurations effect the setting of the SWJ_CFG[2:0] bits in the AFIO
MAPR register.  These bits are used to configure the SWJ and trace alternate
function I/Os. The SWJ (SerialWire JTAG) supports JTAG or SWD access to the
Cortex debug port.  The default state in this port is for all JTAG support
to be disabled.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_JTAG_FULL_ENABLE - sets SWJ_CFG[2:0] to 000 which enables full
  SWJ (JTAG-DP + SW-DP)

CONFIG_STM32_JTAG_NOJNTRST_ENABLE - sets SWJ_CFG[2:0] to 001 which enable
  full SWJ (JTAG-DP + SW-DP) but without JNTRST.

CONFIG_STM32_JTAG_SW_ENABLE - sets SWJ_CFG[2:0] to 010 which would set JTAG-DP
  disabled and SW-DP enabled.

The default setting (none of the above defined) is SWJ_CFG[2:0] set to 100
which disable JTAG-DP and SW-DP.
</pre></div>
</div>
</section>
</section>
<section id="openocd">
<h2>OpenOCD<a class="headerlink" href="#openocd" title="Permalink to this heading"></a></h2>
<p>I have also used OpenOCD with the M3 Wildfire.  In this case, I used
the Olimex USB ARM OCD.  See the script in boards/arm/stm32/fire-stm32v2/tools/oocd.sh
for more information.  Using the script:</p>
<ul>
<li><p>Start the OpenOCD GDB server:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd &lt;nuttx-build-directory&gt;
boards/arm/stm32/fire-stm32v2/tools/oocd.sh $PWD
</pre></div>
</div>
</li>
<li><p>Load NuttX:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd &lt;nuttx-built-directory&gt;
arm-none-eabi-gdb nuttx
gdb&gt; target remote localhost:3333
gdb&gt; mon reset
gdb&gt; mon halt
gdb&gt; load nuttx
</pre></div>
</div>
</li>
<li><p>Running NuttX:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gdb&gt; mon reset
gdb&gt; c
</pre></div>
</div>
</li>
</ul>
</section>
<section id="leds">
<h2>LEDs<a class="headerlink" href="#leds" title="Permalink to this heading"></a></h2>
<p>The M3 Wildfire has 3 LEDs labeled LED1, LED2 and LED3.  These LEDs are not
used by the NuttX port unless CONFIG_ARCH_LEDS is defined.  In that case, the
usage by the board port is defined in include/board.h and src/up_autoleds.c.
The LEDs are used to encode OS-related events as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/* LED1   LED2   LED3 */
#define LED_STARTED                0  /* OFF    OFF    OFF */
#define LED_HEAPALLOCATE           1  /* ON     OFF    OFF */
#define LED_IRQSENABLED            2  /* OFF    ON     OFF */
#define LED_STACKCREATED           3  /* OFF    OFF    OFF */

#define LED_INIRQ                  4  /* NC     NC    ON  (momentary) */
#define LED_SIGNAL                 5  /* NC     NC    ON  (momentary) */
#define LED_ASSERTION              6  /* NC     NC    ON  (momentary) */
#define LED_PANIC                  7  /* NC     NC    ON  (2Hz flashing) */
#undef  LED_IDLE                      /* Sleep mode indication not supported */
</pre></div>
</div>
</section>
<section id="rtc">
<h2>RTC<a class="headerlink" href="#rtc" title="Permalink to this heading"></a></h2>
<p>The STM32 RTC may configured using the following settings.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_RTC - Enables general support for a hardware RTC. Specific
  architectures may require other specific settings.
CONFIG_RTC_HIRES - The typical RTC keeps time to resolution of 1
  second, usually supporting a 32-bit time_t value.  In this case,
  the RTC is used to &amp;quot;seed&amp;quot; the normal NuttX timer and the
  NuttX timer provides for higher resolution time. If CONFIG_RTC_HIRES
  is enabled in the NuttX configuration, then the RTC provides higher
  resolution time and completely replaces the system timer for purpose of
  date and time.
CONFIG_RTC_FREQUENCY - If CONFIG_RTC_HIRES is defined, then the
  frequency of the high resolution RTC must be provided.  If CONFIG_RTC_HIRES
  is not defined, CONFIG_RTC_FREQUENCY is assumed to be one.
CONFIG_RTC_ALARM - Enable if the RTC hardware supports setting of an alarm.
  A callback function will be executed when the alarm goes off.
</pre></div>
</div>
<p>In hi-res mode, the STM32 RTC operates only at 16384Hz.  Overflow interrupts
are handled when the 32-bit RTC counter overflows every 3 days and 43 minutes.
A BKP register is incremented on each overflow interrupt creating, effectively,
a 48-bit RTC counter.</p>
<p>In the lo-res mode, the RTC operates at 1Hz.  Overflow interrupts are not handled
(because the next overflow is not expected until the year 2106).</p>
<p>WARNING:  Overflow interrupts are lost whenever the STM32 is powered down.  The
overflow interrupt may be lost even if the STM32 is powered down only momentarily.
Therefore hi-res solution is only useful in systems where the power is always on.</p>
</section>
<section id="m3-wildfire-specific-configuration-options">
<h2>M3 Wildfire-specific Configuration Options<a class="headerlink" href="#m3-wildfire-specific-configuration-options" title="Permalink to this heading"></a></h2>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>Each M3 Wildfire configuration is maintained in a sub-directory and
can be selected as follow:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tools/configure.sh fire-stm32v2:&lt;subdir&gt;
</pre></div>
</div>
<p>Where &lt;subdir&gt; is one of the following:</p>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configure the NuttShell (nsh) located at examples/nsh. The nsh configuration
contains support for some built-in applications that can be enabled by making
some additional minor change to the configuration file.</p>
<p>Reconfiguring:  This configuration uses to the kconfig-mconf configuration tool
to control the configuration.  See the section entitled “NuttX Configuration
Tool” in the top-level README.txt file.</p>
<p>Start Delays:  If no SD card is present in the slot, or if the network is not
connected, then there will be long start-up delays before you get the NSH
prompt.  If I am focused on ENC28J60 debug, I usually disable MMC/SD so that
I don’t have to bother with the SD card:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_STM32_SDIO=n
CONFIG_MMCSD=n
</pre></div>
</div>
<p>STATUS:  The board port is basically functional. Not all features have been
verified.  The ENC28J60 network is not yet functional.  Networking is
enabled by default in this configuration for testing purposes.  To use this
configuration, the network must currently be disabled.  To do this using
the kconfig-mconf configuration tool:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; make menuconfig
</pre></div>
</div>
<p>Then de-select “Networking Support” -&gt; “Networking Support”</p>
<p>PDATE:  The primary problem with the ENC29J60 is a v2 board issue:  The
SPI FLASH and the ENC28J60 shared the same SPI chip select signal (PA4-SPI1-NSS).
In order to finish the debug of the ENC28J60, it may be necessary to lift
the SPI FLASH chip select pin from the board.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../et-stm32-stamp/index.html" class="btn btn-neutral float-left" title="ET-STM32 Stamp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../hymini-stm32/index.html" class="btn btn-neutral float-right" title="HY-MiniSTM32V" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>