<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Platform Directories &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
      <script src="../_static/doctools.js"></script>
      <script src="../_static/sphinx_highlight.js"></script>
      <script src="../_static/clipboard.min.js"></script>
      <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Porting Drivers to the STM32 F7" href="port_drivers_to_stm32f7.html" />
    <link rel="prev" title="NuttX Protected Build" href="protected_build.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../latest" selected="selected">latest</option>
    
    <option value="../../10.0.0" >10.0.0</option>
    
    <option value="../../10.0.1" >10.0.1</option>
    
    <option value="../../10.1.0" >10.1.0</option>
    
    <option value="../../10.2.0" >10.2.0</option>
    
    <option value="../../10.3.0" >10.3.0</option>
    
    <option value="../../11.0.0" >11.0.0</option>
    
    <option value="../../12.0.0" >12.0.0</option>
    
    <option value="../../12.1.0" >12.1.0</option>
    
    <option value="../../12.2.0" >12.2.0</option>
    
    <option value="../../12.2.1" >12.2.1</option>
    
    <option value="../../12.3.0" >12.3.0</option>
    
    <option value="../../12.4.0" >12.4.0</option>
    
    <option value="../../12.5.0" >12.5.0</option>
    
    <option value="../../12.5.1" >12.5.1</option>
    
    <option value="../../12.6.0" >12.6.0</option>
    
    <option value="../../12.7.0" >12.7.0</option>
    
    <option value="../../12.8.0" >12.8.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nfs.html">NFS Client How-To</a></li>
<li class="toctree-l2"><a class="reference internal" href="usbtrace.html">USB Device Trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulator.html">Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="qemugdb.html">How to debug NuttX using QEMU and GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="rndis.html">How to use RNDIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="drivers.html">Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasktrace.html">Task Trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp_cmake.html">C++ Example using CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="pysimcoder.html">pysimCoder integration with NuttX</a></li>
<li class="toctree-l2"><a class="reference internal" href="customboards.html">Custom Boards How-To</a></li>
<li class="toctree-l2"><a class="reference internal" href="customapps.html">Custom Apps How-to</a></li>
<li class="toctree-l2"><a class="reference internal" href="citests.html">Running CI Test Locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="zerolatencyinterrupts.html">High Performance: Zero Latency Interrupts, Maskable Nested Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="kasan.html">The Kernel Address Sanitizer (KASAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="fortify.html">Fortify</a></li>
<li class="toctree-l2"><a class="reference internal" href="nestedinterrupts.html">Nested Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="cortexmhardfaults.html">Analyzing Cortex-M Hardfaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="coredump.html">Core Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="coresight.html">Coresight - HW Assisted Tracing on ARM</a></li>
<li class="toctree-l2"><a class="reference internal" href="gdbserver.html">gdbserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="gdbwithpython.html">GDB with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="ofloader.html">Open Flash Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="testingtcpip.html">Testing TCP/IP Network Stacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="automounter.html">Auto-Mounter</a></li>
<li class="toctree-l2"><a class="reference internal" href="stm32nullpointer.html">STM32 Null Pointer Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="stm32ccm.html">STM32 CCM Allocator</a></li>
<li class="toctree-l2"><a class="reference internal" href="stackcheck.html">Stack Overflow Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="stackrecord.html">Run time stack statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="etcromfs.html">etc romfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread_local_storage.html">Thread Local Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="devicetree.html">Device Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="debuggingflash_nuttxonarm.html">Debugging / flashing NuttX on ARM with hardware debugger (JTAG/SWD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changing_systemclockconfig.html">Changing the System Clock Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="usingkernelthreads.html">Using Kernel Threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="armv7m_runtimestackcheck.html">ARMv7-M Run Time Stack Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="disabling_stackdumpdebug.html">Disabling the Stack Dump During Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="include_files_board_h.html">Including Files in board.h</a></li>
<li class="toctree-l2"><a class="reference internal" href="specialstuff_in_nuttxheaderfiles.html">Why can’t I put my special stuff in NuttX header files?</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel_threads_with_custom_stacks.html">Kernel Threads with Custom Stacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="versioning_and_task_names.html">Versioning and Task Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging_rambuffer.html">Logging to a RAM Buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="mte.html">ATM64 MTE extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrate_newlib.html">Integrating with Newlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="protected_build.html">NuttX Protected Build</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Platform Directories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#arch-arch-src-chip">1. arch/&lt;arch&gt;/src/&lt;chip&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arch-arch-include-chip">2. arch/&lt;arch&gt;/include/&lt;chip&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configs-board-include">3. configs/&lt;board&gt;/include</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configs-board-src">4. configs/&lt;board&gt;/src</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-directory">5. Application Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drivers">6. drivers/</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apps-platform-board-maybe">7. apps/platform/&lt;board&gt; (maybe)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="port_drivers_to_stm32f7.html">Porting Drivers to the STM32 F7</a></li>
<li class="toctree-l2"><a class="reference internal" href="semihosting.html">Semihosting</a></li>
<li class="toctree-l2"><a class="reference internal" href="renode.html">Run NuttX on Renode</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal_events_interrupt_handlers.html">Signaling Events from Interrupt Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="signaling_sem_priority_inheritance.html">Signaling Semaphores and Priority Inheritance</a></li>
<li class="toctree-l2"><a class="reference internal" href="smaller_vector_tables.html">Smaller Vector Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="port.html">How to port</a></li>
<li class="toctree-l2"><a class="reference internal" href="updating_release_system_elf.html">Updating a Release System with ELF Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="partially_linked_elf.html">ELF Programs – With Symbol Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="fully_linked_elf.html">ELF Programs – No Symbol Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_nuttx_with_app_out_of_src_tree.html">Building NuttX with Applications Outside the Source Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="building_uclibcpp.html">Building uClibc++</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom_app_directories.html">Custom Application Directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_elf_loadable_modules.html">Debugging ELF Loadable Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_nsh_sessions.html">Multiple NSH Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="nsh_network_link_management.html">NSH Network Link Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="ram_rom_disks.html">RAM Disks and ROM Disks</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading_can_msgs.html">Reading CAN Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="remove_device_drivers_nsh.html">Removing Device Drivers with NSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="rust.html">Rust in NuttX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logos/index.html">NuttX Logos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Guides</a></li>
      <li class="breadcrumb-item active">Platform Directories</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guides/platform_directories.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="platform-directories">
<h1>Platform Directories<a class="headerlink" href="#platform-directories" title="Permalink to this heading"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Migrated from:
<a class="reference external" href="https://cwiki.apache.org/confluence/display/NUTTX/Platform+Directories">https://cwiki.apache.org/confluence/display/NUTTX/Platform+Directories</a></p>
</div>
<p>Let’s assume that you are not change the OS itself but want to implement or
extend platform-specific code.In this case, there are six, maybe seven,
places where you can provide the platform code.</p>
<img alt="../_images/directories.png" src="../_images/directories.png" />
<p>REVISIT: This is a out of date. There has been a recent reorganization
of the board-related directories: The <code class="docutils literal notranslate"><span class="pre">configs/</span></code> directory has been
renamed <code class="docutils literal notranslate"><span class="pre">boards/</span></code> and structure under the new <code class="docutils literal notranslate"><span class="pre">boards/</span></code> directory is
significantly different. A <code class="docutils literal notranslate"><span class="pre">&lt;board&gt;</span></code> directory would now be found
at <code class="docutils literal notranslate"><span class="pre">boards/&lt;arch&gt;/&lt;chip&gt;/&lt;board&gt;</span></code>. Conceptually the figure is correct,
just not consistent with current naming.</p>
<p>Each directory has slightly different properties and are discussed
in more detail below where:</p>
<ul class="simple">
<li><p><cite>&lt;arch&gt;</cite> represents the chip architecture that you are using.
As examples, <cite>&lt;arch&gt;</cite> might represent <code class="docutils literal notranslate"><span class="pre">arm</span></code> or <code class="docutils literal notranslate"><span class="pre">mips</span></code>.</p></li>
<li><p><cite>&lt;chip&gt;</cite> represents the specific chip family that you are using.
As examples, <cite>&lt;chip&gt;</cite> might mean <code class="docutils literal notranslate"><span class="pre">stm32</span></code> or <code class="docutils literal notranslate"><span class="pre">efm32</span></code></p></li>
<li><p><cite>&lt;board&gt;</cite> represents the specific board that you are using.
As examples, <cite>&lt;board&gt;</cite> might be <code class="docutils literal notranslate"><span class="pre">stm32f4discovery</span></code> or <code class="docutils literal notranslate"><span class="pre">dk-tm4c129x</span></code></p></li>
</ul>
<section id="arch-arch-src-chip">
<h2>1. arch/&lt;arch&gt;/src/&lt;chip&gt;<a class="headerlink" href="#arch-arch-src-chip" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory should hold all chip related
logic. Almost all chip-specific header files should reside here
too. That includes device-related header files. GPIO header
files, for example, go here and no where else.</p>
</section>
<section id="arch-arch-include-chip">
<h2>2. arch/&lt;arch&gt;/include/&lt;chip&gt;<a class="headerlink" href="#arch-arch-include-chip" title="Permalink to this heading"></a></h2>
<p>The intent of the <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code> directory is to
hold driver-related definitions needed by application in order
to access drivers registered by the chip-specific logic in the
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory. This would include things like:</p>
<ul class="simple">
<li><p>The IOCTL cmds that would be used with the driver
<code class="docutils literal notranslate"><span class="pre">ioctl()</span></code> interfaces calls,</p></li>
<li><p>Structure definitions of parameters passed with
IOCTL cmds, and</p></li>
<li><p>Structure definitions of binary data that might
be transferred via the driver <code class="docutils literal notranslate"><span class="pre">read()</span></code> or <code class="docutils literal notranslate"><span class="pre">write()</span></code> methods.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code> directory is not currently used
properly for most of the definitions you will find there. Most
of the definitions in these header files really belong in the
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory but are here for historical
reasons only at this point.</p>
<p>The difference between header files in <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code>
directory and the header files in <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory
is that the former can be included by applications using the
include path:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;arch/chip/someheader.h&gt;</span>
</pre></div>
</div>
<p>The header files in <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> cannot be used by
applications. Those header flies can and only be used in the
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> and in the <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;</span></code> directories.</p>
<p>The header files in this directory <cite>MUST NOT</cite> introduce <cite>ad hoc</cite>
non-standard function call interfaces between the application
and the OS. The OS interfaces are highly controlled and not
subject to <cite>ad hoc</cite> extension.</p>
<p>The NuttX build system enforces this and I do everything that
I can to restrict usage of all chip specific facilities to those
directories. In reality you are free, of course, to subvert that
intent in any way you please for your personal project; but any
subversion of that intent will not not be committed into the
upstream NuttX repository.</p>
</section>
<section id="configs-board-include">
<h2>3. configs/&lt;board&gt;/include<a class="headerlink" href="#configs-board-include" title="Permalink to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/include</span></code> directory is the moral equivalent of the
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code> directory for boards: The
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code> directory holds chip-specific
definitions that are accessible all logic (event even application code).
Similarly the <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/include</span></code> directory holds board-specific
definitions that are accessible even to applications code. And the
same kinds of driver interfacing data should appear in these
files (see the list above).</p>
<p>Similarly, the intent of the <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/include</span></code> directory
is to hold driver-related definitions needed by application in
order to access drivers registered by the board-specific logic
in the <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/src</span></code> directory. The header files in the
<code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/include</span></code> directory can be included using this
include path:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;arch/board/someheader.h&gt;</span>
</pre></div>
</div>
<p>The header files in this directory <cite>MUST NOT</cite> introduce <cite>ad hoc</cite>
non-standard function call interfaces between the application
and the OS. The OS interfaces are highly controlled and not
subject to <cite>ad hoc</cite> extension.</p>
</section>
<section id="configs-board-src">
<h2>4. configs/&lt;board&gt;/src<a class="headerlink" href="#configs-board-src" title="Permalink to this heading"></a></h2>
<p>All of your board-specific initialization logic and <cite>all</cite> of the
custom board device driver logic should go either in a <cite>built-in</cite>
<code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/src</span></code> directory or in an external, custom board
directory. These board directories are where all of your
board-specific, hardware interfacing work should be done.
As a minimum, a built-in board directory must contain
these files/directories at a minimum:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Kconfig</span></code> to include the custom board configuration options into
the NuttX configuration system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/Makefile</span></code> contains the custom board build logic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/board.h</span></code> provides board-specific information needed by the system</p></li>
</ul>
<p>Most people will eventually want to create their own custom board
directory. If you do <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">menuconfig</span></code> you will find under the board
menu that you can enable and configure a custom board directory.
One of these configuration options is the path to your custom
board directory. That is where you will want to implement all
of your product-specific device driver logic. As a minimum,
your custom board directory must contain these files/directories at a minimum:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src/Makefile</span></code> contains the custom board build logic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/board.h</span></code> provides board-specific information needed by the system</p></li>
</ul>
<p>NOTE: That the configuration definition file, <code class="docutils literal notranslate"><span class="pre">Kconfig</span></code>, is not
currently supported in the custom board configuration directory.</p>
<p>Within either type of <code class="docutils literal notranslate"><span class="pre">board/src</span></code> directory you will have
free access to all of the header files in the whole system,
including even those in the <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory.
There are no limitations whatsoever; All include paths are supported.</p>
</section>
<section id="application-directory">
<h2>5. Application Directory<a class="headerlink" href="#application-directory" title="Permalink to this heading"></a></h2>
<p>There are many ways to implement your application build. How you do that is
not really a part of NuttX and the topic is beyond the scope of this Wiki
page. The NuttX apps package does provide one example of an application
directory you may choose to use – or not. That apps/ directory is
intended to provide you with some guidance. But if you search the
messages in the forum, you can get lots of other ideas how to
structure the application build.</p>
<p>The application logic can include header files from
<code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/include/&lt;chip&gt;</span></code> directory or from the
<code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/include</span></code> directory for sole purpose
of support standard driver interfacing. The header
files in this directories must not introduce
uncontrolled, <cite>ad hoc</cite> interfaces into the operating system.</p>
<p>In the application directory, you cannot include header files
from either the <code class="docutils literal notranslate"><span class="pre">arch/&lt;arch&gt;/src/&lt;chip&gt;</span></code> directory or the
<code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/src</span></code> directory. That is an intentional
restriction that I try to enforce in order to support the
NuttX model for the segregation of functionality. But again,
you can always subvert that in your own repository as you
like. There should be no device level code in your application.
There should be no need to access GPIOs or registers or
anything like that. That all should be done in the chip
directory or in your board directory.</p>
<p>The model I advocate is to create and register standard device
drivers in your <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/src</span></code> or custom board directory,
then you can access the device in your application directory
using the standard <code class="docutils literal notranslate"><span class="pre">open()</span></code> / <code class="docutils literal notranslate"><span class="pre">close()</span></code> / <code class="docutils literal notranslate"><span class="pre">read()</span></code> / <code class="docutils literal notranslate"><span class="pre">write()</span></code>
functions.</p>
<p>But I am all about freedom. Please do things exactly how you
want to do them. Make sure the project meets all of your needs
first; do things as you like. But, of course, I cannot commit
anything upstream that does not conform to these architectural rules.</p>
</section>
<section id="drivers">
<h2>6. drivers/<a class="headerlink" href="#drivers" title="Permalink to this heading"></a></h2>
<p>Above I said that all of the devices drivers for the board-specific
resources should go in your <code class="docutils literal notranslate"><span class="pre">configs/&lt;board&gt;/src</span></code> directory. However
if your board is loaded with standard external parts that require
device drivers – such as an lcd, a touchscreen, serial FLASH,
accelerometers, etc. – then you will want to re-use or implement
standard drivers for these parts that can be shared by different
boards. In that case the <code class="docutils literal notranslate"><span class="pre">drivers/</span></code> directory is the correct place
for those implementations. Header files associated with these
common drivers would go in the appropriate place under <code class="docutils literal notranslate"><span class="pre">include/nuttx/</span></code>.</p>
</section>
<section id="apps-platform-board-maybe">
<h2>7. apps/platform/&lt;board&gt; (maybe)<a class="headerlink" href="#apps-platform-board-maybe" title="Permalink to this heading"></a></h2>
<p>A final place where you can put application specific data is the
<code class="docutils literal notranslate"><span class="pre">apps/platform/&lt;board&gt;</span></code> directory. This is really part of <cite>5.
Application Directory</cite> if you are using the NuttX <code class="docutils literal notranslate"><span class="pre">apps/</span></code> package.
But since it has a slightly different purpose, it is worth
discussing separately.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">apps/platform/</span></code> directory structure is very similar to the
<code class="docutils literal notranslate"><span class="pre">nuttx/configs/</span></code> directory with one directory per board. At
context create time, a symbolic link at <code class="docutils literal notranslate"><span class="pre">apps/platform/board</span></code>
is set up to link to the board-specific directory in
<code class="docutils literal notranslate"><span class="pre">apps/platform/&lt;board&gt;</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">apps/platform/&lt;board&gt;</span></code> directory is where board-specific
application logic could be placed. This directory is not often
used. In the normal <cite>flat</cite> Nuttx build, there is really not much
difference between the <code class="docutils literal notranslate"><span class="pre">nuttx/configs/&lt;board&gt;</span></code> board directory
and the <code class="docutils literal notranslate"><span class="pre">apps/platform/&lt;board&gt;</span></code> board directory. Hence the
former is normally sufficient.</p>
<p>The fundamental difference between the two board directories
is that the <code class="docutils literal notranslate"><span class="pre">nuttx/configs/&lt;board&gt;</span></code> board directory is inside
the operating system while the <code class="docutils literal notranslate"><span class="pre">apps/platform/&lt;board&gt;</span></code> directory
is outside of the operating system. This distinction does not
mean very much in the <cite>flat</cite> build (<code class="docutils literal notranslate"><span class="pre">CONFIG_BUILD_FLAT</span></code>) because
nothing enforces <cite>inside</cite>-ness or <cite>outside</cite>-ness in that case.
But the distinction is very important in protected builds
(<code class="docutils literal notranslate"><span class="pre">CONFIG_BUILD_PROTECTED</span></code>) and <cite>kernel</cite> builds
(<code class="docutils literal notranslate"><span class="pre">CONFIG_BUILD_KERNEL</span></code>) because the code operating
<cite>inside</cite> the OS is privileged, kernel-mode logic;
the code <cite>outside</cite> of the OS, on the other hand,
is unprivileged, user-mode code. The two cannot be intermixed.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="protected_build.html" class="btn btn-neutral float-left" title="NuttX Protected Build" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="port_drivers_to_stm32f7.html" class="btn btn-neutral float-right" title="Porting Drivers to the STM32 F7" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>