<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QMI8658 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
      <script src="../../../../_static/jquery.js"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
      <script src="../../../../_static/doctools.js"></script>
      <script src="../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../_static/clipboard.min.js"></script>
      <script src="../../../../_static/copybutton.js"></script>
      <script src="../../../../_static/design-tabs.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="SHT4X" href="sht4x.html" />
    <link rel="prev" title="NAU7802" href="nau7802.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../../12.10.0" >12.10.0</option>
    
    <option value="../../../../../12.11.0" >12.11.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">OS Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../binfmt.html">Binary Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../concurrency/index.html">Concurrency</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Device Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../character/index.html">Character Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../block/index.html">Block Device Drivers</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Specialized Device Drivers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../audio.html">Audio Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../clk.html">Clock management (CLK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../devicetree.html">Device Tree support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../devmem.html">DEVMEM Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dma.html">DMA Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../framebuffer.html">Frame Buffer Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../i2c.html">I2C Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../i2c.html#i2c-slave-device-drivers">I2C Slave Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../i3c.html">I3C Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ioexpander.html">IO Expander Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lcd.html">LCD Character Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mtd.html">Memory Technology Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../regmap.html">drivers/regmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reset.html">Reset Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rptun.html">Remote Proc Tunnel Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rwbuffer.html"><code class="docutils literal notranslate"><span class="pre">rwbuffer.c</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../sensors.html">Sensor Drivers</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="sensors_uorb.html">Sensor “uORB” Drivers</a></li>
<li class="toctree-l5"><a class="reference internal" href="sensors_legacy.html">Sensor Legacy Drivers</a></li>
<li class="toctree-l5"><a class="reference internal" href="sensors_cluster.html">Sensor Cluster (Obsolete)</a></li>
<li class="toctree-l5"><a class="reference internal" href="adt7320.html">ADT7320</a></li>
<li class="toctree-l5"><a class="reference internal" href="adxl345.html">ADXL345</a></li>
<li class="toctree-l5"><a class="reference internal" href="adxl362.html">ADXL362</a></li>
<li class="toctree-l5"><a class="reference internal" href="adxl372.html">ADXL372</a></li>
<li class="toctree-l5"><a class="reference internal" href="aht10.html">AHT10</a></li>
<li class="toctree-l5"><a class="reference internal" href="ak09912.html">AK09912</a></li>
<li class="toctree-l5"><a class="reference internal" href="lsm330.html">LSM330_SPI</a></li>
<li class="toctree-l5"><a class="reference internal" href="mcp9600.html">MCP9600</a></li>
<li class="toctree-l5"><a class="reference internal" href="mpl115a.html">MPL115A</a></li>
<li class="toctree-l5"><a class="reference internal" href="nau7802.html">NAU7802</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">QMI8658</a></li>
<li class="toctree-l5"><a class="reference internal" href="sht4x.html">SHT4X</a></li>
<li class="toctree-l5"><a class="reference internal" href="lsm6dso32.html">LSM6DSO32</a></li>
<li class="toctree-l5"><a class="reference internal" href="lis2mdl.html">LIS2MDL</a></li>
<li class="toctree-l5"><a class="reference internal" href="l86xxx.html">L86-XXX</a></li>
<li class="toctree-l5"><a class="reference internal" href="gnss_lowerhalf.html">GNSS Lower Half uORB Driver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../segger.html">Segger RTT drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../spi.html">SPI Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../syslog.html">SYSLOG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sdio.html">SDIO Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usbdev.html">USB Device-Side Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usbhost.html">USB Host-Side Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usbmisc.html">USB Miscellaneous Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usbmonitor.html">USB Monitor support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../usrsock.html">Usrsock Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mmcsd.html">MMCSD Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../net/index.html">Network interface drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pci/index.html">PCI(e) Bus Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pinctrl.html">Pinctrl Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pipes.html">FIFO and named pipe drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../power/index.html">Power-related Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ptp.html">PTP Clock Driver Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../virtio.html">Virtio Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../video.html">Video Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../wireless.html">Wireless Drivers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../thermal/index.html">Thermal Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#lower-half-and-upper-half">Lower-half and upper-half</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#subdirectories-of-nuttx-drivers">Subdirectories of <code class="docutils literal notranslate"><span class="pre">nuttx/drivers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#skeleton-files">Skeleton Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#drivers-early-initialization">Drivers Early Initialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../nxflat.html">NXFLAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nxgraphics/index.html">NX Graphics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../paging.html">On-Demand Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../audio/index.html">Audio Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../filesystem/index.html">NuttX File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../libs/index.html">NuttX libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/index.html">Network Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../syscall.html">Syscall Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/index.html"><code class="docutils literal notranslate"><span class="pre">/tools</span></code> Host Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arch/index.html">Architecture-Specific Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../boards.html">Boards Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cmake.html">CMake Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../openamp.html">OpenAMP Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../video.html">Video Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../crypto.html">Crypto API Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../wireless.html">Wireless Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">OS Components</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Specialized Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="../sensors.html">Sensor Drivers</a></li>
      <li class="breadcrumb-item active">QMI8658</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/components/drivers/special/sensors/qmi8658.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qmi8658">
<h1>QMI8658<a class="headerlink" href="#qmi8658" title="Permalink to this heading"></a></h1>
<p>The QMI8658 is a high-performance 6-axis IMU sensor by QST featuring a 3-axis
accelerometer and 3-axis gyroscope. It supports both I2C and SPI interfaces,
although this driver currently supports I2C communication only.</p>
<p>This driver uses the <a class="reference internal" href="sensors_uorb.html"><span class="doc">uorb</span></a> interface. It supports the
self-test capability for both the accelerometer and gyroscope.</p>
<p>The driver supports comprehensive features including multiple full-scale ranges,
configurable ODR settings, low-pass filters, FIFO buffer management, temperature
sensing, and device calibration.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The QMI8658 is a feature-rich sensor with advanced capabilities like
tap detection, motion detection, and various low-power modes. This driver
implements the core functionality for accelerometer and gyroscope data
acquisition with room for future feature extensions.</p>
</div>
<section id="application-programming-interface">
<h2>Application Programming Interface<a class="headerlink" href="#application-programming-interface" title="Permalink to this heading"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;nuttx/sensors/qmi8658.h&gt;</span>
</pre></div>
</div>
<p>The QMI8658 driver provides one registration function:</p>
<ul class="simple">
<li><p><strong>uORB Interface</strong>: <code class="docutils literal notranslate"><span class="pre">qmi8658_uorb_register()</span></code></p></li>
</ul>
<section id="registration">
<h3>Registration<a class="headerlink" href="#registration" title="Permalink to this heading"></a></h3>
<p>The uORB interface registers the driver and creates separate uORB topics for
accelerometer and gyroscope data under <code class="docutils literal notranslate"><span class="pre">/dev/uorb/</span></code>: <code class="docutils literal notranslate"><span class="pre">sensor_accel&lt;n&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">sensor_gyro&lt;n&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the device number.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Example uORB registration */</span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qmi8658_uorb_register</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">i2c_bus</span><span class="p">,</span><span class="w"> </span><span class="n">QMI8658_I2C_ADDR_DEFAULT</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">syslog</span><span class="p">(</span><span class="n">LOG_ERR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Couldn&#39;t register QMI8658 uORB: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>The uORB interface registers the driver and creates separate uORB topics for
accelerometer and gyroscope data under <code class="docutils literal notranslate"><span class="pre">/dev/uorb/</span></code>: <code class="docutils literal notranslate"><span class="pre">sensor_accel&lt;n&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">sensor_gyro&lt;n&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the device number.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Example uORB registration */</span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qmi8658_uorb_register</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">i2c_bus</span><span class="p">,</span><span class="w"> </span><span class="n">QMI8658_I2C_ADDR_DEFAULT</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">syslog</span><span class="p">(</span><span class="n">LOG_ERR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Couldn&#39;t register QMI8658 uORB: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="configuration-options">
<h2>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this heading"></a></h2>
<p>The QMI8658 driver supports several Kconfig options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SENSORS_QMI8658</span></code>: Enable QMI8658 driver support (requires UORB)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SENSORS_QMI8658_POLL</span></code>: Enable polling mode with configurable interval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_SENSORS_QMI8658_POLL_INTERVAL</span></code>: Set polling interval (default 1s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONFIG_QMI8658_I2C_FREQUENCY</span></code>: Set I2C communication frequency (default 400kHz)</p></li>
</ul>
</section>
<section id="supported-features">
<h2>Supported Features<a class="headerlink" href="#supported-features" title="Permalink to this heading"></a></h2>
<section id="accelerometer">
<h3>Accelerometer<a class="headerlink" href="#accelerometer" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Full-Scale Ranges</strong>: ±2g, ±4g, ±8g, ±16g</p></li>
<li><p><strong>Output Data Rates</strong>: 1000Hz, 500Hz, 250Hz, 125Hz, 62.5Hz, 31.25Hz</p></li>
<li><p><strong>Low-Power ODR</strong>: 128Hz, 21Hz, 11Hz, 3Hz</p></li>
<li><p><strong>Low-Pass Filters</strong>: 4 different modes + OFF</p></li>
</ul>
</section>
<section id="gyroscope">
<h3>Gyroscope<a class="headerlink" href="#gyroscope" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Full-Scale Ranges</strong>: ±16, ±32, ±64, ±128, ±256, ±512, ±1024 dps</p></li>
<li><p><strong>Output Data Rates</strong>: 7174.4Hz, 3587.2Hz, 1793.6Hz, 896.8Hz, 448.4Hz, 224.2Hz, 112.1Hz, 56.05Hz, 28.025Hz</p></li>
<li><p><strong>Low-Pass Filters</strong>: 4 different modes + OFF</p></li>
</ul>
<p>Additional Features
—————–==</p>
<ul class="simple">
<li><p><strong>Temperature Sensor</strong>: 16-bit temperature data with 256 LSB/°C scale factor</p></li>
<li><p><strong>FIFO Buffer</strong>: Configurable FIFO with watermark and interrupt support</p></li>
<li><p><strong>Sampling Modes</strong>: Synchronous and asynchronous sampling</p></li>
<li><p><strong>Interrupt Support</strong>: Data ready, FIFO watermark, motion detection</p></li>
<li><p><strong>Self-Test</strong>: Built-in self-test capability for both sensors</p></li>
<li><p><strong>Calibration</strong>: On-demand calibration support</p></li>
</ul>
</section>
</section>
<section id="ioctl-commands">
<h2>IOCTL Commands<a class="headerlink" href="#ioctl-commands" title="Permalink to this heading"></a></h2>
<section id="uorb-ioctls">
<h3>uORB IOCTLs<a class="headerlink" href="#uorb-ioctls" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SNIOC_SETFULLSCALE</span></code>: Set full-scale range (argument in g for accel, dps for gyro)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNIOC_SET_CALIBVALUE</span></code>: Set calibration offsets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNIOC_SELFTEST</span></code>: Perform sensor self-test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNIOC_WHO_AM_I</span></code>: Read device ID (should return 0x05)</p></li>
</ul>
</section>
</section>
<section id="scale-factors">
<h2>Scale Factors<a class="headerlink" href="#scale-factors" title="Permalink to this heading"></a></h2>
<p>The driver provides predefined scale factors for converting raw sensor data
to physical units:</p>
<p>Accelerometer Scale Factors (LSB/g):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define QMI8658_ACC_SCALE_2G       (16384.0f)</span>
<span class="cp">#define QMI8658_ACC_SCALE_4G       (8192.0f)</span>
<span class="cp">#define QMI8658_ACC_SCALE_8G       (4096.0f)</span>
<span class="cp">#define QMI8658_ACC_SCALE_16G      (2048.0f)</span>
</pre></div>
</div>
<p>Gyroscope Scale Factors (LSB/dps):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define QMI8658_GYRO_SCALE_16DPS   (2048.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_32DPS   (1024.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_64DPS   (512.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_128DPS  (256.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_256DPS  (128.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_512DPS  (64.0f)</span>
<span class="cp">#define QMI8658_GYRO_SCALE_1024DPS (32.0f)</span>
</pre></div>
</div>
<p>Temperature Scale Factor (LSB/°C):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define QMI8658_TEMP_SCALE         (256.0f)</span>
</pre></div>
</div>
</section>
<section id="data-conversion">
<h2>Data Conversion<a class="headerlink" href="#data-conversion" title="Permalink to this heading"></a></h2>
<p>To convert raw sensor data to physical units:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Convert accelerometer raw data to g */</span>

<span class="kt">float</span><span class="w"> </span><span class="n">accel_x_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_accel_x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_ACC_SCALE_8G</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">accel_y_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_accel_y</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_ACC_SCALE_8G</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">accel_z_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_accel_z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_ACC_SCALE_8G</span><span class="p">;</span>

<span class="cm">/* Convert gyroscope raw data to dps */</span>

<span class="kt">float</span><span class="w"> </span><span class="n">gyro_x_dps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_gyro_x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_GYRO_SCALE_512DPS</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">gyro_y_dps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_gyro_y</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_GYRO_SCALE_512DPS</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">gyro_z_dps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_gyro_z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_GYRO_SCALE_512DPS</span><span class="p">;</span>

<span class="cm">/* Convert temperature raw data to °C */</span>

<span class="kt">float</span><span class="w"> </span><span class="n">temp_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">raw_temp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">QMI8658_TEMP_SCALE</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="debugging-and-testing">
<h2>Debugging and Testing<a class="headerlink" href="#debugging-and-testing" title="Permalink to this heading"></a></h2>
<p>To debug the QMI8658 device, you can:</p>
<ol class="arabic simple">
<li><p><strong>Enable Debug Output</strong>: Set <code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_SENSORS</span></code> and <code class="docutils literal notranslate"><span class="pre">CONFIG_DEBUG_INFO</span></code></p></li>
<li><p><strong>Use uORB Listener</strong>: Include <code class="docutils literal notranslate"><span class="pre">uorb_listener</span></code> application to monitor sensor data</p></li>
</ol>
</section>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><strong>I2C Frequency</strong>: Default 400kHz, configurable via <code class="docutils literal notranslate"><span class="pre">CONFIG_QMI8658_I2C_FREQUENCY</span></code></p></li>
<li><p><strong>Polling Overhead</strong>: Use interrupt-driven mode when possible for better efficiency</p></li>
<li><p><strong>FIFO Usage</strong>: Enable FIFO to reduce I2C traffic and CPU overhead</p></li>
<li><p><strong>Power Management</strong>: Utilize low-power ODR settings for battery-powered applications</p></li>
</ul>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Currently supports I2C interface only (SPI support can be added)</p></li>
<li><p>Advanced features like tap detection and motion detection not yet implemented</p></li>
<li><p>FIFO interrupt handling not fully implemented</p></li>
<li><p>Some low-power modes require additional configuration</p></li>
</ul>
</section>
<section id="hardware-connections">
<h2>Hardware Connections<a class="headerlink" href="#hardware-connections" title="Permalink to this heading"></a></h2>
<section id="i2c-interface">
<h3>I2C Interface<a class="headerlink" href="#i2c-interface" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>VDD</strong>: Power supply (1.71V to 3.6V)</p></li>
<li><p><strong>GND</strong>: Ground</p></li>
<li><p><strong>SDA/SDI</strong>: I2C Serial Data</p></li>
<li><p><strong>SCL/SCLK</strong>: I2C Serial Clock</p></li>
<li><p><strong>CS</strong>: Chip Select (connect to VDD for I2C mode)</p></li>
<li><p><strong>INT1/INT2</strong>: Interrupt pins (optional)</p></li>
</ul>
<p>Typical I2C addresses:
* <strong>Primary</strong>: 0x6B
* <strong>Secondary</strong>: 0x6D (when SDO/SA0 pin is high)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure proper pull-up resistors on SDA and SCL lines (typically 4.7kΩ for 3.3V).</p>
</div>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h2>
<p><strong>Device Not Responding</strong>
* Check I2C address and connections
* Verify power supply voltage
* Ensure CS pin is properly configured for I2C mode</p>
<p><strong>Incorrect Readings</strong>
* Verify full-scale range settings
* Check scale factor calculations
* Ensure sensor is properly calibrated</p>
<p><strong>Communication Errors</strong>
* Reduce I2C frequency
* Check for signal integrity issues
* Verify pull-up resistor values</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nau7802.html" class="btn btn-neutral float-left" title="NAU7802" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sht4x.html" class="btn btn-neutral float-right" title="SHT4X" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>