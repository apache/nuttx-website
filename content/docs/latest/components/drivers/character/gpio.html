<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPIO Drivers &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
      <script src="../../../_static/doctools.js"></script>
      <script src="../../../_static/sphinx_highlight.js"></script>
      <script src="../../../_static/clipboard.min.js"></script>
      <script src="../../../_static/copybutton.js"></script>
      <script src="../../../_static/design-tabs.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="I2S Drivers" href="i2s.html" />
    <link rel="prev" title="EFUSE Drivers" href="efuse.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../12.10.0" >12.10.0</option>
    
    <option value="../../../../12.11.0" >12.11.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">OS Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../binfmt.html">Binary Loader</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Device Drivers</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Character Device Drivers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="1wire.html">One Wire Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="analog/index.html">Analog (ADC/DAC) Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="bch.html">Block Driver to Character Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="can.html">CAN Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="contactless.html">Constactless Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="crypto/index.html">Crypto Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="eeprom.html">EEPROM</a></li>
<li class="toctree-l4"><a class="reference internal" href="efuse.html">EFUSE Drivers</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">GPIO Drivers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#application-programming-interface">Application Programming Interface</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="#io-expander-device-drivers">IO Expander Device Drivers</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="i2s.html">I2S Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="input/index.html">Input Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="ipcc.html">IPCC (Inter Processor Communication Controller) Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="leds/index.html">LEDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="loop.html">Loop Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="math.html">Math Acceleration Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="modem.html">Modem Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="motor/index.html">Motor Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="note.html">Note Driver Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="nullzero.html"><code class="docutils literal notranslate"><span class="pre">dev_null.c</span></code> and <code class="docutils literal notranslate"><span class="pre">dev_zero.c</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="quadrature.html">Quadrature Encoder Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="rc.html">Remote Control Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="rf.html">RF Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="serial.html">Serial Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="timers/index.html">Timers Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="touchscreen.html">Touchscreen Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="wireless/index.html">Wireless character drivers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../block/index.html">Block Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../special/index.html">Specialized Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermal/index.html">Thermal Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#lower-half-and-upper-half">Lower-half and upper-half</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#subdirectories-of-nuttx-drivers">Subdirectories of <code class="docutils literal notranslate"><span class="pre">nuttx/drivers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#skeleton-files">Skeleton Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#drivers-early-initialization">Drivers Early Initialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../nxflat.html">NXFLAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nxgraphics/index.html">NX Graphics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../paging.html">On-Demand Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../audio/index.html">Audio Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../filesystem/index.html">NuttX File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../libs/index.html">NuttX libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../net/index.html">Network Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../syscall.html">Syscall Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/index.html"><code class="docutils literal notranslate"><span class="pre">/tools</span></code> Host Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arch/index.html">Architecture-Specific Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../boards.html">Boards Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cmake.html">CMake Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../openamp.html">OpenAMP Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../video.html">Video Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto.html">Crypto API Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wireless.html">Wireless Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">OS Components</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="index.html">Character Device Drivers</a></li>
      <li class="breadcrumb-item active">GPIO Drivers</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/components/drivers/character/gpio.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gpio-drivers">
<h1>GPIO Drivers<a class="headerlink" href="#gpio-drivers" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">include/nuttx/ioexpander/gpio.h</span></code>. All structures and APIs needed
to work with GPIO pins as drivers are provided in this header file. This
header file includes:</p>
<ol class="arabic simple">
<li><p>Structures and interface descriptions needed to develop a
low-level, board-specific, GPIO driver.</p></li>
<li><p>To register the GPIO driver with a common GPIO character
driver.</p></li>
<li><p>Interfaces needed for interfacing user programs with the
common GPIO character driver.</p></li>
</ol>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">drivers/ioexpander/gpio.c</span></code>. The implementation of the common GPIO
character driver.</p></li>
</ul>
<section id="application-programming-interface">
<h2>Application Programming Interface<a class="headerlink" href="#application-programming-interface" title="Permalink to this heading"></a></h2>
<p>The Application Programming Interface is included in the application with
the following header file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;nuttx/ioexpander/gpio.h&gt;</span>
</pre></div>
</div>
<p>A GPIO pin is either an input pin or an output pin.</p>
<p>One GPIO pin is registered as a POSIX character device file into <code class="docutils literal notranslate"><span class="pre">/dev</span></code>
namespace. It is necessary to open the device to get a file descriptor for
further operations. This can be done with standard POSIX <code class="docutils literal notranslate"><span class="pre">open()</span></code> call.
Only one pir per driver is supported by the peripheral.</p>
<p>Standard POSIX <code class="docutils literal notranslate"><span class="pre">read()</span></code> and <code class="docutils literal notranslate"><span class="pre">write()</span></code> operations are not allowed for GPIO
based drivers. All interface is routed through IOCTL calls. Following commands
are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#c.GPIOC_WRITE" title="GPIOC_WRITE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_WRITE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_READ" title="GPIOC_READ"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_READ</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_PINTYPE" title="GPIOC_PINTYPE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_PINTYPE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_REGISTER" title="GPIOC_REGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_REGISTER</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_UNREGISTER" title="GPIOC_UNREGISTER"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_UNREGISTER</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_SETPINTYPE" title="GPIOC_SETPINTYPE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_SETPINTYPE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_SETDEBOUNCE" title="GPIOC_SETDEBOUNCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_SETDEBOUNCE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.GPIOC_IRQ_SETMASK" title="GPIOC_IRQ_SETMASK"><code class="xref c c-macro docutils literal notranslate"><span class="pre">GPIOC_IRQ_SETMASK</span></code></a></p></li>
</ul>
</div></blockquote>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_WRITE">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_WRITE</span></span></span><a class="headerlink" href="#c.GPIOC_WRITE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_WRITE</span></code> command sets the value of an output GPIO. The argument
is either 0 (set low value) or 1 (set high value). It is possible to write
to output pins only. Typical use case is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">GPIOC_WRITE</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_READ">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_READ</span></span></span><a class="headerlink" href="#c.GPIOC_READ" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_READ</span></code> command reads the value of a GPIO. The argument
is a pointer to a bool value to receive the result. The result is either 0
(low value) or 1 (high value). It is possible to read from both input and
output pins. The currently set value is returned in case the pin is output
pin. Typical use case is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">GPIOC_READ</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)(</span><span class="kt">uintptr_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_PINTYPE">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_PINTYPE</span></span></span><a class="headerlink" href="#c.GPIOC_PINTYPE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_PINTYPE</span></code> command gets the type of GPIO pin. The argument
is a pointer to an instance of type <code class="xref c c-enum docutils literal notranslate"><span class="pre">gpio_pintype_e</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">gpio_pintype_e</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">GPIO_INPUT_PIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="cm">/* float */</span>
<span class="w">  </span><span class="n">GPIO_INPUT_PIN_PULLUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INPUT_PIN_PULLDOWN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_OUTPUT_PIN</span><span class="p">,</span><span class="w"> </span><span class="cm">/* push-pull */</span>
<span class="w">  </span><span class="n">GPIO_OUTPUT_PIN_OPENDRAIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_HIGH_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_LOW_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_RISING_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_FALLING_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_BOTH_PIN</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_HIGH_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_LOW_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_RISING_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_FALLING_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_INTERRUPT_BOTH_PIN_WAKEUP</span><span class="p">,</span>
<span class="w">  </span><span class="n">GPIO_NPINTYPES</span>
<span class="p">};</span>
</pre></div>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_REGISTER">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_REGISTER</span></span></span><a class="headerlink" href="#c.GPIOC_REGISTER" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_REGISTER</span></code> command registers a pin to receive a signal whenever
there is an interrupt received on an input GPIO pin. This feature, of course,
depends upon interrupt GPIO support in the platform specific code. Please
refer to the documentation describing your target platform for further
information. The argument is the pointer to <a class="reference internal" href="../../../reference/user/structures.html#c.sigevent" title="sigevent"><code class="xref c c-type docutils literal notranslate"><span class="pre">sigevent</span></code></a> value, a signal
to be generated when the interrupt occurs.</p>
<p>Typical use case is following:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">sigevent</span><span class="w"> </span><span class="n">notify</span><span class="p">;</span>

<span class="n">notify</span><span class="p">.</span><span class="n">sigev_notify</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SIGEV_SIGNAL</span><span class="p">;</span>
<span class="n">notify</span><span class="p">.</span><span class="n">sigev_signo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SIGUSR1</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">GPIOC_REGISTER</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="o">&amp;</span><span class="n">notify</span><span class="p">);</span>
</pre></div>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_UNREGISTER">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_UNREGISTER</span></span></span><a class="headerlink" href="#c.GPIOC_UNREGISTER" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_UNREGISTER</span></code> command unresigters a pin and stop receiving signals
for pin interrupt.</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_SETPINTYPE">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_SETPINTYPE</span></span></span><a class="headerlink" href="#c.GPIOC_SETPINTYPE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_SETPINTYPE</span></code> command can be used to change the GPIO pin type
(from input pin to output pin, changing interrupt edges and similar). The
types to set are listed in <code class="xref c c-enum docutils literal notranslate"><span class="pre">gpio_pintype_e</span></code>.</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_SETDEBOUNCE">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_SETDEBOUNCE</span></span></span><a class="headerlink" href="#c.GPIOC_SETDEBOUNCE" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_SETDEBOUNCE</span></code> command sets the debounce time for a GPIO input pin.
The argument is a pointer to an integer value, which specifies the debounce time in milliseconds.
This helps to filter out spurious transitions (noise) on the input pin.</p>
<p>Typical use case:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">debounce_ms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">GPIOC_SETDEBOUNCE</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)(</span><span class="kt">uintptr_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">debounce_ms</span><span class="p">);</span>
</pre></div>
</div>
<dl class="c macro">
<dt class="sig sig-object c" id="c.GPIOC_IRQ_SETMASK">
<span class="sig-name descname"><span class="n"><span class="pre">GPIOC_IRQ_SETMASK</span></span></span><a class="headerlink" href="#c.GPIOC_IRQ_SETMASK" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">GPIOC_IRQ_SETMASK</span></code> command sets the interrupt mask for a GPIO pin.
The argument is a pointer to an integer value, which specifies the mask to enable or disable specific interrupt types (such as rising/falling edge, level, etc).
The exact meaning of the mask depends on the platform implementation.</p>
<p>Typical use case:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">irq_mask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* platform-specific mask value */</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">GPIOC_IRQ_SETMASK</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)(</span><span class="kt">uintptr_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">irq_mask</span><span class="p">);</span>
</pre></div>
</div>
<section id="application-example">
<h3>Application Example<a class="headerlink" href="#application-example" title="Permalink to this heading"></a></h3>
<p>An example application can be found in <code class="docutils literal notranslate"><span class="pre">nuttx-apps</span></code> repository under
path <code class="docutils literal notranslate"><span class="pre">examples/gpio</span></code>. It is an example application that allows you
to read, write or configure GPIO pins.</p>
</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>This section describes GPIO driver configuration in <code class="docutils literal notranslate"><span class="pre">Kconfig</span></code>. The reader
should refer to target documentation for target specific configuration.</p>
<p>GPIO peripheral is enabled by <code class="docutils literal notranslate"><span class="pre">CONFIG_DEV_GPIO</span></code>. Option
<code class="docutils literal notranslate"><span class="pre">CONFIG_DEV_NPOLLWAITERS</span></code> is used to specify the maximum number of threads
that can be waiting on poll with default set to one. It is also possible
to register signals with the GPIO driver. The number of allowed signals
is configured with <code class="docutils literal notranslate"><span class="pre">CONFIG_DEV_NSIGNALS</span></code>.</p>
</section>
<section id="io-expander-device-drivers">
<h2>IO Expander Device Drivers<a class="headerlink" href="#io-expander-device-drivers" title="Permalink to this heading"></a></h2>
<p>IO Expander device drivers are chips that provides more GPIO pins, usually
connected to the MCU with SPI or I2C bus. It is possible to register
individual GPIO pins of the expander as a separate pins if needed. This
option is enabled by <code class="docutils literal notranslate"><span class="pre">CONFIG_GPIO_LOWER_HALF</span></code> option. Please refer
to <a class="reference external" href="https://nuttx.apache.org/docs/latest/components/drivers/special/ioexpander.html">ioexpander documentation</a>
for more description.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="efuse.html" class="btn btn-neutral float-left" title="EFUSE Drivers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="i2s.html" class="btn btn-neutral float-right" title="I2S Drivers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>