<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SX126x LoRa driver &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
      <script src="../../../../../_static/jquery.js"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
      <script src="../../../../../_static/doctools.js"></script>
      <script src="../../../../../_static/sphinx_highlight.js"></script>
      <script src="../../../../../_static/clipboard.min.js"></script>
      <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Block Device Drivers" href="../../../block/index.html" />
    <link rel="prev" title="LPWAN" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../../../12.8.0" >12.8.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">OS Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../binfmt.html">Binary Loader</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">Device Drivers</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">Character Device Drivers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../1wire.html">One Wire Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../analog/index.html">Analog (ADC/DAC) Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../bch.html">Block Driver to Character Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../can.html">CAN Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../contactless.html">Constactless Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../crypto/index.html">Crypto Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../efuse.html">EFUSE Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../i2s.html">I2S Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../input/index.html">Input Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ipcc.html">IPCC (Inter Processor Communication Controller) Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../leds/index.html">LEDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../loop.html">Loop Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../math.html">Math Acceleration Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modem.html">Modem Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../motor/index.html">Motor Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../note.html">Note Driver Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../nullzero.html"><code class="docutils literal notranslate"><span class="pre">dev_null.c</span></code> and <code class="docutils literal notranslate"><span class="pre">dev_zero.c</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../quadrature.html">Quadrature Encoder Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rc.html">Remote Control Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../rf.html">RF Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../serial.html">Serial Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../timers/index.html">Timers Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../touchscreen.html">Touchscreen Device Drivers</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">Wireless character drivers</a><ul class="current">
<li class="toctree-l5 current"><a class="reference internal" href="index.html">LPWAN</a></li>
<li class="toctree-l5"><a class="reference internal" href="../index.html#ioctl-interface">IOCTL Interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../block/index.html">Block Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../special/index.html">Specialized Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../thermal/index.html">Thermal Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#lower-half-and-upper-half">Lower-half and upper-half</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#subdirectories-of-nuttx-drivers">Subdirectories of <code class="docutils literal notranslate"><span class="pre">nuttx/drivers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#skeleton-files">Skeleton Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#drivers-early-initialization">Drivers Early Initialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../nxflat.html">NXFLAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../nxgraphics/index.html">NX Graphics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../paging.html">On-Demand Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../audio/index.html">Audio Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../filesystem/index.html">NuttX File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../libs/index.html">NuttX libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../net/index.html">Network Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../syscall.html">Syscall Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tools/index.html"><code class="docutils literal notranslate"><span class="pre">/tools</span></code> Host Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arch/index.html">Architecture-Specific Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../boards.html">Boards Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../cmake.html">CMake Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../openamp.html">OpenAMP Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../video.html">Video Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../crypto.html">Crypto API Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../wireless.html">Wireless Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../logos/index.html">NuttX Logos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">OS Components</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Character Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Wireless character drivers</a></li>
          <li class="breadcrumb-item"><a href="index.html">LPWAN</a></li>
      <li class="breadcrumb-item active">SX126x LoRa driver</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/components/drivers/character/wireless/lpwan/sx126x.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sx126x-lora-driver">
<h1>SX126x LoRa driver<a class="headerlink" href="#sx126x-lora-driver" title="Permalink to this heading"></a></h1>
<p><strong>Currently experimental. Changes can happen in the near future</strong></p>
<section id="short-introduction-sx126x">
<h2>Short introduction SX126x<a class="headerlink" href="#short-introduction-sx126x" title="Permalink to this heading"></a></h2>
<figure class="align-right">
<img alt="../../../../../_images/SX1262.jpg" src="../../../../../_images/SX1262.jpg" />
</figure>
<p>The SX126x is a LoRa chip by Semtech. Sometimes also found in chips with a different name but the same or similar sillicon underneath.
The older variant is the SX127x, even with its higher number. The SX126x series promises to improve the link budget. They also added extra spreading factors.</p>
</section>
<section id="userspace-api">
<h2>Userspace API<a class="headerlink" href="#userspace-api" title="Permalink to this heading"></a></h2>
<p>This driver is controlled as a character device and using IOCTL commands. At the time of writing this 24 February, 2025, there is no common API <strong>yet</strong> for LoRa devices and other RF devices under <code class="docutils literal notranslate"><span class="pre">/lpwan</span></code>.
Currently this driver is controlled using older and driver specific IOCTL commands.</p>
<section id="basic-rf-ioctl">
<h3>Basic RF IOCTL<a class="headerlink" href="#basic-rf-ioctl" title="Permalink to this heading"></a></h3>
<p>See <code class="docutils literal notranslate"><span class="pre">nuttx/wireless/ioctl.h</span></code> : <code class="docutils literal notranslate"><span class="pre">WLIOC_x</span></code> for setting the basic radio parameters such as frequency and power.
Please note that frequency and power may be limited by the lower driver part at board logic.</p>
</section>
<section id="driver-dedicated-ioctl">
<h3>Driver dedicated IOCTL<a class="headerlink" href="#driver-dedicated-ioctl" title="Permalink to this heading"></a></h3>
<p>See <code class="docutils literal notranslate"><span class="pre">nuttx/wireless/lpwan/sx126x.h</span></code> : <code class="docutils literal notranslate"><span class="pre">SX126XIOC_x</span></code> for the commands.</p>
<ul class="simple">
<li><p>The packet type is set using <code class="docutils literal notranslate"><span class="pre">SX126XIOC_PACKETTYPESET</span></code> which takes <code class="docutils literal notranslate"><span class="pre">sx126x_packet_type_e</span></code> enums. <strong>Currently only LoRa packet type is supported.</strong></p></li>
<li><p>LoRa modulation and LoRa packets are configured using <code class="docutils literal notranslate"><span class="pre">SX126XIOC_LORACONFIGSET</span></code> which takes a pointer to a <code class="docutils literal notranslate"><span class="pre">sx126x_lora_config_s</span></code> struct. This struct contains two seperate structures for modulation and packet config. It is recommended to follow the SX126x datasheet at <a class="reference external" href="https://www.semtech.com/products/wireless-rf/lora-connect/sx1262">https://www.semtech.com/products/wireless-rf/lora-connect/sx1262</a> that gives more details about each parameter.</p></li>
</ul>
</section>
<section id="reading-writing">
<h3>Reading / Writing<a class="headerlink" href="#reading-writing" title="Permalink to this heading"></a></h3>
<p>Reading and writing is done with the <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">write</span></code> functions.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">write</span></code> directly transmits the given bytes using the IOCTL configured parameters. <strong>Does not support polling or timeout yet.</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read</span></code> takes a pointer to <code class="docutils literal notranslate"><span class="pre">sx126x_read_header_s</span></code>, which contains information about the received packet. <strong>RSSI and SNR aren’t implemented yet</strong>. <em>Note that packets are always received, even when the CRC (checked using ``.crc_error``) failed.</em></p></li>
</ul>
</section>
</section>
<section id="board-implementation">
<h2>Board implementation<a class="headerlink" href="#board-implementation" title="Permalink to this heading"></a></h2>
<p>The driver can be registered in board logic using <code class="docutils literal notranslate"><span class="pre">sx126x_register</span></code>, which takes an SPI bus, lower driver and the path.
More information about <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sx126x_lower_s</span></code> parameters can be found in detail under <code class="docutils literal notranslate"><span class="pre">nuttx/wireless/lpwan/sx126x.h</span></code> : <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">sx126x_lower_s</span></code>.</p>
<p>This driver supports multiple instances using <code class="docutils literal notranslate"><span class="pre">dev_number</span></code> found in <code class="docutils literal notranslate"><span class="pre">sx126x_lower_s</span></code>. This is done so multiple channels of LoRa can work at the same time.</p>
<p><strong>Do not assign random numbers in get_pa_values. This can damage the device depending on model. Refer to the manual</strong></p>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this heading"></a></h2>
<p>A simple ping-pong test is made to test the device. This code can be used as an example. It is found here <a class="reference external" href="https://pastebin.com/71CdKZvm">https://pastebin.com/71CdKZvm</a>
It takes the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-f</span></code> sets frequency in hz. The range is board depended.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-b</span></code> sets the bandwidth in kHz and automatically selects the closest sx126x supported bandwidth.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-s</span></code> sets the spreading factor between 5 and 12.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code> sets the power in dBm. The range is board depended. Also PA setting depended.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-t</span></code> perform transmit. Transmit the following bytes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-r</span></code> perform receive. Receives and print.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-x</span></code> perform transmit and receive. Transmits following bytes and attempts to receives immidiately. To be used with <code class="docutils literal notranslate"><span class="pre">-e</span></code> echo</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-e</span></code> perform echo. Listen and repeat.</p></li>
</ul>
<figure class="align-center">
<img alt="Running sx126x -f 869250000 -b 250 -s 10 -p 22 -x &quot;HELLO&quot;" src="../../../../../_images/command_run0.jpg" />
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="LPWAN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../block/index.html" class="btn btn-neutral float-right" title="Block Device Drivers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>