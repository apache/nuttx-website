<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inotify &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
      <script src="../../_static/clipboard.min.js"></script>
      <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="NuttX libraries" href="../libs/index.html" />
    <link rel="prev" title="ZipFS" href="zipfs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../latest" selected="selected">latest</option>
    
    <option value="../../../10.0.0" >10.0.0</option>
    
    <option value="../../../10.0.1" >10.0.1</option>
    
    <option value="../../../10.1.0" >10.1.0</option>
    
    <option value="../../../10.2.0" >10.2.0</option>
    
    <option value="../../../10.3.0" >10.3.0</option>
    
    <option value="../../../11.0.0" >11.0.0</option>
    
    <option value="../../../12.0.0" >12.0.0</option>
    
    <option value="../../../12.1.0" >12.1.0</option>
    
    <option value="../../../12.2.0" >12.2.0</option>
    
    <option value="../../../12.2.1" >12.2.1</option>
    
    <option value="../../../12.3.0" >12.3.0</option>
    
    <option value="../../../12.4.0" >12.4.0</option>
    
    <option value="../../../12.5.0" >12.5.0</option>
    
    <option value="../../../12.5.1" >12.5.1</option>
    
    <option value="../../../12.6.0" >12.6.0</option>
    
    <option value="../../../12.7.0" >12.7.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">OS Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../binfmt.html">Binary Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drivers/index.html">Device Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nxflat.html">NXFLAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nxgraphics/index.html">NX Graphics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paging.html">On-Demand Paging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/index.html">Audio Subsystem</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">NuttX File System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#virtual-file-system-vfs">Virtual File System (VFS)</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#file-systems">File systems</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="aio.html">Asynchronous I/O support</a></li>
<li class="toctree-l4"><a class="reference internal" href="binfs.html">BINFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="cromfs.html">CROMFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="fat.html">FAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="hostfs.html">Host File System</a></li>
<li class="toctree-l4"><a class="reference internal" href="littlefs.html">LITTLEFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="mmap.html">File mapping emulation (mmap)</a></li>
<li class="toctree-l4"><a class="reference internal" href="mnemofs.html">MNEMOFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="nfs.html">NFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="nxffs.html">NXFFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="partition.html">Partition Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="procfs.html">PROCFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="romfs.html">ROMFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpmsgfs.html">RPMSG File System</a></li>
<li class="toctree-l4"><a class="reference internal" href="smartfs.html">SMARTFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="shmfs.html">Shared Memory File System</a></li>
<li class="toctree-l4"><a class="reference internal" href="spiffs.html">SPIFFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="tmpfs.html">TMPFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="unionfs.html">Union File System</a></li>
<li class="toctree-l4"><a class="reference internal" href="userfs.html">User file system</a></li>
<li class="toctree-l4"><a class="reference internal" href="zipfs.html">ZipFS</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Inotify</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#config">CONFIG</a></li>
<li class="toctree-l5"><a class="reference internal" href="#user-space-api">User Space API</a></li>
<li class="toctree-l5"><a class="reference internal" href="#reading-events-from-an-inotify-file-descriptor">Reading events from an inotify file descriptor</a></li>
<li class="toctree-l5"><a class="reference internal" href="#inotify-events">inotify events</a></li>
<li class="toctree-l5"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l5"><a class="reference internal" href="#note">NOTE</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="index.html#fs-categories">FS Categories</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../libs/index.html">NuttX libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../net/index.html">Network Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syscall.html">Syscall Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/index.html"><code class="docutils literal notranslate"><span class="pre">/tools</span></code> Host Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../arch/index.html">Architecture-Specific Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../boards.html">Boards Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmake.html">CMake Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openamp.html">OpenAMP Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../video.html">Video Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto.html">Crypto API Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wireless.html">Wireless Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logos/index.html">NuttX Logos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">OS Components</a></li>
          <li class="breadcrumb-item"><a href="index.html">NuttX File System</a></li>
      <li class="breadcrumb-item active">Inotify</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/components/filesystem/inotify.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="inotify">
<h1>Inotify<a class="headerlink" href="#inotify" title="Permalink to this heading"></a></h1>
<p>Inotify is a kernel subsystem designed for monitoring filesystem events. It enables applications to monitor changes to files and directories in real-time, such as creation, deletion, modification, renaming, and more. inotify offers an efficient way to detect changes in the filesystem without the need for polling, thereby conserving system resources.</p>
<section id="config">
<h2>CONFIG<a class="headerlink" href="#config" title="Permalink to this heading"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">COFNIG_FS_NOTIFY</span><span class="o">=</span><span class="n">y</span>
</pre></div>
</div>
</section>
<section id="user-space-api">
<h2>User Space API<a class="headerlink" href="#user-space-api" title="Permalink to this heading"></a></h2>
<p>All inotify user interfaces are declared in the file <code class="docutils literal notranslate"><span class="pre">include/sys/inotify.h</span></code>.
And the usage is consistent with the Linux version.</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.inotify_init">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inotify_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.inotify_init" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes a new inotify instance and returns a file descriptor
associated with a new inotify event queue.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.inotify_init1">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inotify_init1</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.inotify_init1" title="Permalink to this definition"></a><br /></dt>
<dd><p>inotify_init1 is an extended version of inotify_init, offering additional
options for initializing an inotify instance. Unlike inotify_init,
inotify_init1 allows you to specify certain flags to control the behavior of
the inotify instance.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.inotify_add_watch">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inotify_add_watch</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">fd</span></span>, <span class="pre">FAR</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pathname</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">mask</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.inotify_add_watch" title="Permalink to this definition"></a><br /></dt>
<dd><p>Add a new watch, or modifies an existing watch, for the file whose
location is specified in pathname; the caller must have read permission
for this file. The fd argument is a file descriptor referring to the
inotify instance whose watch list is to be modified. The events to be
monitored for pathname are specified in the mask bit-mask argument.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.inotify_rm_watch">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inotify_rm_watch</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">fd</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">wd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.inotify_rm_watch" title="Permalink to this definition"></a><br /></dt>
<dd><p>Removes the watch associated with the watch descriptor wd from the
inotify instance associated with the file descriptor fd.</p>
</dd></dl>

</section>
<section id="reading-events-from-an-inotify-file-descriptor">
<h2>Reading events from an inotify file descriptor<a class="headerlink" href="#reading-events-from-an-inotify-file-descriptor" title="Permalink to this heading"></a></h2>
<p>To  determine  what  events have occurred, an application read from
the inotify file descriptor.  If no events have so far occurred,  then,
assuming  a blocking file descriptor, read will block until at least
one event occurs</p>
<p>Each  successful read returns a buffer containing one or more of the
following structures:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">inotify_event</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w">      </span><span class="n">wd</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Watch descriptor */</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">mask</span><span class="p">;</span><span class="w">     </span><span class="cm">/* Mask describing event */</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">cookie</span><span class="p">;</span><span class="w">   </span><span class="cm">/* Unique cookie associating related</span>
<span class="cm">                       events (for rename(2)) */</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w">      </span><span class="cm">/* Size of name field */</span>
<span class="w">  </span><span class="kt">char</span><span class="w">     </span><span class="n">name</span><span class="p">[];</span><span class="w">   </span><span class="cm">/* Optional null-terminated name */</span>
<span class="p">};</span>
</pre></div>
</div>
<p><strong>wd</strong> identifies the watch for which this event occurs.  It is one of  the
watch descriptors returned by a previous call to inotify_add_watch.</p>
<p><strong>mask</strong> contains bits that describe the event that occurred</p>
<p><strong>cookie</strong> is a unique integer that connects related events.  Currently,
this is used only for rename events, and allows the resulting  pair  of
IN_MOVED_FROM  and  IN_MOVED_TO  events to be connected by the application
For all other event types, cookie is set to 0.</p>
<p>The <strong>name</strong> field is present only when an event is returned for a file
inside a watched directory; it identifies the filename within the watched
directory.  This filename is null-terminated, and may  include  further
null  bytes  (’0’)  to  align  subsequent  reads to a suitable address boundary.</p>
<p>The <strong>len</strong> field counts all of the  bytes in name, including the null
bytes; the length of each inotify_event structure is thus sizeof(struct
inotify_event)+len.</p>
</section>
<section id="inotify-events">
<h2>inotify events<a class="headerlink" href="#inotify-events" title="Permalink to this heading"></a></h2>
<p>The <strong>inotify_add_watch</strong> mask argument and the mask field of the inotify_event
structure returned when reading an inotify file  descriptor are both bit masks
identifying inotify events.  The following bits can be specified in mask when
calling inotify_add_watch and  may  be returned in the mask field returned by read.</p>
<blockquote>
<div><p><strong>IN_ACCESS</strong> :File was accessed</p>
<p><strong>IN_MODIFY</strong> :File was modified (<code class="docutils literal notranslate"><span class="pre">write()</span></code> or <code class="docutils literal notranslate"><span class="pre">truncate()</span></code>)</p>
<p><strong>IN_ATTRIB</strong> :Metadata changed</p>
<p><strong>IN_OPEN</strong> :File was opened</p>
<p><strong>IN_CLOSE_WRITE</strong> :File opened for writing was closed</p>
<p><strong>IN_CLOSE_NOWRITE</strong> : File not opened for writing was closed</p>
<p><strong>IN_MOVED_FROM</strong> :File was moved from X</p>
<p><strong>IN_MOVED_TO</strong> :File was moved to Y</p>
<p><strong>IN_CREATE</strong> :Subfile was created</p>
<p><strong>IN_DELETE</strong> :Subfile was deleted</p>
<p><strong>IN_DELETE_SELF</strong> :Self was deleted</p>
<p><strong>IN_MOVE_SELF</strong> :Self was moved</p>
</div></blockquote>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>Suppose  an  application  is  watching  the  directory <code class="docutils literal notranslate"><span class="pre">dir</span></code> and the file
<code class="docutils literal notranslate"><span class="pre">dir/myfile</span></code> for all events.  The examples below show  some  events  that
will be generated for these two objects.</p>
<blockquote>
<div><dl class="simple">
<dt>fd = open(“dir/myfile”, O_RDWR);</dt><dd><p>Generates <strong>IN_OPEN</strong> events for both <code class="docutils literal notranslate"><span class="pre">dir</span></code> and <code class="docutils literal notranslate"><span class="pre">dir/myfile</span></code>.</p>
</dd>
<dt>read(fd, buf, count);</dt><dd><p>Generates <strong>IN_ACCESS</strong> events for both <code class="docutils literal notranslate"><span class="pre">dir</span></code> and <code class="docutils literal notranslate"><span class="pre">dir/myfile</span></code>.</p>
</dd>
<dt>write(fd, buf, count);</dt><dd><p>Generates <strong>IN_MODIFY</strong> events for both <code class="docutils literal notranslate"><span class="pre">dir</span></code> and <code class="docutils literal notranslate"><span class="pre">dir/myfile</span></code>.</p>
</dd>
<dt>fchmod(fd, mode);</dt><dd><p>Generates <strong>IN_ATTRIB</strong> events for both <code class="docutils literal notranslate"><span class="pre">dir</span></code> and <code class="docutils literal notranslate"><span class="pre">dir/myfile</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="note">
<h2>NOTE<a class="headerlink" href="#note" title="Permalink to this heading"></a></h2>
<p>Inotify file descriptors can be monitored using select, poll, and
epoll.  When an event is available, the file descriptor indicates as
readable.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="zipfs.html" class="btn btn-neutral float-left" title="ZipFS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../libs/index.html" class="btn btn-neutral float-right" title="NuttX libraries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>