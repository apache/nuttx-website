<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NuttX Unit Test Selection (NUTS) &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
      <script src="../../../_static/doctools.js"></script>
      <script src="../../../_static/sphinx_highlight.js"></script>
      <script src="../../../_static/clipboard.min.js"></script>
      <script src="../../../_static/copybutton.js"></script>
      <script src="../../../_static/design-tabs.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Devices Category (NUTS)" href="devices.html" />
    <link rel="prev" title="nist-sts NIST Statistical Test Suite" href="../nist-sts/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../12.5.1" >12.5.1</option>
    
    <option value="../../../../12.6.0" >12.6.0</option>
    
    <option value="../../../../12.7.0" >12.7.0</option>
    
    <option value="../../../../12.8.0" >12.8.0</option>
    
    <option value="../../../../12.9.0" >12.9.0</option>
    
    <option value="../../../../12.10.0" >12.10.0</option>
    
    <option value="../../../../12.11.0" >12.11.0</option>
    
    <option value="../../../../12.12.0" >12.12.0</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../components/index.html">OS Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../audioutils/index.html">Audio Utility libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../boot/index.html">Bootloader Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../benchmarks/index.html">Benchmark Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../canutils/index.html">CAN Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto/index.html">Cryptography Library Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fsutils/index.html">File System Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../games/index.html">Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../graphics/index.html">Graphics Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../industry/index.html">Industrial Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../inertial/index.html">Inertial Libraries Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interpreters/index.html">Interpreters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/index.html">Logging Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lte/index.html">LTE Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/index.html">Math Library Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mlearing/index.html">Machine Learning Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../netutils/index.html">Network Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nsh/index.html">NuttShell (NSH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdr/index.html">Software Defined Radio Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../system/index.html">System Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Testing</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../arch_libc/index.html"><code class="docutils literal notranslate"><span class="pre">arch_libc</span></code> Arch-specific libc Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../atomic/index.html"><code class="docutils literal notranslate"><span class="pre">atomic</span></code> “Test atomic” testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../batterydump/index.html"><code class="docutils literal notranslate"><span class="pre">batterydump</span></code> Battery dump for test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cmocka/index.html"><code class="docutils literal notranslate"><span class="pre">cmocka</span></code> libcmocka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpuload/index.html"><code class="docutils literal notranslate"><span class="pre">cpuload</span></code> cpuload test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crypto/index.html"><code class="docutils literal notranslate"><span class="pre">crypto</span></code> crypto test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cxx-oot-build/index.html"><code class="docutils literal notranslate"><span class="pre">cxx-oot-build</span></code> Out-of-Tree Build Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cxxtest/index.html"><code class="docutils literal notranslate"><span class="pre">cxxtest</span></code> C++ test program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../drivertest/index.html"><code class="docutils literal notranslate"><span class="pre">drivertest</span></code> cmocka driver test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fatutf8/index.html"><code class="docutils literal notranslate"><span class="pre">fatutf8</span></code> FAT UTF8 test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fdsantest/index.html"><code class="docutils literal notranslate"><span class="pre">fdsantest</span></code> vela cmocka fdsan test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fmemopen/index.html"><code class="docutils literal notranslate"><span class="pre">fmemopen</span></code> - fmemopen test tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fopencookie/index.html"><code class="docutils literal notranslate"><span class="pre">fopencookie</span></code> fopencookie test tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fstest/index.html"><code class="docutils literal notranslate"><span class="pre">fstest</span></code> Generic file system test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getprime/index.html"><code class="docutils literal notranslate"><span class="pre">getprime</span></code> benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../irtest/index.html"><code class="docutils literal notranslate"><span class="pre">irtest</span></code> IR driver test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lpt/index.html"><code class="docutils literal notranslate"><span class="pre">ltp</span></code> Linux Test Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../memstress/index.html"><code class="docutils literal notranslate"><span class="pre">memstress</span></code> memory stress test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../memtester/index.html"><code class="docutils literal notranslate"><span class="pre">memtester</span></code> utils_memtester</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mm/index.html"><code class="docutils literal notranslate"><span class="pre">mm</span></code> Memory management test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monkey/index.html"><code class="docutils literal notranslate"><span class="pre">monkey</span></code> Monkey test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mtd_config_fs/index.html"><code class="docutils literal notranslate"><span class="pre">mtd_nvs</span></code> MTD non-volatile storage Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nand_sim/index.html"><code class="docutils literal notranslate"><span class="pre">nand</span></code> - NAND Flash Device Simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nettest/index.html">Net Test Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nist-sts/index.html"><code class="docutils literal notranslate"><span class="pre">nist-sts</span></code> NIST Statistical Test Suite</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">NuttX Unit Test Selection (NUTS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#building-deploying">Building &amp; Deploying</a></li>
<li class="toctree-l4"><a class="reference internal" href="#included-tests">Included Tests</a><ul>
<li class="toctree-l5"><a class="reference internal" href="devices.html">Devices Category (NUTS)</a></li>
<li class="toctree-l5"><a class="reference internal" href="dstructs.html">Data Structures Category (NUTS)</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#test-cases">Test Cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-new-tests">Adding New Tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nxfss/index.html"><code class="docutils literal notranslate"><span class="pre">nxffs</span></code> NXFFS file system example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../open_memstream/index.html"><code class="docutils literal notranslate"><span class="pre">open_memstream</span></code> - open_memstream test tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ostest/index.html"><code class="docutils literal notranslate"><span class="pre">ostest</span></code> OS test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pthread_mutex_perf/index.html">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ramtest/index.html"><code class="docutils literal notranslate"><span class="pre">ramtest</span></code> RAM Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scanftest/index.html"><code class="docutils literal notranslate"><span class="pre">scanftest</span></code> sscanf() test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sd_bench/index.html"><code class="docutils literal notranslate"><span class="pre">sd_bench</span></code> SD card or mount point bench test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sd_stress/index.html"><code class="docutils literal notranslate"><span class="pre">sd_stress</span></code> SD card or mount point stress test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sensortest/index.html"><code class="docutils literal notranslate"><span class="pre">sensortest</span></code> Sensor driver test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setest/index.html"><code class="docutils literal notranslate"><span class="pre">setest</span></code> Secure Element driver test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../smart/index.html"><code class="docutils literal notranslate"><span class="pre">smart</span></code> SMART File System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../smart_test/index.html"><code class="docutils literal notranslate"><span class="pre">smart_test</span></code> SMART File System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../smp/index.html"><code class="docutils literal notranslate"><span class="pre">smp</span></code> SMP example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../uclibcxx_test/index.html"><code class="docutils literal notranslate"><span class="pre">uclibcxx_test</span></code> uclibcxx test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unity/index.html"><code class="docutils literal notranslate"><span class="pre">unity</span></code> Unity testing framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/index.html">Host Side Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wireless/index.html">Wireless Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../standards/index.html">Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logos/index.html">NuttX Logos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../_tags/tagsindex.html">Tags</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Applications</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Testing</a></li>
      <li class="breadcrumb-item active">NuttX Unit Test Selection (NUTS)</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/apache/nuttx/blob/master/Documentation/applications/testing/nuts/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nuttx-unit-test-selection-nuts">
<h1>NuttX Unit Test Selection (NUTS)<a class="headerlink" href="#nuttx-unit-test-selection-nuts" title="Permalink to this heading"></a></h1>
<p>NUTS is a selection of unit test suites that can be compiled and run on NuttX
devices to verify correct operation of the OS APIs. NUTS depends on the
<a class="reference internal" href="../cmocka/index.html"><span class="doc">cmocka</span></a> testing framework in order to
run the unit tests.</p>
<section id="building-deploying">
<h2>Building &amp; Deploying<a class="headerlink" href="#building-deploying" title="Permalink to this heading"></a></h2>
<p>In order to build and deploy NUTS on your target device, you will need to enable
the cmocka library and <code class="docutils literal notranslate"><span class="pre">CONFIG_TESTING_NUTS</span></code>. Once NUTS is enabled, you will
see a list of available test categories in Kconfig. You may enable the test
categories that you want to run tests for.</p>
<p>Once a test category is enabled, you will have access to toggles for each test
group within the category. For example, if you enable the ‘devices’ category,
you will then be able to choose if you want to include the tests for
<code class="docutils literal notranslate"><span class="pre">/dev/zero</span></code> or <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>, etc. By default, all test groups within a
category are enabled and must be opted-out of by disabling their toggle.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some individual tests may have specific dependencies which need to be enabled
first, so do not assume that the visible list of tests in Kconfig is the
complete selection (unless you have enabled showing hidden options in
Kconfig). For example, <code class="docutils literal notranslate"><span class="pre">/dev/urandom</span></code> depends on <cite>CONFIG_DEV_URANDOM</cite> to be
enabled, and will not show in the menu unless the dependency is selected.</p>
</div>
<p>Once built and deployed to the target, you can use the following command to
see your test results (example of running <code class="docutils literal notranslate"><span class="pre">/dev/zero</span></code> tests only):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nsh&gt; nuts</span>
<span class="go">[==========] /dev/zero: Running 8 test(s).</span>
<span class="go">[ RUN      ] open_rdonly</span>
<span class="go">[       OK ] open_rdonly</span>
<span class="go">[ RUN      ] open_rdwr</span>
<span class="go">[       OK ] open_rdwr</span>
<span class="go">[ RUN      ] open_wronly</span>
<span class="go">[       OK ] open_wronly</span>
<span class="go">[ RUN      ] readzero</span>
<span class="go">[       OK ] readzero</span>
<span class="go">[ RUN      ] readlarge</span>
<span class="go">[       OK ] readlarge</span>
<span class="go">[ RUN      ] writezero</span>
<span class="go">[       OK ] writezero</span>
<span class="go">[ RUN      ] writelarge</span>
<span class="go">[       OK ] writelarge</span>
<span class="go">[ RUN      ] wrrd</span>
<span class="go">[       OK ] wrrd</span>
<span class="go">[==========] /dev/zero: 8 test(s) run.</span>
<span class="go">[  PASSED  ] 8 test(s).</span>
</pre></div>
</div>
</section>
<section id="included-tests">
<h2>Included Tests<a class="headerlink" href="#included-tests" title="Permalink to this heading"></a></h2>
<p>NUTS tests are split into categories. Within each category there are test
groups/suites which contain all of the individual test cases related to a
specific API.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Test categories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="devices.html">Devices Category (NUTS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dstructs.html">Data Structures Category (NUTS)</a></li>
</ul>
</div>
</section>
<section id="test-cases">
<h2>Test Cases<a class="headerlink" href="#test-cases" title="Permalink to this heading"></a></h2>
<p>The output of NUTS displays the pass/fail/skip results of each test case that
has been included in the build. Although the names of the test cases are
intended to describe what the test case is verifying, sometimes more information
is needed. Each test case in NUTS has a corresponding source-code
comment/docstring which includes a description of what the test is verifying.
You can also determine more information by looking at the assertion statements
within the test itself.</p>
</section>
<section id="adding-new-tests">
<h2>Adding New Tests<a class="headerlink" href="#adding-new-tests" title="Permalink to this heading"></a></h2>
<p>In order to add new tests, first take a look at the <a class="reference internal" href="../cmocka/index.html"><span class="doc">cmocka</span></a> API documentation.</p>
<p>Then, you should add a new <code class="docutils literal notranslate"><span class="pre">.c</span></code> file under the category that you wish to
extend. All of the test cases are static functions that take a <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">**state</span></code>
in order to pass in context from a setup function. Each test case function
should have a docstring comment which describes what the particular test case is
testing (and the name should be as descriptive as possible). Setup and teardown
functions must start with <code class="docutils literal notranslate"><span class="pre">setup_</span></code> and <code class="docutils literal notranslate"><span class="pre">teardown_</span></code> respectively, where the
suffix is a descriptive name about what is being set up/torn down.</p>
<p>An example of a test case taken from the circular buffer test suite is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">setup_empty_cbuf</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">state</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="o">*</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">g_cbuf</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">circbuf_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">g_cbuf</span><span class="p">,</span><span class="w"> </span><span class="n">g_buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">g_buf</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">teardown_cbuf</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">state</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">circbuf_uninit</span><span class="p">(</span><span class="o">*</span><span class="n">state</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">circbuf_is_init</span><span class="p">(</span><span class="o">*</span><span class="n">state</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/****************************************************************************</span>
<span class="cm"> * Name: empty_postinit</span>
<span class="cm"> *</span>
<span class="cm"> * Description:</span>
<span class="cm"> *   Tests that a circular buffer is empty right after being initialized.</span>
<span class="cm"> ****************************************************************************/</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">empty_postinit</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">**</span><span class="n">state</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">circbuf_s</span><span class="w"> </span><span class="o">*</span><span class="n">cbuf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">state</span><span class="p">;</span>

<span class="w">  </span><span class="n">assert_true</span><span class="p">(</span><span class="n">circbuf_is_empty</span><span class="p">(</span><span class="n">cbuf</span><span class="p">));</span>
<span class="w">  </span><span class="n">assert_false</span><span class="p">(</span><span class="n">circbuf_is_full</span><span class="p">(</span><span class="n">cbuf</span><span class="p">));</span>
<span class="w">  </span><span class="n">assert_uint_equal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">circbuf_used</span><span class="p">(</span><span class="n">cbuf</span><span class="p">));</span>
<span class="w">  </span><span class="n">assert_uint_equal</span><span class="p">(</span><span class="n">CBUF_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">circbuf_space</span><span class="p">(</span><span class="n">cbuf</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each test group must implement a public function for running all of the test
cases, following the convention:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">nuts_category_group</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">CMUnitTests</span><span class="w"> </span><span class="n">tests</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">cmocka_unit_test</span><span class="p">(</span><span class="n">this_is_test_one</span><span class="p">),</span>
<span class="w">    </span><span class="n">cmocka_unit_test_setup_teardown</span><span class="p">(</span><span class="n">this_is_test_two</span><span class="p">,</span><span class="w"> </span><span class="n">setup_func</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">teardown_func</span><span class="p">),</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">cmocka_run_group_tests_name</span><span class="p">(</span><span class="s">&quot;group name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where ‘category’ is the name of the test category, and ‘group’ is the name of
the test group (i.e. category of ‘devices’ and group of ‘devnull’).</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">tests.h</span></code> header file for the category, include the following under
the public function prototypes:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef CONFIG_TESTING_NUTS_CATEGORY_GROUP</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">nuts_category_group</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cp">#define nuts_category_group()</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_TESTING_NUTS_CATEGORY_GROUP */</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">CONFIG_TESTING_NUTS_CATEGORY_GROUP</span></code> is the Kconfig option to toggle
on/off the test group. You will have to add this to the NUTS Kconfig file.</p>
<p>In order to reduce the amount of special switches in the
<code class="docutils literal notranslate"><span class="pre">Makefile</span></code>/<code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> files, all source files in each category
directory are included with a wild card. Thus, to avoid compiling unselected
test groups, each test group’s C file should be surrounded in the gaurd:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef CONFIG_TESTING_NUTS_CATEGORY_GROUP</span>

<span class="cm">/* ... your test cases and public test runner function ... */</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_TESTING_NUTS_CATEGORY_GROUP */</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../nist-sts/index.html" class="btn btn-neutral float-left" title="nist-sts NIST Statistical Test Suite" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="devices.html" class="btn btn-neutral float-right" title="Devices Category (NUTS)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>