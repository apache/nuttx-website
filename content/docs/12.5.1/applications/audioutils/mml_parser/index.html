<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mml_parser Music Macro Language (MML) Parser library &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="nxaudio NX Audio Library" href="../nxaudio/index.html" />
    <link rel="prev" title="fmsynth FM Synthesizer Library" href="../fmsynt/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../12.5.1" >12.5.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../components/index.html">OS Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Applications</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Audio Utility libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../fmsynt/index.html"><code class="docutils literal notranslate"><span class="pre">fmsynth</span></code> FM Synthesizer Library</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">mml_parser</span></code> Music Macro Language (MML) Parser library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#supported-syntax-on-this-library">Supported Syntax on this library</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sharp-and-flat">Sharp and Flat</a></li>
<li class="toctree-l5"><a class="reference internal" href="#length">Length</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rest">Rest</a></li>
<li class="toctree-l5"><a class="reference internal" href="#chord">Chord</a></li>
<li class="toctree-l5"><a class="reference internal" href="#tuplet">Tuplet</a></li>
<li class="toctree-l5"><a class="reference internal" href="#octave">Octave</a></li>
<li class="toctree-l5"><a class="reference internal" href="#tempo">Tempo</a></li>
<li class="toctree-l5"><a class="reference internal" href="#volume">Volume</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#example-of-a-score">Example of a score</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#the-beginning-of-the-do-re-mi-song">The beginning of the Do Re Mi Song</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#provided-c-functions">Provided C Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#init-mml">init_mml()</a></li>
<li class="toctree-l5"><a class="reference internal" href="#parse-mml">parse_mml()</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#running-unit-tests">Running unit tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bugs">Bugs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#author">Author</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nxaudio/index.html"><code class="docutils literal notranslate"><span class="pre">nxaudio</span></code> NX Audio Library</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../boot/index.html">Bootloader Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../benchmarks/index.html">Benchmark Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../canutils/index.html">CAN Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto/index.html">Cryptography Library Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fsutils/index.html">File System Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../games/index.html">Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../graphics/index.html">Graphics Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../industry/index.html">Industrial Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../inertial/index.html">Inertial Libraries Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interpreters/index.html">Interpreters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/index.html">Logging Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lte/index.html">LTE Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/index.html">Math Library Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mlearing/index.html">Machine Learning Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../netutils/index.html">Network Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nsh/index.html">NuttShell (NSH)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdr/index.html">Software Define Radio Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../system/index.html">System Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../testing/index.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/index.html">Host Side Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wireless/index.html">Wireless Libraries and NSH Add-Ons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Applications</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Audio Utility libraries</a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">mml_parser</span></code> Music Macro Language (MML) Parser library</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/applications/audioutils/mml_parser/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mml-parser-music-macro-language-mml-parser-library">
<h1><code class="docutils literal notranslate"><span class="pre">mml_parser</span></code> Music Macro Language (MML) Parser library<a class="headerlink" href="#mml-parser-music-macro-language-mml-parser-library" title="Permalink to this heading"></a></h1>
<p>MML has often been used as a language for describing music in strings, for example,
in the BASIC language. The mml_parser is a minimalistic Music Macro Language parser
library written in pure C intended for resource-constrained platforms, especially
microcontrollers and other embedded systems.</p>
<section id="supported-syntax-on-this-library">
<h2>Supported Syntax on this library<a class="headerlink" href="#supported-syntax-on-this-library" title="Permalink to this heading"></a></h2>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>C</strong> (Do)</p></li>
<li><p><strong>D</strong> (Re)</p></li>
<li><p><strong>E</strong> (Mi)</p></li>
<li><p><strong>F</strong> (Fa)</p></li>
<li><p><strong>G</strong> (Sol)</p></li>
<li><p><strong>A</strong> (La)</p></li>
<li><p><strong>B</strong> (Ti)</p></li>
</ul>
</section>
<section id="sharp-and-flat">
<h3>Sharp and Flat<a class="headerlink" href="#sharp-and-flat" title="Permalink to this heading"></a></h3>
<p>Add “#” or “+” after the note indicates Sharp. ex: <code class="docutils literal notranslate"><span class="pre">&quot;C#&quot;</span></code> <code class="docutils literal notranslate"><span class="pre">&quot;C+.&quot;</span></code>
Add “-” after the note indicates Flat. ex: <code class="docutils literal notranslate"><span class="pre">&quot;C-&quot;</span></code></p>
</section>
<section id="length">
<h3>Length<a class="headerlink" href="#length" title="Permalink to this heading"></a></h3>
<p>Length of the tone can be specified in two ways.
One is to specify a length for each note. Add a number after the note in 1, 2, 4, 8, 16, 32 or 64.
ex: <code class="docutils literal notranslate"><span class="pre">&quot;C8</span> <span class="pre">C16</span> <span class="pre">C#4.&quot;</span></code></p>
<p>The other is to use <code class="docutils literal notranslate"><span class="pre">L</span></code> . The <code class="docutils literal notranslate"><span class="pre">L</span></code> sets default length. If the note without length, the number which is
indicated by the “L” is used.  The number followed after the “L” can be in 1, 2, 4, 8, 16, 32 or 64.
ex: <code class="docutils literal notranslate"><span class="pre">&quot;L4</span> <span class="pre">A&quot;</span></code> means “A” with length 4.</p>
<p>In addition, dot is supported. For example, length of “C4.” is 4 + 8. Length of “C16..” is 4 + 8 + 16.</p>
</section>
<section id="rest">
<h3>Rest<a class="headerlink" href="#rest" title="Permalink to this heading"></a></h3>
<p>Rest is represented by “R”.
Length of the rest is following after the “R” as the same as the note length.  If no length is
specified, the length specified by the ”L” is used.</p>
</section>
<section id="chord">
<h3>Chord<a class="headerlink" href="#chord" title="Permalink to this heading"></a></h3>
<p>Chord is supported. If some notes are enclosed in parentheses by <code class="docutils literal notranslate"><span class="pre">[</span></code> and <code class="docutils literal notranslate"><span class="pre">]</span></code>, they are interpreted as
a chord. ex: <code class="docutils literal notranslate"><span class="pre">&quot;[CEG]&quot;</span></code> is a chord of Do, Mi and Sol.
Chord’s length can be put after <code class="docutils literal notranslate"><span class="pre">]</span></code> . ex: <code class="docutils literal notranslate"><span class="pre">&quot;[CEG]4&quot;</span></code> is a chord with 4 length.</p>
<p>Note: Max notes in a chord is defined as MAX_CHORD_NOTES in <code class="docutils literal notranslate"><span class="pre">mml_parser.h</span></code>.</p>
</section>
<section id="tuplet">
<h3>Tuplet<a class="headerlink" href="#tuplet" title="Permalink to this heading"></a></h3>
<p>Tuplet is supported. If some notes and Chord are enclosed in parentheses by <code class="docutils literal notranslate"><span class="pre">{</span></code> and <code class="docutils literal notranslate"><span class="pre">}</span></code>, they are
interpreted as a tuplet. ex: <code class="docutils literal notranslate"><span class="pre">&quot;{C</span> <span class="pre">E</span> <span class="pre">G</span> <span class="pre">[CEG]}&quot;</span></code> is a tuplet with C, E, G and chord of CEG.
Tuplet’s length can be put after “}”, and the length is divided equally among each note.
ex: in <code class="docutils literal notranslate"><span class="pre">&quot;{C</span> <span class="pre">E</span> <span class="pre">G</span> <span class="pre">[CEG]}4&quot;</span></code> case, C, E, G and chord CEG has each a quarter of the L4 length.</p>
</section>
<section id="octave">
<h3>Octave<a class="headerlink" href="#octave" title="Permalink to this heading"></a></h3>
<p>Octarve is controlled by “O”, “&gt;” or “&lt;”.
When “O” is used, the O is followed by a number indicating the octave.
When “&gt;” is used, the value of the new octave is the current octave plus one.
When “&lt;” is used, the value of the new octave is the current octave minus one.
ex: <code class="docutils literal notranslate"><span class="pre">&quot;CDEFGAB</span> <span class="pre">&gt;</span> <span class="pre">C</span> <span class="pre">R</span> <span class="pre">C</span> <span class="pre">&lt;</span> <span class="pre">BAGFEDC&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;O4</span> <span class="pre">CDEFGAB</span> <span class="pre">O5</span> <span class="pre">C</span> <span class="pre">R</span> <span class="pre">C</span> <span class="pre">O4</span> <span class="pre">BAGFEDC&quot;</span></code></p>
</section>
<section id="tempo">
<h3>Tempo<a class="headerlink" href="#tempo" title="Permalink to this heading"></a></h3>
<p>Tempo is indicated as “T” and numter following after the “T”.
Tempo number decide a speed of the score. This value is used for culculating sample number for
the note (or rest).
ex: <code class="docutils literal notranslate"><span class="pre">&quot;T120&quot;</span></code></p>
</section>
<section id="volume">
<h3>Volume<a class="headerlink" href="#volume" title="Permalink to this heading"></a></h3>
<p>Volume can be controlled by “V”. And numter following after the “V”.
ex: <code class="docutils literal notranslate"><span class="pre">&quot;V4&quot;</span></code></p>
</section>
</section>
<section id="example-of-a-score">
<h2>Example of a score<a class="headerlink" href="#example-of-a-score" title="Permalink to this heading"></a></h2>
<section id="the-beginning-of-the-do-re-mi-song">
<h3>The beginning of the Do Re Mi Song<a class="headerlink" href="#the-beginning-of-the-do-re-mi-song" title="Permalink to this heading"></a></h3>
<p>Tempo 120, Voulume 10, Octave 4, Default length is 4.</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;T120</span> <span class="pre">V10</span> <span class="pre">O4</span> <span class="pre">L4</span> <span class="pre">C.</span> <span class="pre">D8</span> <span class="pre">E.</span> <span class="pre">C8</span> <span class="pre">E</span> <span class="pre">C</span> <span class="pre">E2</span> <span class="pre">D.</span> <span class="pre">E8</span> <span class="pre">{FF}</span> <span class="pre">{ED}</span> <span class="pre">F2&quot;</span></code></p>
</section>
</section>
<section id="provided-c-functions">
<h2>Provided C Functions<a class="headerlink" href="#provided-c-functions" title="Permalink to this heading"></a></h2>
<p>mml_parser is providing just 2 functions.</p>
<section id="init-mml">
<h3>init_mml()<a class="headerlink" href="#init-mml" title="Permalink to this heading"></a></h3>
<p>Initialize an instance of mml parser.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;audioutils/mml_parser.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">init_mml</span><span class="p">(</span><span class="n">FAR</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">music_macro_lang_s</span><span class="w"> </span><span class="o">*</span><span class="n">mml</span><span class="p">,</span>
<span class="w">             </span><span class="kt">int</span><span class="w"> </span><span class="n">fs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tempo</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">octave</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
</pre></div>
</div>
<p>The function initializes <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">music_macro_lang_s</span></code> instance provided as 1st argument.
The argument <code class="docutils literal notranslate"><span class="pre">fs</span></code> is a sampling frequency of target audio output system, and this value is used for
calculating sample number in case of a tempo and length of note.
<code class="docutils literal notranslate"><span class="pre">tempo</span></code>, <code class="docutils literal notranslate"><span class="pre">octave</span></code> and <code class="docutils literal notranslate"><span class="pre">length</span></code> specify initial values for tempo, octave, and length, respectively.</p>
<p>On success, init_mml() returns 0. On error, it returns an negative value.</p>
<p>Currently no error is happened.</p>
</section>
<section id="parse-mml">
<h3>parse_mml()<a class="headerlink" href="#parse-mml" title="Permalink to this heading"></a></h3>
<p>Parse MML from given string.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;audioutils/mml_parser.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">parse_mml</span><span class="p">(</span><span class="n">FAR</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">music_macro_lang_s</span><span class="w"> </span><span class="o">*</span><span class="n">mml</span><span class="p">,</span>
<span class="w">             </span><span class="n">FAR</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="n">FAR</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">mml_result_s</span><span class="w"> </span><span class="o">*</span><span class="n">result</span><span class="p">);</span>
</pre></div>
</div>
<p>parse_mml() parses the first MML of the string given by the argument <code class="docutils literal notranslate"><span class="pre">score</span></code> and gives
the result in the return value and the argument <code class="docutils literal notranslate"><span class="pre">result</span></code>.
The <code class="docutils literal notranslate"><span class="pre">result</span></code> is an instance of mml_result_s, which contains note_idx, length, and
chord_notes as members. The meaning of the value of each member depends on the return value.</p>
<p>On error, a nevative value is returned.
On success, following values can be returned. And those values are defined in <code class="docutils literal notranslate"><span class="pre">mml_parser.h</span></code>.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Return values</p></td>
<td><p>Description</p></td>
</tr>
</tbody>
</table>
<p>MML_TYPE_EOF          This means that it have reached the end of the string. The content of the <code class="docutils literal notranslate"><span class="pre">result</span></code> has no meaning.
MML_TYPE_NOTE         This indicates that some note has been parsed. The scale of the note is stored in <code class="docutils literal notranslate"><span class="pre">note_idx[0]</span></code>. The length of the note is given by the <code class="docutils literal notranslate"><span class="pre">length</span></code> member as the number of samples. In the case of tuplet, this return value is returned at the time each note is parsed. In other words, a tuplet is parsed as a single note.
MML_TYPE_REST         This indicates the <code class="docutils literal notranslate"><span class="pre">rest</span></code> has been parsed. The length of it is given by the <code class="docutils literal notranslate"><span class="pre">length</span></code> member as the number of samples.
MML_TYPE_TEMPO        This indicates <code class="docutils literal notranslate"><span class="pre">&quot;T&quot;</span></code> is parsed. <code class="docutils literal notranslate"><span class="pre">length</span></code> member in <code class="docutils literal notranslate"><span class="pre">result</span></code> has the value of the tempo. But tempo value is kept in mml instance for calculating sample number for each notes. So basically, no need to handle this return value in your code.
MML_TYPE_LENGTH       This indicates <code class="docutils literal notranslate"><span class="pre">&quot;L&quot;</span></code> is parsed. <code class="docutils literal notranslate"><span class="pre">length</span></code> member in <code class="docutils literal notranslate"><span class="pre">result</span></code> has the value of the parsed length. But current length value is kept in mml instance. So basically, no need to handle this return value in your code. |
MML_TYPE_OCTAVE       This indicates <code class="docutils literal notranslate"><span class="pre">&quot;O&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;&gt;&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;&lt;&quot;</span></code> is parsed. <code class="docutils literal notranslate"><span class="pre">length</span></code> member in <code class="docutils literal notranslate"><span class="pre">result</span></code> has the value of the octave. But the octave is encoded in <code class="docutils literal notranslate"><span class="pre">note_idx</span></code> in <code class="docutils literal notranslate"><span class="pre">MML_TYPE_NOTE</span></code> case. So basically, no need to handle this return value in your code.
MML_TYPE_TUPLETSTART  This indicates tuplet is just started. And total length of the tuplet is stored in <code class="docutils literal notranslate"><span class="pre">length</span></code> of <code class="docutils literal notranslate"><span class="pre">result</span></code> members.
MML_TYPE_TUPLETDONE   This indicates the tuplet is just finished.
MML_TYPE_VOLUME       This indicates <code class="docutils literal notranslate"><span class="pre">&quot;V&quot;</span></code> is parsed. <code class="docutils literal notranslate"><span class="pre">length</span></code> member in <code class="docutils literal notranslate"><span class="pre">result</span></code> has the value of the parsed volume.
MML_TYPE_TONE         T.B.D.
MML_TYPE_CHORD        This indicates a chord is parsed. Chord has some notes, and how many notes is stored in <code class="docutils literal notranslate"><span class="pre">chord_notes</span></code> member of <code class="docutils literal notranslate"><span class="pre">result</span></code>. And each notes are stored in <code class="docutils literal notranslate"><span class="pre">note_idx[]</span></code>. Length of the chord is stored in <code class="docutils literal notranslate"><span class="pre">length</span></code> member of <code class="docutils literal notranslate"><span class="pre">result</span></code>.
===================== ===========================================</p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">note_idx[]</span></code> is encoding octave, like</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Octave</p></th>
<th class="head"><p>Note</p></th>
<th class="head"><p>node_idx value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>O0</p></td>
<td><p>C</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>C#</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>O0</p></td>
<td><p>D</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>D#</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>O0</p></td>
<td><p>E</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>F</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p>O0</p></td>
<td><p>F#</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>G</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>O0</p></td>
<td><p>G#</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>A</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-even"><td><p>O0</p></td>
<td><p>A#</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>O0</p></td>
<td><p>B</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-even"><td><p>O1</p></td>
<td><p>C</p></td>
<td><p>12</p></td>
</tr>
</tbody>
</table>
<p>And so on.</p>
<p>So for example, G# at Octave 4 is encoded as 56.</p>
<p>Following error code can be received as return value.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Error code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MML_TYPE_NOTE_ERROR</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_REST_ERROR</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_TEMPO_ERROR</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_LENGTH_ERROR</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_OCTAVE_ERROR</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_VOLUME_ERROR</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_TUPLET_ERROR</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_TONE_ERROR</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_CHORD_ERROR</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_ILLIGAL_COMPOSITION</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_ILLIGAL_TOOMANY_NOTES</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>MML_TYPE_ILLIGAL_TOOFEW_NOTES</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MML_TYPE_ILLIGAL_DOUBLE_TUPLET</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="running-unit-tests">
<h2>Running unit tests<a class="headerlink" href="#running-unit-tests" title="Permalink to this heading"></a></h2>
<p>Please see examples/mml_parser</p>
</section>
<section id="bugs">
<h2>Bugs<a class="headerlink" href="#bugs" title="Permalink to this heading"></a></h2>
<p>There are plenty. Report them on GitHub, or - even better - open a pull request.
Please write unit tests for any new functions you add - it’s fun!</p>
</section>
<section id="author">
<h2>Author<a class="headerlink" href="#author" title="Permalink to this heading"></a></h2>
<p>mml_parser was written by Takayoshi Koizumi &amp;lt;takayoshi.koizumi&#64;gmail.com&amp;gt;</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../fmsynt/index.html" class="btn btn-neutral float-left" title="fmsynth FM Synthesizer Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nxaudio/index.html" class="btn btn-neutral float-right" title="nxaudio NX Audio Library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>