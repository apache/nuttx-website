<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stm32f401rc-rs485 &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="stm32f411-minimum" href="../stm32f411-minimum/index.html" />
    <link rel="prev" title="ST STM32140G-EVAL" href="../stm3240g-eval/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../../../12.5.1" >12.5.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">Supported Platforms</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">ARM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../a1x/index.html">Allwinner A10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../am335x/index.html">TI/Sitara AM335x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../at32/index.html">Artery AT32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../bcm2708/index.html">Broadcom BCM2708 (removed)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../c5471/index.html">TI TMS320-C5471</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cxd56xx/index.html">Sony CXD56xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dm320/index.html">TI TMS320-DM320</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../efm32/index.html">SiLabs EFM32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../eoss3/index.html">EOSS3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fvp-v8r-aarch32/index.html">FVP ARMv8-R Virt Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../gd32f4/index.html">GD32F4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../goldfish/index.html">GOLDFISH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx1/index.html">NXP/Freescale i.MX1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imx6/index.html">NXP/Freescale i.MX6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../imxrt/index.html">NXP i.MX RT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kinetis/index.html">NXP/FreeScale Kinetis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../kl/index.html">NXP/FreeScale KLxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lc823450/index.html">ON Semiconductor LC823450</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc17xx/index.html">NXP LPC17xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc214x/index.html">NXP LPC214x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc2378/index.html">NXP LPC2378</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc31xx/index.html">NXP LPC31xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc40xx/index.html">NXP LPC40xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc43xx/index.html">NXP LPC43xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lpc54xx/index.html">NXP LPC54xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../max326xx/index.html">Maxim Integrated MAX32660</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../moxart/index.html">Moxa NP51x0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/ieee802154.html">Nordic nRF52 IEEE 802.15.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf52/index.html">Nordic nRF52</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf53/index.html">Nordic nRF53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nrf91/index.html">Nordic nRF91</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../nuc1xx/index.html">nuvoTon NUC120</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../phy62xx/index.html">PHY+ PHY62</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../qemu/index.html">QEMU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../rp2040/index.html">RaspberryPi rp2040</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k1xx/index.html">NXP S32K1XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../s32k3xx/index.html">NXP S32K3XX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sam34/index.html">Microchip SAM34</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sama5/index.html">Microchip SAMA5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd2l2/index.html">Microchip SAMD2x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samd5e5/index.html">Microchip samd5e5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../samv7/index.html">Microchip SAM V7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f0/index.html">ST STM32F0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f1/index.html">ST STM32F1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f2/index.html">ST STM32F2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f3/index.html">ST STM32F3</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">ST STM32F4</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../index.html#supported-mcus">Supported MCUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#peripheral-support">Peripheral Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#fpu">FPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#development-environment">Development Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#gnu-toolchain-options">GNU Toolchain Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#ides">IDEs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#nuttx-eabi-buildroot-toolchain">NuttX EABI “buildroot” Toolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#nxflat-toolchain">NXFLAT Toolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../index.html#protected-mode-build">Protected Mode Build</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html#supported-boards">Supported Boards</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="../axoloti/index.html">Axoloti</a></li>
<li class="toctree-l5"><a class="reference internal" href="../clicker2-stm32/index.html">Mikroe Clicker2 STM32</a></li>
<li class="toctree-l5"><a class="reference internal" href="../mikroe-stm32f4/index.html">mikroe-stm32f4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f401re/index.html">ST Nucleo F401RE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f410rb/index.html">ST Nucleo F410RB</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f411re/index.html">ST Nucleo F401RE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f412zg/index.html">ST Nucleo F410RB</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f429zi/index.html">ST Nucleo F429ZI</a></li>
<li class="toctree-l5"><a class="reference internal" href="../nucleo-f446re/index.html">ST Nucleo F446RE</a></li>
<li class="toctree-l5"><a class="reference internal" href="../odrive36/index.html">ODrive V3.6</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimex-stm32-e407/index.html">Olimex STM32-E407</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimex-stm32-h405/index.html">Olimex STM32-P207</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimex-stm32-h407/index.html">Olimex STM32-H407</a></li>
<li class="toctree-l5"><a class="reference internal" href="../olimex-stm32-p407/index.html">Olimex STM32-P207</a></li>
<li class="toctree-l5"><a class="reference internal" href="../omnibusf4/index.html">OMNIBUSF4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm3240g-eval/index.html">ST STM32140G-EVAL</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">stm32f401rc-rs485</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32f411-minimum/index.html">stm32f411-minimum</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32f411e-disco/index.html">ST STM32F411E-Discovery</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32f429i-disco/index.html">ST STM32F429I-DISCO</a></li>
<li class="toctree-l5"><a class="reference internal" href="../stm32f4discovery/index.html">ST STM32F4-Discovery</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32f7/index.html">ST STM32F7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g0/index.html">ST STM32G0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32g4/index.html">ST STM32G4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32h7/index.html">ST STM32H7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l0/index.html">ST STM32L0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l1/index.html">ST STM32L1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l4/index.html">ST STM32L4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32l5/index.html">ST STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32u5/index.html">ST STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wb/index.html">ST STM32WB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../stm32wl5/index.html">ST STM32WL5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../str71x/index.html">ST STR71</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tiva/index.html">TI/Stellaris Tiva</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tms570/index.html">TI/Hercules TMS570xxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../xmc4/index.html">Infineon XMC4000</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../arm64/index.html">ARM64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../avr/index.html">Microchip AVR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ceva/index.html">CEVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hc/index.html">HC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mips/index.html">MIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misco/index.html">Misoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../or1k/index.html">OpenRISC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../renesas/index.html">Renesas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../risc-v/index.html">RISC-V</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sim/index.html">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sparc/index.html">SPARC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tricore/index.html">TriCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86/index.html">Intel 80x86</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../x86_64/index.html">Intel 80x86_64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../xtensa/index.html">Xtensa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z16/index.html">Z16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../z80/index.html">Z80</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../implementation/index.html">Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Supported Platforms</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">ARM</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">ST STM32F4</a></li>
      <li class="breadcrumb-item active">stm32f401rc-rs485</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/platforms/arm/stm32f4/boards/stm32f401rc-rs485/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="stm32f401rc-rs485">
<h1>stm32f401rc-rs485<a class="headerlink" href="#stm32f401rc-rs485" title="Permalink to this heading"></a></h1>
<p>This page discusses issues unique to NuttX configurations for the
NuttX STM32F4-RS485 development board.</p>
<figure class="align-center">
<img alt="../../../../../_images/stm32f401rc_rs485.jpg" src="../../../../../_images/stm32f401rc_rs485.jpg" />
</figure>
<section id="board-information">
<h2>Board information<a class="headerlink" href="#board-information" title="Permalink to this heading"></a></h2>
<p>This board was release on NuttX International Workshop 2023 and developed based on
STM32F401RCT6 microcontroller.</p>
<dl class="simple">
<dt>STM32F401RCT6 microcontroller features:</dt><dd><ul class="simple">
<li><p>Arm 32-bit Cortex®-M4 CPU with FPU</p></li>
<li><p>256 Kbytes of Flash memory</p></li>
<li><p>64 Kbytes of SRAM</p></li>
<li><p>Serial wire debug (SWD) &amp; JTAG interfaces</p></li>
<li><p>Up to 81 I/O ports with interrupt capability</p></li>
<li><p>Up to 11 communication interfaces</p></li>
<li><p>Up to 3 I2C interfaces</p></li>
<li><p>Up to 3 USARTs</p></li>
<li><p>Up to 4 SPIs</p></li>
<li><p>SDIO interface</p></li>
<li><p>USB 2.0 full-speed device/host/OTG controller with on-chip PHY</p></li>
</ul>
</dd>
</dl>
<p>The board features:</p>
<ul class="simple">
<li><p>Digital I2C Temperature Sensor (TMP75)</p></li>
<li><p>2K bits (256x8) I2C EEPROM</p></li>
<li><p>On-board RS485 Transceiver</p></li>
<li><p>Two Analog Input Stages with Amplifier Buffer</p></li>
<li><p>Two Analog Output Stages with Amplifier Buffer</p></li>
<li><p>MicroSD Connector supporting 1 or 4-bit bus</p></li>
<li><p>Four User LEDs</p></li>
<li><p>Four User Buttons</p></li>
<li><p>USB for DFU (Device Firmware Update) and USB device functionality, as well as powering the board</p></li>
<li><p>Onboard voltage regulator from 5V to 3.3V</p></li>
<li><p>SWD Pins for use as STLink (Pin header) and TC2030-IDC 6-Pin Tag-Connect Plug-of-Nails™ Connector</p></li>
<li><p>Crystal for HS 8MHz</p></li>
<li><p>Crystal for RTC 32.768KHz</p></li>
</ul>
<p>Board documentation:
<a class="reference external" href="https://github.com/lucaszampar/NuttX_STM32F4_RS485_DevBoard">https://github.com/lucaszampar/NuttX_STM32F4_RS485_DevBoard</a></p>
<p>As F4 series have a USB DFuSe-capable BootROM [AN2606], the board can be flashed
via <cite>dfu-util</cite> over USB, or via <cite>stm32flash</cite> over UART without any debuggers.</p>
</section>
<section id="leds">
<h2>LEDs<a class="headerlink" href="#leds" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 has 4 software controllable LEDs.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>LED</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LED_1</p></td>
<td><p>PC0</p></td>
</tr>
<tr class="row-odd"><td><p>LED_2</p></td>
<td><p>PC1</p></td>
</tr>
<tr class="row-even"><td><p>LED_4</p></td>
<td><p>PC2</p></td>
</tr>
<tr class="row-odd"><td><p>LED_5</p></td>
<td><p>PC3</p></td>
</tr>
</tbody>
</table>
</section>
<section id="user-buttons">
<h2>User Buttons<a class="headerlink" href="#user-buttons" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 has 4 user switches.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SWITCH</p></th>
<th class="head"><p>PINS</p></th>
<th class="head"><p>LABEL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SWIO_1</p></td>
<td><p>PB13</p></td>
<td><p>SW3</p></td>
</tr>
<tr class="row-odd"><td><p>SWIO_2</p></td>
<td><p>PB14</p></td>
<td><p>SW4</p></td>
</tr>
<tr class="row-even"><td><p>SWIO_3</p></td>
<td><p>PB15</p></td>
<td><p>SW5</p></td>
</tr>
<tr class="row-odd"><td><p>SWIO_4</p></td>
<td><p>PC6</p></td>
<td><p>SW6[1]</p></td>
</tr>
</tbody>
</table>
<p>[1] The switch SWIO_4 (SW6) is disabled due a conflict with PIN
PC6 when using USART6.</p>
</section>
<section id="uarts">
<h2>UARTs<a class="headerlink" href="#uarts" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 has 1 USART available for user.</p>
<section id="usart6">
<h3>USART6<a class="headerlink" href="#usart6" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>UART/USART</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TX</p></td>
<td><p>PC6 [1]</p></td>
</tr>
<tr class="row-odd"><td><p>RX</p></td>
<td><p>PC7</p></td>
</tr>
<tr class="row-even"><td><p>CK</p></td>
<td><p>PA8</p></td>
</tr>
</tbody>
</table>
<p>[1] Warning you make need to reverse RX/TX on some RS-232 converters</p>
</section>
</section>
<section id="sdcard-support">
<h2>SDCard support<a class="headerlink" href="#sdcard-support" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 has 1 SDCard slot connected as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SDIO</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDIO_D0</p></td>
<td><p>PC8</p></td>
</tr>
<tr class="row-odd"><td><p>SDIO_D1</p></td>
<td><p>PC9</p></td>
</tr>
<tr class="row-even"><td><p>SDIO_D2</p></td>
<td><p>PC10</p></td>
</tr>
<tr class="row-odd"><td><p>SDIO_D3</p></td>
<td><p>PC11</p></td>
</tr>
<tr class="row-even"><td><p>SDIO_DK</p></td>
<td><p>PC12</p></td>
</tr>
</tbody>
</table>
</section>
<section id="eeprom">
<h2>EEPROM<a class="headerlink" href="#eeprom" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 development board has serial EEPROM HX24LC02B, with 2k bits (256x8) and internally
organized with 32 pages of 8 bytes each. It is connected through I2C as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>I2C</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDA</p></td>
<td><p>PB7</p></td>
</tr>
<tr class="row-odd"><td><p>SCL</p></td>
<td><p>PB8</p></td>
</tr>
</tbody>
</table>
<p>Users can enable EERPOM support on STM32F4-RS485 by following below configuration:</p>
<ul>
<li><p>Configure basic nsh:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./tools/configure.sh -l stm32f401rc-rs485:nsh
</pre></div>
</div>
</li>
<li><p>Enable the following configs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CONFIG_DEV_ZERO=y
CONFIG_EEPROM=y
CONFIG_FS_PROCFS=y
CONFIG_I2C=y
CONFIG_I2C_EE_24XX=y
CONFIG_STM32_I2C1=y
</pre></div>
</div>
</li>
<li><p>Build and flash the STM32F4-RS485.</p></li>
<li><p>Use dd command to write and read data from EEPROM as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; dd if=/dev/zero of=/dev/eeprom
nsh: dd: write failed: 1
nsh&gt; dd if=/dev/console of=/dev/eeprom bs=1 count=4
(type &quot;Hello&quot;)
nsh&gt; dd if=/dev/eeprom of=/dev/console bs=4 count=1
Hellonsh&gt;
</pre></div>
</div>
</li>
</ul>
</section>
<section id="temperature-sensor">
<h2>Temperature Sensor<a class="headerlink" href="#temperature-sensor" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 development board has a temperature sensor TMP75 (compatible with LM75) connected through I2C as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>I2C</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SDA</p></td>
<td><p>PB7</p></td>
</tr>
<tr class="row-odd"><td><p>SCL</p></td>
<td><p>PB8</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rs485-transceiver">
<h2>RS485 Transceiver<a class="headerlink" href="#rs485-transceiver" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 development board has a half-duplex RS-485 transceiver, the BL3085B it is connected
through USART2 as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USART2</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USART2_RX</p></td>
<td><p>RO</p></td>
</tr>
<tr class="row-odd"><td><p>USART2_RTS</p></td>
<td><p>DE, /RE</p></td>
</tr>
<tr class="row-even"><td><p>USART2_RX</p></td>
<td><p>DI</p></td>
</tr>
</tbody>
</table>
</section>
<section id="a-d-converter">
<h2>A/D Converter<a class="headerlink" href="#a-d-converter" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 development board has two Analog to Digital converters with Amplifier Buffer (1COS724SR)
and connected as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>PWM</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PWM_1</p></td>
<td><p>PB6</p></td>
</tr>
<tr class="row-odd"><td><p>PWM_2</p></td>
<td><p>PA6</p></td>
</tr>
</tbody>
</table>
</section>
<section id="d-c-converter">
<h2>D/C Converter<a class="headerlink" href="#d-c-converter" title="Permalink to this heading"></a></h2>
<p>The STM32F4-RS485 development board has two Digital to Analog converters with Amplifier Buffer (1COS724SR)
and connected as below:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ADC</p></th>
<th class="head"><p>PINS</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ADC_1</p></td>
<td><p>PA0</p></td>
</tr>
<tr class="row-odd"><td><p>ADC_2</p></td>
<td><p>PA4</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configurations">
<h2>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading"></a></h2>
<p>Each stm32f401rc-rs485 configuration is maintained in a sub-directory and
can be selected as follow:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tools/configure.sh stm32f401rc-rs485:&lt;subdir&gt;
</pre></div>
</div>
<p>Where &lt;subdir&gt; is one of the following:</p>
<section id="configuration-directories">
<h3>Configuration Directories<a class="headerlink" href="#configuration-directories" title="Permalink to this heading"></a></h3>
</section>
<section id="nsh">
<h3>nsh<a class="headerlink" href="#nsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at apps/examples/nsh. This
configuration enables a serial console on USART6.</p>
</section>
<section id="usbnsh">
<h3>usbnsh<a class="headerlink" href="#usbnsh" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) located at apps/examples/nsh. This
configuration enables a serial console over USB.</p>
<p>After flasing and reboot your board you should see in your dmesg logs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ 2638.948089] usb 1-1.4: new full-speed USB device number 16 using xhci_hcd
[ 2639.054432] usb 1-1.4: New USB device found, idVendor=0525, idProduct=a4a7, bcdDevice= 1.01
[ 2639.054437] usb 1-1.4: New USB device strings: Mfr=1, Product=2, SerialNumber=3
[ 2639.054438] usb 1-1.4: Product: CDC/ACM Serial
[ 2639.054440] usb 1-1.4: Manufacturer: NuttX
[ 2639.054441] usb 1-1.4: SerialNumber: 0
[ 2639.074861] cdc_acm 1-1.4:1.0: ttyACM0: USB ACM device
[ 2639.074886] usbcore: registered new interface driver cdc_acm
[ 2639.074887] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters
</pre></div>
</div>
<p>You may need to press <strong>ENTER</strong> 3 times before the NSH show up.</p>
</section>
<section id="sdcard">
<h3>sdcard<a class="headerlink" href="#sdcard" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) and enables SD card support.
The stm32f401rc-rs485 has an onboard microSD slot that should
be automatically registered as the block device /dev/mmcsd0 when
an SD card is present.  The SD card can then be mounted by the
NSH commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; mount -t procfs /proc
nsh&gt; mount -t vfat /dev/mmcsd0 /mnt
</pre></div>
</div>
</section>
<section id="modbus-slave">
<h3>modbus_slave<a class="headerlink" href="#modbus-slave" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) and enables modbus in slave mode. This
configuration enables a serial console on USART6. The RS-485 is connected
to USART2. Follow below precedure to use modbus test aplication, you will
need a USB to RS-485 converter to connect the board to a PC via RS-485.</p>
<p>NuttShell configuration:</p>
<p>Run modbus application at NSH:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; modbus -help
USAGE: modbus [-d|e|s|q|h]

Where:
  -d : Disable protocol stack
  -e : Enable the protocol stack
  -s : Show current status
  -q : Quit application
  -h : Show this information

nsh&gt; modbus -e
</pre></div>
</div>
<p>PC Configuration:</p>
<p>Download and install mbpoll aplication:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo apt install mbpoll
</pre></div>
</div>
<p>Check which TTY USB port is being used by you USB to RS-485 converter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo dmesg
[99846.668209] usb 1-1.3: Product: USB Serial
[99846.676313] ch341 1-1.3:1.0: ch341-uart converter detected
[99846.677454] usb 1-1.3: ch341-uart converter now attached to ttyUSB1
</pre></div>
</div>
<p>Run the mbpoll as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mbpoll -a 10 -b 38400 -t 3 -r 1000 -c 4 /dev/ttyUSB1 -R
</pre></div>
</div>
<p>At PC terminal you will see the mbpoll application receiving the random values
generated by STM32F401RC-RS485 and transmitted over RS-485:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mbpoll 1.0-0 - FieldTalk(tm) Modbus(R) Master Simulator
Copyright © 2015-2019 Pascal JEAN, https://github.com/epsilonrt/mbpoll
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions; type &#39;mbpoll -w&#39; for details.

Protocol configuration: Modbus RTU
Slave configuration...: address = [10]
                        start reference = 1000, count = 4
Communication.........: /dev/ttyUSB1,      38400-8E1
                        t/o 1.00 s, poll rate 1000 ms
Data type.............: 16-bit register, input register table
-- Polling slave 10... Ctrl-C to stop)
[1000]:  58080 (-7456)
[1001]:  0
[1002]:  0
[1003]:  0
-- Polling slave 10... Ctrl-C to stop)
[1000]:  6100
[1001]:  0
[1002]:  0
[1003]:  0
-- Polling slave 10... Ctrl-C to stop)
[1000]:  51010 (-14526)
[1001]:  0
[1002]:  0
[1003]:  0
-- Polling slave 10... Ctrl-C to stop)
[1000]:  12528
[1001]:  0
[1002]:  0
[1003]:  0
</pre></div>
</div>
</section>
<section id="modbus-master">
<h3>modbus_master<a class="headerlink" href="#modbus-master" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) and enables modbus in master mode. This
configuration enables a serial console on USART6. The RS-485 is connected
to USART2. Follow below precedure to use modbusmaster test aplication, you will
need a USB to RS-485 converter to connect the board to a PC via RS-485.</p>
<p>PC Configuration:</p>
<p>Download and install diagslave aplication from <a class="reference external" href="https://www.modbusdriver.com/diagslave.html">https://www.modbusdriver.com/diagslave.html</a>.</p>
<p>Check which TTY USB port is being used by you USB to RS-485 converter:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo dmesg
[99846.668209] usb 1-1.3: Product: USB Serial
[99846.676313] ch341 1-1.3:1.0: ch341-uart converter detected
[99846.677454] usb 1-1.3: ch341-uart converter now attached to ttyUSB1
</pre></div>
</div>
<p>Run the diagslave as below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo diagslave -a 10 -b 38400 /dev/ttyUSB1
</pre></div>
</div>
<p>At PC terminal you will see the diagslave application listening to address 10,
notice that this address is configurable via MODBUSMASTER_SLAVEADDR:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>diagslave 3.4 - FieldTalk(tm) Modbus(R) Diagnostic Slave Simulator
Copyright (c) 2002-2021 proconX Pty Ltd
Visit https://www.modbusdriver.com for Modbus libraries and tools.

Protocol configuration: Modbus RTU, frame tolerance = 0ms
Slave configuration: address = 10, master activity t/o = 3.00s
Serial port configuration: /dev/ttyUSB1, 38400, 8, 1, even

Server started up successfully.
Listening to network (Ctrl-C to stop)
Slave  10: readHoldingRegisters from 2, 1 references
.......
</pre></div>
</div>
<p>NuttShell configuration:</p>
<p>Run modbusmaster application at NSH:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NuttShell (NSH) NuttX-12.4.0
nsh&gt; modbusmaster
Initializing modbus master...
Creating poll thread.
Sending 100 requests to slave 10
mbmaster_main: Exiting poll thread.
Modbus master statistics:
Requests count:  100
Responses count: 100
Errors count:    0
Deinitializing modbus master...
</pre></div>
</div>
<p>The application modbusmaster will send 100 requests, you can check on diagslave:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Server started up successfully.
Listening to network (Ctrl-C to stop)
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
Slave  10: readHoldingRegisters from 2, 1 references
</pre></div>
</div>
</section>
<section id="lm75">
<h3>lm75<a class="headerlink" href="#lm75" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) over USB Serial (check usbserial configuration) and enables temperature sensor LM75.
NSH commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; lm75 -help
Usage: temp [OPTIONS]
  [-n count] selects the samples to collect.  Default: 1 Current: 100
  [-h] shows this message and exits
nsh&gt; lm75 -n 3
30.13 degrees Celsius
30.13 degrees Celsius
30.13 degrees Celsius
</pre></div>
</div>
</section>
<section id="adc">
<h3>adc<a class="headerlink" href="#adc" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) over USB Serial (check usbserial configuration) and enables ADC 1 on channels 0 and 4.
NSH commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; adc -h
Usage: adc [OPTIONS]

Arguments are &quot;sticky&quot;.  For example, once the ADC device is
specified, that device will be re-used until it is changed.

&quot;sticky&quot; OPTIONS include:
  [-p devpath] selects the ADC device.  Default: /dev/adc0 Current: /dev/adc0
  [-n count] selects the samples to collect.  Default: 1 Current: 0
  [-h] shows this message and exits
nsh&gt; adc -n 2
adc_main: g_adcstate.count: 2
adc_main: Hardware initialized. Opening the ADC device: /dev/adc0
Sample:
1: channel: 0 value: 2684
Sample:
1: channel: 4 value: 2682
</pre></div>
</div>
<p>Currently there is a bug that causes the application to always read the same value for channel 0 and 4. If you want to read the value from channel 2, you will need to enable the config “ADC1 Scan Mode”.</p>
</section>
<section id="dac">
<h3>dac<a class="headerlink" href="#dac" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) over USB Serial (check usbserial configuration) and enables PWM 3 on channel 1.
Use pwm command on NSH to change dutty cycle, frequency and duration, use dac_out_2 to measure the output voltage.
NSH commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; pwm -h
Usage: pwm [OPTIONS]

Arguments are &quot;sticky&quot;.  For example, once the PWM frequency is
specified, that frequency will be re-used until it is changed.

&quot;sticky&quot; OPTIONS include:
  [-p devpath] selects the PWM device.  Default: /dev/pwm0 Current: NONE
  [-f frequency] selects the pulse frequency.  Default: 100 Hz Current: 100 Hz
  [-d duty] selects the pulse duty as a percentage.  Default: 50 % Current: 50 %
  [-t duration] is the duration of the pulse train in seconds.  Default: 5 Current: 5
  [-h] shows this message and exits
nsh&gt; pwm -d 50 -t 3
pwm_main: starting output with frequency: 50 duty: 00007fff
pwm_main: stopping output
</pre></div>
</div>
</section>
<section id="qencoder">
<h3>qencoder<a class="headerlink" href="#qencoder" title="Permalink to this heading"></a></h3>
<p>Configures the NuttShell (nsh) over USB Serial (check usbserial configuration) and enables Timer 3 on channels 1 and
2 to handle Quadrature Encoder.
NSH commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nsh&gt; qe -help

Usage: qe [OPTIONS]

OPTIONS include:
  [-p devpath] QE device path
  [-n samples] Number of samples
  [-t msec]    Delay between samples (msec)
  [-r]         Reset the position to zero
  [-h]         Shows this message and exits
  nsh&gt; qe -p /dev/qe0 -n 5 -t 100 -r
  nsh: qe: too many arguments
  qe_main: Hardware initialized. Opening the encoder device: /dev/qe0
  qe_main: Resetting the count...
  qe_main: Number of samples: 5
  qe_main:   1. 0
  qe_main:   2. 0
  qe_main:   3. 4
  qe_main:   4. 2
  qe_main:   5. 2
  Terminating!
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../stm3240g-eval/index.html" class="btn btn-neutral float-left" title="ST STM32140G-EVAL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../stm32f411-minimum/index.html" class="btn btn-neutral float-right" title="stm32f411-minimum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>