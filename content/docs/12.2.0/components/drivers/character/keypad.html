<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Keyboard/Keypad Drivers &mdash; NuttX latest documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Note Driver Interface" href="note.html" />
    <link rel="prev" title="Watchdog Timer Drivers" href="watchdog.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  
    <a href="../../../index.html" class="icon icon-home"> NuttX
  

  
  </a>

  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->

  <div class="version-selector">
    <select onchange="javascript:location.href = this.value;">
    
    <option value="../../../../latest" selected="selected">latest</option>
    
    <option value="../../../../10.0.0" >10.0.0</option>
    
    <option value="../../../../10.0.1" >10.0.1</option>
    
    <option value="../../../../10.1.0" >10.1.0</option>
    
    <option value="../../../../10.2.0" >10.2.0</option>
    
    <option value="../../../../10.3.0" >10.3.0</option>
    
    <option value="../../../../11.0.0" >11.0.0</option>
    
    <option value="../../../../12.0.0" >12.0.0</option>
    
    <option value="../../../../12.1.0" >12.1.0</option>
    
    <option value="../../../../12.2.0" >12.2.0</option>
    
    <option value="../../../../12.2.1" >12.2.1</option>
    
    <option value="../../../../12.3.0" >12.3.0</option>
    
    <option value="../../../../12.4.0" >12.4.0</option>
    
    <option value="../../../../12.5.0" >12.5.0</option>
    
    <option value="../../../../12.5.1" >12.5.1</option>
    
    </select>
  </div>

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Supported Platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">OS Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../power.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binfmt.html">Binary Loader</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Device Drivers</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Character Device Drivers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="serial.html">Serial Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="touchscreen.html">Touchscreen Device Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="analog.html">Analog (ADC/DAC) Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="pwm.html">PWM Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="can.html">CAN Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="quadrature.html">Quadrature Encoder Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="timer.html">Timer Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="rtc.html">RTC Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="watchdog.html">Watchdog Timer Drivers</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Keyboard/Keypad Drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="note.html">Note Driver Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="foc.html">FOC Driver Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="ws2812.html">ws2812 Drivers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../block/index.html">Block Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../special/index.html">Specialized Device Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#lower-half-and-upper-half">Lower-half and upper-half</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../filesystem.html">NuttX File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nxflat.html">NXFLAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nxgraphics/index.html">NX Graphics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../nxwidgets.html">NxWidgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../paging.html">On-Demand Paging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NuttX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">OS Components</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Device Drivers</a></li>
          <li class="breadcrumb-item"><a href="index.html">Character Device Drivers</a></li>
      <li class="breadcrumb-item active">Keyboard/Keypad Drivers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/components/drivers/character/keypad.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="keyboard-keypad-drivers">
<h1>Keyboard/Keypad Drivers<a class="headerlink" href="#keyboard-keypad-drivers" title="Permalink to this heading"></a></h1>
<p><strong>Keypads vs. Keyboards</strong> Keyboards and keypads are really the
same devices for NuttX. A keypad is thought of as simply a
keyboard with fewer keys.</p>
<p><strong>Special Commands</strong>. In NuttX, a keyboard/keypad driver is simply
a character driver that may have an (optional) encoding/decoding
layer on the data returned by the character driver. A keyboard may
return simple text data (alphabetic, numeric, and punctuation) or
control characters (enter, control-C, etc.) when a key is pressed.
We can think about this the “normal” keyboard data stream.
However, in addition, most keyboards support actions that cannot
be represented as text or control data. Such actions include
things like cursor controls (home, up arrow, page down, etc.),
editing functions (insert, delete, etc.), volume controls, (mute,
volume up, etc.) and other special functions. In this case, some
special encoding may be required to multiplex the normal text data
and special command key press data streams.</p>
<p><strong>Key Press and Release Events</strong> Sometimes the time that a key is
released is needed by applications as well. Thus, in addition to
normal and special key press events, it may also be necessary to
encode normal and special key release events.</p>
<p><strong>Encoding/Decoding</strong> Layer. An optional encoding/decoding layer
can be used with the basic character driver to encode the keyboard
events into the text data stream. The function interfaces that
comprise that encoding/decoding layer are defined in the header
file <code class="docutils literal notranslate"><span class="pre">include/nuttx/input/kbd_code.h</span></code>. These functions provide
an matched set of (a) driver encoding interfaces, and (b)
application decoding interfaces.</p>
<ol class="arabic">
<li><p><strong>Driver Encoding Interfaces</strong>. These are interfaces used by
the keyboard/keypad driver to encode keyboard events and data.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">kbd_press()</span></code></p>
<p><strong>Function Prototype:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Input Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ch</span></code>: The character to be added to the output stream.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stream</span></code>: An instance of <code class="docutils literal notranslate"><span class="pre">lib_outstream_s</span></code> to perform
the actual low-level put operation.</p></li>
</ul>
<p><strong>Returned Value:</strong></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kbd_release()</span></code></p>
<p><strong>Function Prototype:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Input Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ch</span></code>: The character associated with the key that was
released.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stream</span></code>: An instance of <code class="docutils literal notranslate"><span class="pre">lib_outstream_s</span></code> to perform
the actual low-level put operation.</p></li>
</ul>
<p><strong>Returned Value:</strong></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kbd_specpress()</span></code></p>
<p><strong>Function Prototype:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Input Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keycode</span></code>: The command to be added to the output
stream. The enumeration <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kbd_keycode_e</span> <span class="pre">keycode</span></code>
identifies all commands known to the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stream</span></code>: An instance of <code class="docutils literal notranslate"><span class="pre">lib_outstream_s</span></code> to perform
the actual low-level put operation.</p></li>
</ul>
<p><strong>Returned Value:</strong></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kbd_specrel()</span></code></p>
<p><strong>Function Prototype:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Input Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keycode</span></code>: The command to be added to the output
stream. The enumeration <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kbd_keycode_e</span> <span class="pre">keycode</span></code>
identifies all commands known to the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stream</span></code>: An instance of <code class="docutils literal notranslate"><span class="pre">lib_outstream_s</span></code> to perform
the actual low-level put operation.</p></li>
</ul>
<p><strong>Returned Value:</strong></p>
</li>
</ul>
</li>
<li><p><strong>Application Decoding Interfaces</strong>. These are user interfaces
to decode the values returned by the keyboard/keypad driver.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">kbd_decode()</span></code></p>
<p><strong>Function Prototype:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Input Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stream</span></code>: An instance of <code class="docutils literal notranslate"><span class="pre">lib_instream_s</span></code> to perform
the actual low-level get operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pch</span></code>: The location to save the returned value. This
may be either a normal, character code or a special
command (i.e., a value from <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kbd_getstate_s</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code>: A user provided buffer to support parsing.
This structure should be cleared the first time that
<code class="docutils literal notranslate"><span class="pre">kbd_decode()</span></code> is called.</p></li>
</ul>
<p><strong>Returned Value:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">KBD_PRESS</span></code> (0)**: Indicates the successful receipt
of normal, keyboard data. This corresponds to a keypress
event. The returned value in <code class="docutils literal notranslate"><span class="pre">pch</span></code> is a simple byte of
text or control data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KBD_RELEASE</span></code> (1)**: Indicates a key release event.
The returned value in <code class="docutils literal notranslate"><span class="pre">pch</span></code> is the byte of text or
control data corresponding to the released key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KBD_SPECPRESS</span></code> (2)**: Indicates the successful
receipt of a special keyboard command. The returned value
in <code class="docutils literal notranslate"><span class="pre">pch</span></code> is a value from <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kbd_getstate_s</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KBD_SPECREL</span></code> (3)**: Indicates a special command key
release event. The returned value in <code class="docutils literal notranslate"><span class="pre">pch</span></code> is a value
from <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">kbd_getstate_s</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KBD_ERROR</span></code> (<code class="docutils literal notranslate"><span class="pre">EOF</span></code>)**: An error has getting the
next character (reported by the <code class="docutils literal notranslate"><span class="pre">stream</span></code>). Normally
indicates the end of file.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>I/O Streams</strong>. Notice the use of the abstract I/O streams in
these interfaces. These stream interfaces are defined in
<code class="docutils literal notranslate"><span class="pre">include/nuttx/streams.h</span></code>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="watchdog.html" class="btn btn-neutral float-left" title="Watchdog Timer Drivers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="note.html" class="btn btn-neutral float-right" title="Note Driver Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, The Apache Software Foundation.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>