<!--
 Documentation/_templates/layout.html

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.  The
 ASF licenses this file to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance with the
 License.  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 License for the specific language governing permissions and limitations
 under the License.
-->



<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Symmetric Multiprocessing (SMP) Application &mdash; NuttX latest documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Shared Memory" href="shm.html" />
    <link rel="prev" title="boardctl() Application Interface" href="boardctl.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
  
    <a href="../../index.html" class="icon icon-home"> NuttX
  

  
    
    <img src="../../_static/NuttX.png" class="logo" alt="Logo"/>
  
  </a>
  
  <!-- this version selector is quite ugly, should be probably replaced by something
       more modern -->
       
  <div class="version-selector">
    <select>
    
      <option value="latest" selected="selected">latest</option>
    
    </select>
  </div>
  
  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/inviolables.html">The Inviolable Principles of NuttX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/index.html">OS Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../user/index.html">Userspace API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Architecture APIs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="conventions.html">Naming and Header File Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="arch.html">APIs Exported by Architecture-Specific Logic to NuttX</a></li>
<li class="toctree-l3"><a class="reference internal" href="board.html">APIs Exported by Board-Specific Logic to NuttX</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_clock.html">System Time and Clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="wqueue.html">Work Queues</a></li>
<li class="toctree-l3"><a class="reference internal" href="addrenv.html">Address Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="nuttx.html">APIs Exported by NuttX to Architecture-Specific Logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_vs_os.html">Application OS vs. Internal OS Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="boardctl.html"><code class="docutils literal notranslate"><span class="pre">boardctl()</span></code> Application Interface</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Symmetric Multiprocessing (SMP) Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="shm.html">Shared Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="paging.html">On-Demand Paging</a></li>
<li class="toctree-l3"><a class="reference internal" href="led.html">LED Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="iob.html">I/O Buffer Management</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NuttX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
          <li><a href="index.html">Architecture APIs</a> &raquo;</li>
        
      <li>Symmetric Multiprocessing (SMP) Application</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/os/smp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="symmetric-multiprocessing-smp-application">
<h1>Symmetric Multiprocessing (SMP) Application<a class="headerlink" href="#symmetric-multiprocessing-smp-application" title="Permalink to this headline">¶</a></h1>
<p>According to Wikipedia: “Symmetric multiprocessing (SMP) involves
a symmetric multiprocessor system hardware and software
architecture where two or more identical processors connect to a
single, shared main memory, have full access to all I/O devices,
and are controlled by a single operating system instance that
treats all processors equally, reserving none for special
purposes. Most multiprocessor systems today use an SMP
architecture. In the case of multi-core processors, the SMP
architecture applies to the cores, treating them as separate
processors.</p>
<p>“SMP systems are tightly coupled multiprocessor systems with a
pool of homogeneous processors running independently, each
processor executing different programs and working on different
data and with capability of sharing common resources (memory, I/O
device, interrupt system and so on) and connected using a system
bus or a crossbar.”</p>
<p>For a technical description of the NuttX implementation of SMP,
see the NuttX <a class="reference external" href="https://cwiki.apache.org/confluence/display/NUTTX/SMP">SMP Wiki
Page</a>.</p>
<dl class="c function">
<dt id="c.up_testset">
spinlock_t <code class="sig-name descname">up_testset</code><span class="sig-paren">(</span>FAR <em class="property">volatile</em> spinlock_t *<em>lock</em><span class="sig-paren">)</span><a class="headerlink" href="#c.up_testset" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform and atomic test and set operation on the provided spinlock.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lock</strong> – The address of spinlock object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The spinlock is always locked upon return. The value
of previous value of the spinlock variable is returned,
either SP_LOCKED if the spinlock was previously locked
(meaning that the test-and-set operation failed to obtain the lock)
or SP_UNLOCKED if the spinlock was previously unlocked
(meaning that we successfully obtained the lock)</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt id="c.up_cpu_index">
int <code class="sig-name descname">up_cpu_index</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#c.up_cpu_index" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return an index in the range of 0 through (CONFIG_SMP_NCPUS-1)
that corresponds to the currently executing CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An integer index in the range of 0 through
(CONFIG_SMP_NCPUS-1) that corresponds to the
currently executing CPU.</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt id="c.up_cpu_start">
int <code class="sig-name descname">up_cpu_start</code><span class="sig-paren">(</span>int <em>cpu</em><span class="sig-paren">)</span><a class="headerlink" href="#c.up_cpu_start" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>In an SMP configuration, only one CPU is initially active (CPU 0).
System initialization occurs on that single thread. At the
completion of the initialization of the OS, just before
beginning normal multitasking, the additional CPUs would
be started by calling this function.</p>
<p>Each CPU is provided the entry point to is IDLE task when started.
A TCB for each CPU’s IDLE task has been initialized and
placed in the CPU’s g_assignedtasks[cpu] list. A stack
has also been allocated and initialized.</p>
<p>The OS initialization logic calls this function repeatedly until
each CPU has been started, 1 through (CONFIG_SMP_NCPUS-1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> – The index of the CPU being started. This will be a
numeric value in the range of from one to
<code class="docutils literal notranslate"><span class="pre">(CONFIG_SMP_NCPUS-1)</span></code>). (CPU 0 is already active).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Zero (OK) is returned on success; a negated errno value on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt id="c.up_cpu_pause">
int <code class="sig-name descname">up_cpu_pause</code><span class="sig-paren">(</span>int <em>cpu</em><span class="sig-paren">)</span><a class="headerlink" href="#c.up_cpu_pause" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Save the state of the current task at the head of the
<code class="docutils literal notranslate"><span class="pre">g_assignedtasks[cpu]</span></code> task list and then pause task execution on the CPU.</p>
<p>This function is called by the OS when the logic executing on
one CPU needs to modify the state of the <code class="docutils literal notranslate"><span class="pre">g_assignedtasks[cpu]</span></code>
list for another CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> – The index of the CPU to be paused. This will not be
the index of the currently executing CPU.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Zero (OK) is returned on success; a negated errno value on failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt id="c.up_cpu_resume">
int <code class="sig-name descname">up_cpu_resume</code><span class="sig-paren">(</span>int <em>cpu</em><span class="sig-paren">)</span><a class="headerlink" href="#c.up_cpu_resume" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Restart the cpu after it was paused via up_cpu_pause(),
restoring the state of the task at the head of the
<code class="docutils literal notranslate"><span class="pre">g_assignedtasks[cpu]</span></code> list, and resume normal tasking.</p>
<p>This function is called after <code class="docutils literal notranslate"><span class="pre">up_cpu_pause()</span></code> in order
resume operation of the CPU after modifying its
<code class="docutils literal notranslate"><span class="pre">g_assignedtasks[cpu]</span></code> list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> – The index of the CPU being resumed. This will not be
the index of the currently executing CPU.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Zero (OK) is returned on success; a negated errno value on failure.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Apache Software Foundation

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>