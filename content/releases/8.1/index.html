

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>8.1</title>
    
    <meta name="author" content="">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/apache/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/apache/css/style.css?body=1" rel="stylesheet" type="text/css">
    <link href="/assets/themes/apache/css/syntax.css" rel="stylesheet"  type="text/css" media="screen" />
    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

  </head>

  <body>

        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
              <img src="/assets/themes/apache/img/logo.png" width="30">
              Apache NuttX
          </a>
        </div>
        <nav class="navbar-collapse collapse" role="navigation">
          <ul class="nav navbar-nav navbar-right">
            <li id="community">
              <a href="#" data-toggle="dropdown" class="dropdown-toggle">Community<b class="caret"></b></a>
               <ul class="dropdown-menu dropdown-left">
                <li><a href="/community">Get Involved</a></li>
                <li><a href="/community-members">Who we are</a></li>
               </ul>
            </li>
	    <li><a href="/docs/latest">Documentation</a></li>
            <li><a href="https://github.com/apache/incubator-nuttx">GitHub</a></li>
            <li id="apache">
              <a href="#" data-toggle="dropdown" class="dropdown-toggle">Apache<b class="caret"></b></a>
               <ul class="dropdown-menu">
                <li><a href="http://www.apache.org/foundation/how-it-works.html">Apache Software Foundation</a></li>
                <li><a href="http://www.apache.org/licenses/">License</a></li>
                <li><a href="http://www.apache.org/security/">Security</a></li>
                <li><a href="http://www.apache.org/events/current-event">Events</a></li>
                <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                </ul>
            </li>
          </ul>
        </nav><!--/.navbar-collapse -->
      </div>
    </div>




    <div class="container">
      

<!--<div class="hero-unit 8.1">
  <h1></h1>
</div>
-->

<div class="row">
  <div class="col-md-12">
    <!--

-->

<h2 id="nuttx-81-release-notes">NuttX-8.1 Release Notes</h2>

<p>The 132nd release of NuttX, Version 8.1, was made on September 15, 2019,
and is available for download from the Bitbucket.org website.  Note
that release consists of two tarballs:  nuttx-8.1.tar.gz and
apps-8.1.tar.gz.  These are available from:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://bitbucket.org/nuttx/nuttx/downloads
https://bitbucket.org/nuttx/apps/downloads
</code></pre></div></div>

<p>Both may be needed (see the top-level nuttx/README.txt file for build
information).</p>

<p>The major release version number is only incremented when there is a major
change to the OS that makes it more-or-less incompatible with preceding
versions.  This release bumps the major version number from 7 to 8 due
primarily to a major reorganization in the what was the configs/ directory
in nuttx-7.31.  That directory has been renamed boards/ and now has a
directory structure that mirrors the organization of the arch/ directory
for the most part:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>board/ - Holds all board-related information
board/&lt;arch&gt; - Holds board-related information for all boards that use
  the same CPU architecture.  For example, all ARM-based boards will be
  found under board/arm
board/&lt;arch&gt;/&lt;chip&gt; - Holds board-related information for all boards
  that use the same MCU chip family.  For example, all STM32-based
  boards will be found under board/arm/stm32
board/&lt;arch&gt;/&lt;chip&gt;/&lt;board&gt; - Holds board-related information for a
  specific board.  This is analogous to the configs/&lt;board&gt; directory in
  nuttx-7.31.  So, for example, the STM32F4-Discovery board support that
  was at configs/stm32f4disovery can now be found under
  boards/arm/stm32/stm32f4discovery.
boards/&lt;arch&gt;/&lt;chip&gt;/&lt;board&gt;/&lt;configs&gt; - All configurations for a
  specific board can now be found together in this configs/
  subdirectory.  So, continuing the example, the STM32F4-Discovery NSH
  configuration can now be found at
  boards/arm/stm32/stm32f4discovery/configs/nsh.
</code></pre></div></div>

<p>In additional, common MCU logic can be found at board/<arch>/<chip>/common
and MCU common drivers can be found at board/<arch>/<chip>/common.  Related
changes include changes to tools/, comments, and documentation that depend
on the board directory structure.</chip></arch></chip></arch></p>

<p>This re-organization is the work of Alin Jerpelea.  Not only did Alin do
this major directory re-organization, but he ran the code standard
compliance tool and corrected every .c and .h file under boards/ so that
they all correctly follow the NuttX coding style.  These changes were very
extensive and, hence, will not be addressed individually in the ReleaseNotes.</p>

<p>You have to give Alin credit for his effort to take on really big jobs and
stick with it until it is finished.  Kudos!</p>

<p>A more constrained re-organization of the drivers/ directory was also
contributed by Augusto Fraga Giachero.  Augusto reorganized some driver
directories to make better functional associations and also to make space
for a new set of RF-related drivers.</p>

<h2 id="additional-new-features-and-extended-functionality">Additional new features and extended functionality:</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* Core OS:

  - POSIX Message Queues:  Add a test to verify that message queue is
    closed by the same task group that opened it.  If not, then list
    corruption would result.  This test is only performed if
    CONFIG_DEBUG_FEATURES is enabled since it should not normally be an
    issue:  It would be a strange programming practice to open a
    message queue in open task group, then close it in another.  From
    ê¹ì ì°¬.
  - Signal Notifications:  Add configuration option to select either the
    high-priority or low-priority work queue for SIG_EVTHREA
    notifications.  From ligd.
  - System Calls:  In order to support built-in in function in protected
    mode, a task_spawn() system call must be supported.  task_spawn()
    and posix_spawn() are NuttX OS interfaces.  In PROTECTED and KERNEL
    build modes, then can be reached from applications only via a system
    call.  Unfortunately this is overly complex because there is a (soft)
    limit of 6 parameters in a system call; task_spawn has seven
    parameters.  This is a soft limit but still difficult to extend
    because it involves assembly language changes to numerous
    architectures.  Better to get more creative.  Rather than extend the
    maximum number of parameters across all architectures, I opted
    instead to marshal the seven parameters into a structure and pass
    only a single parameter:  A pointer to the structure containing the
    seven marshaled parameters.  From Gregory Nutt.
  - /etc/passwd and /etc/group:  Improve the format of the /etc/passwd
    file as used in the sim:nsh configuration.  It is now a little
    more similar to other systems and includes user and group IDs.  Add
    also an /etc/group file to support future testing.  From Gregory
    Nutt.
  - User/Group IDs:  Implement 'real' setuid, getuid, setgid, and getgid
    interfaces is so configured (otherwise fall back to stubs that
    support only the 'root' user ID and group.  Once set, these IDs will
    be inherited by all child task groups.  From Gregory Nutt.
  - Debug Output:  Add debug macros for contactless.  The various
    contactless device drivers currently define device specific debug
    macros within their local header files.  This patch adds generic
    ctls[info|warn|err] macros for the overall contactless subsystem to
    be used in future drivers.  Ported the existing contactless device
    drivers to use these generic logging macros and fixed some logging
    bugs along the way.  From Michael Jung.
  - IOB instrumentation.  Introduces producer/consumer id to every IOB
    call.  This is so that the calls can be instrumented to monitor the
    IOB resources and to collect usage statistics.  From Anthony
    Merlino.
  - IOB ProcFS:  Adding ProcFS support at /proc/iobinfo to show the data
    collected from the IOB instrumentation.  From Anthony Merlino.
  - Versioning:  Report GIT information via ProcFS.  GIT info reported:
    branch, version, GIT hash, hostname, user, build date.  Integrates
    into existing .version and ProcFS.  From David Alessio.

* File System/Block and MTD Drivers:

  - BinFS:  The BinFS file system uses the same built-in library and
    built-in arrays as does NSH.  The built-in arrays are simple name-
    value pairs that map built-in function names with the user-space
    entry point.  In the FLAT build, the built-in arrays are available
    everywhere via the backdoor left open by the FLAT address space.
    In the PROTECTED build, however, the kernel must maintain its own
    reference to the user-space built-in array.  This commit adds those
    kernel globals and a new boardctl(BOARDIOC_BUILTINS) that can be
    used by applications to the provide the built-in list reference to
    the kernel.  From Gregory Nutt.
  - MMC/SD:  Added support for MMC (eMMC) bigger than 2 GB (Tested with
    IMXRT1050EVKB and samsung eMMC 16GB).
  - AT24CSxx:  Register a character driver for UUID of AT24CSxx chips.
    Allows the UUID to read as a file or displayed from an nsh prompt with:
    nsh&gt; hexdump /dev/eeprom.uuid  From David Alessio.
  - Macronix FLASH:  Add support for 4-byte addressing on &gt;128Mb
    Macronix flash parts  From jjlange.
  - MX25Rxx:  Add support for 512B sectors.  From Simon Piriou.
  - SST26:  Accept the 16MBit Flash when reading the JEDEC-ID at
    initialization time.  From Ouss4.

* Network/Network Drivers:

  - IPv4 Options:  Now handles reception of IPv4 packets with larger
    IPv4 headers containing options.  From Gregory Nutt.
  - Sockets:  Re-order the content of all address-family socket
    'connection' structures so that they begin with a common prologue.
    This permits better use of logic for different address family
    types.  From Gregory Nutt.
  - TCP:  Make RTO and WAIT_TIME configurable.  This fix is not really
    correct:  TCP RTO really should be calculated dynamically for each
    TCP connection:  http://sgros.blogspot.com/2012/02/calculating-tcp-rto.html.
    From zhangyuan7.
  - IP Forwarding:  Check if interface is up early on when forwarding to
    avoid extra work.  As noticed in a previous wireless commit, when
    forwarding is enabled and a packet comes in, the packet is attempted
    to be sent on each other netdev without regard for whether it is in
    the UP state.  Of course this is eventually caught, but it can be
    caught earlier to avoid unnecessary work, especially in the 6LoWPAN
    case where a useless packet conversion will occur.  From Anthony
    Merlino.
  - RNDIS:  Expose option to change the number of write requests that
    can be in flight.  From Anthony Merlino.
  - GS2200M:  Add UDP support.  From Masayuki Ishakawa
  - GS2200M:  Implement GS2200M_IOC_IFREQ IOCTL command.  From Masayuki
    Ishikawa.
  - GS2200M:  Enable NuttX's DHCP client instead of GS2200M's DHCP
    client.  From Masayuki Ishikawa.
  - GS2200M:  GS2200M now supports SIOCGIFHWADDR  From Masayuki
    Ishikawa.

* Wireless/Wireless Drivers:

  - IEEE802.15.4 Network Driver:  Allow 64-bit prefix to be configurable
    when auto-configuring the IPv6 address during bring-up.  Previously,
    only the link-local prefix fe80::/64 was used.  Also, put the
    network in the DOWN state at the end of initialization.  From
    Anthony Merlino.
  - IEEE 802.15.4 MAC:  Adds support for energy detect.  Adds support
    for energy detect by introducing a new radio call/callback, as the
    PHY layer is required to perform the energy detect.  From Anthony
    Merlino.
  - IEEE 802.15.4 MAC:  Adds support for getting/setting
    macMaxFrameRetries via IOCTL.  Add get support for rxonidle
    attribute  From Anthony Merlino.
  - IEEE 802.15.4 MAC:  Move the global iobuffer into the macnet struct
    so that more than one macnet device can exist.  From Anthony
    Merlino.
  - IEEE 802.15.4 MAC:  Defer handling of extracting association
    response to LPWORK queue.  From Anthony Merlino.
  - IEEE 802.15.4 Radios:  Support dynamic FCS length.  Adds
    IEEE802154_ATTR_PHY_FCSLEN.  This change introduces
    IEEE802154_ATTR_PHY_FCSLEN which the radio layer can support to
    set/get the FCS length that's added to the end of the frame.  One
    use case, in promiscuous mode, is to add back in the FCS of the
    received frame by increasing the iob-&gt;io_len by the FCS length.
    From Anthony Merlino.
  - Xbee:  Support "WR" AT command for writing parameters to non-
    volatile memory.  From Anthony Merlino.
  - Xbee:  Add configuration option for setting the default prefix
    to use when bringing up the network and setting the IP address.
    From Anthony Merlino.

* Other Common Device Drivers:

  - RTC:  If the RTC time is successfully set, then update the current
    system time to match.  From ligd.
  - ADT7320:  Add support for the ADT7320 temperature sensor.  From
    Augusto Fraga Giachero.
  - DAC7554:  Add support to the DAC7554 digital-to-analog converter.
    From Augusto Fraga Giachero.
  - DAT-31R5-SP+: Add support to the DAT-31R5-SP+ digital attenuator.
    Creates a the new device driver directory drivers/rf/ to support
    drivers related to RF peripherals.  It also adds support for the
    DAT-31R5-SP+ digital attenuator.  From Augusto Fraga Giachero.
  - ISL29023:  Add basic driver of ISL29023 ambient light sensor.  The
    basic driver can set operational mode, range, and resolution.  It
    can also read lux value in continuous mode. Interrupt and the alarm
    is not implemented.  From Matous Pokorny.
  - SHT3x:  Add Sensirion SHT3x driver.  From Markus Bernet.

* Simulator:

  - Simulator Build:  Even though the simulation has no "chips", it
    needs to have CONFIG_ARCH_CHIP and chip sub-directories.  Otherwise,
    we would have to treat it as a special case in the build system
    after the changes to the boards/ directory.  From Gregory Nutt.

* Microchip PIC32MZ:

  - PIC32MZ.  Make the PLL input clock configurable.  From Ouss4.

* ARMv7-M

  - Add ARMv7-M setjmp/longjump functions.  From David S. Alessio.

* NXP i.MXRT:

  - i.MXRT Clocking:  Enable TRACE clocks if the divider has been
    defined in the board's board.h file.  From Dave Marples.

* NXP i.MXRT Drivers:

  - i.MXRT QEncoder:  Adds quadrature encoder driver for IMXRT.  From
    Nicholas Chin.
  - i.MXRT uSDHC:  This change completes SDIO support for IMXRT, and
    also adds support for WiFi using the AP6212A module based on Simon
    Piriou's rather excellent work. The patch should also address
    DavidS's concern about width setting for USDHC1 and 2.  Testing of
    the WiFi is minimal so far but functionality is proven.  I'm
    specifically not happy that the driver doesn't recover elegantly
    from a DMA data checksum failure, but that is an issue that can be
    dealt with in due course ... I'm trying to get the rest of the
    interfaces fleshed out and the hardware proven so it can go for pre-
    production build. I _think_ there's only Bluetooth and USB-device
    left to implement now.  From Dave Marples.
  - i.MXRT uSDHC:  IMXRT uSDHC driver cmd line reset logic modified.
    From Ivan Ucherdzhiev.

* NXP/Freescale Kinetis Drivers:

  - Kinetis Serial:  Add possibility to specify pull-up instead of
    open drain for serial single-wire mode.  From Beat KÃ¼ng.

* NXP LPC17xx/40xx:

  - LPC17xx/40xx Build:  Cortex-M system reset is applicable to
    LPC17xx/40xx too.  From Pavel Pisa.

* NXP LPC17xx/40xx Drivers:

  - LPC17xx/40xx Ethernet:  Follow the procedure listed in the
    LPC176x/5x User Manual when reading from and writing to the PHY's
    registers (section 10.11.14). I couldn't see any behavioral change
    after this commit, but nonetheless is a good practice to follow the
    manufacturer's recommended procedure.  From Augusto Fraga Giachero.

* NXP S31K1xx:

  - Added architecture support for the NXP S32K1xx family.  Basic
    support includes the boot up logic, clock configuration, LPUART
    console, Systick timer, GPIO controls, and eDMA (unverified).

* NXP S31K1xx Drivers:

  - S32K1xx eDMA  Leverage eDMA logic from i.MXRT to S32K1XX.  Appears
    to be the same IP but with fewer channels and features than the
    i.MXRT implementation.  From Gregory Nutt.
  - S32K1xx LPUART:  Bring in the LPUART from i.MXRT.  It is the same
    IP.  From Gregory Nutt.
  - S32K1xx SysTick:  Bring in Cortex-M0+ SysTick and interrupt handling
    from samd2l2; bring in Cortex-M4F Systick and interrupt handling
    from LPC54xx.  From Gregory Nutt.
  - S32K1xx GPIO:  Bring in GPIO logic from Kinetis.  Looks like similar
    IP.  From Gregory Nutt.
  - S32K1xx Ethernet:  Unverified port of the i.MXRT Ethernet driver to
    the S32K1xx.  The i.MXRT uses the same IP.  From Gregory Nutt.
  - S32K1xx LPSPI and LPI2C:  Brings in the LPSPI and LPI2C peripheral
    drivers from the i.MXRT which used the identical IP.  From Gregory
    Nutt.

* NXP S31K1xx Boards:

  - S32K118EVB.  This commit adds initial board support for the NXP
    S32K118EVB development board.  Currently supports only a minimal
    NSH configuration.  From Gregory Nutt.
  - S32K118EVB:  Implement board support for on-board LEDs and buttons.
    This is taken from the Freedom-K66f with has the same LED and
    button configuration as the S32K116EVB and uses the same GPIO IP.
    LEDs, but not buttons, have have been verified.  From Gregory Nutt.
  - S32K146EVB:  Adds initial board support for the S32K146EVB
    development board.  Currently supports a NSH configuration with a
    richer feature set than the minimal configuration of the S32K118EVB.
    From Gregory Nutt.
  - S32K146EVB:  Add support for execution out of SRAM.  This is helpful
    for bring-up when you want to avoid putting a lethal image in FLASH.
    From Gregory Nutt.
  - S32K148EVB:  Add support for the NXP S32K148EVB development board.
    Very similar to the S32K146EVB but with more on-chip memory and
    hardware features.

* Sony CXD56xx

  - CXD56xx:  Migrate CXD56xx common code to the common/ directory:
    Boot code, FLASH code, I2C driver, UID.  From Alin Jerpelea.
  - CXD56xx:  Add SPH.  The SPH is used by the ASMP implementation from
    the SDK.  From Alin Jerpelea.

* Sony CXD56xx Drivers:

  - CXD56xx:  Add sensors connected to the SCU on Spresense board:
    o Avago APDS9930 Proximity and Ambient light Sensor.
    o Rohm BH1721FVC Ambient Light Sensor.
    o Rohm BH1745NUC Color Sensor.
    o Rohm BM1383GLV/BM1383AGLV Pressure Sensor.
    o Rohm BM1422GMV/BM1422AGMV Magnetic Sensor.
    o Bosch BMI160 Sensor support.
    o Bosch BMP280 Barometic Pressure Sensor.
    o Kionix KX022/KX122 Acceleration Sensor.
    o Murata LT1PA01 Proximity and Ambient light Sensor.
    o Rohm RPR0521RS Proximity and Ambient light Sensor.
    o BMI160: add optional I2C address.
    From Alin Jerpelea.
  - CXD56xx:  Add the sensor initialization for CXD56xx boards in the
    common board folder:
    o APDS9930: typo fix
    o cxd56_ak09912 initialization.
    o cxd56_bmi160 initialization.
    o cxd56_apds9960 initialization.
    o cxd56_bh1721fvc initialization.
    o cxd56_bh1745nuc initialization.
    o cxd56_bm1383glv initialization.
    o cxd56_bm1422gmv initialization.
    o cxd56_bmi160 initialization.
    o cxd56_bmp280 initialization.
    o cxd56_kx022 initialization.
    o cxd56_lt1pa01 initialization.
    o cxd56_rpr0521rs initialization.
    o cxd56_sensors initialization.
    o Backup Log driver.
    o crashlog driver.
    o Move gs2200m initialization.
    o Move ili9340 initialization.
    o Move lpm013m091a initialization.
    From Alin Jerpelea.

* Sony CXD56xx Spresense Board:

  - Spresense:  Enable SmartFS and UDP support  From Masayuki Ishikawa.

* STMicro STM32:

  - STM32F4 PLLI2S:  Add support to enable the I2S Phase Locked Loop on
    STM32F427 and STM32F437 MCUs.  From Michael Jung.

* STMicro STM32 Drivers:

  - STM32 ADC:  Add ADC calibration procedure for IP_ADC_V1.  Tested on
    STM32F100, and it magically increased result accuracy.  STM32F103
    has the same calibration procedure.  I am not sure about others.
    From Matous Pokorny.
  - STM32 SPI:  TI Synchronous Serial Frame Format.  The SPI macros on
    STM32 MCUs now support the Texas Instruments Synchronous Serial
    Frame Format protocol (TI protocol).  Defined a new SPIDEV_MODETI
    and add support for it in stm32_spi.c.  From Michael Jung.
  - STM32 UART:  Serial add HW HS on UART 4 &amp; 5.  From David Sidrane.
  - STM32 PWM:  Configure multi-channel duty only if channel specified.
    This allows you to update duty cycle for a single channel.   From
    Mateusz Szafoni.
  - STM32F7 Ethernet:  Add a timeout on MAC reset  From David Sidrane.
  - STM32F7 FLASH:  Exposes stm32_flash_xxx functions.  From Anthony
    Merlino.
  - STM32F7 PWM:  Configure multi-channel duty only if channel specified.
    This allows you to update duty cycle for a single channel.   From
    Mateusz Szafoni.
  - STM32F7 UART:  Serial add HW HS on UART 4 &amp; 5.  From David Sidrane.
  - STM32H7 ADC:  Fix internal channel numbers.  From Markus Bernet.
  - STM32H7 BBSRAM:  Add BBSRAM support.  From David Sidrane.
  - STM32H7 DTCM:  Port DTCM from F7  From David Sidrane.
  - STM32H7 I2C:  Select ARCH_HAVE_I2CRESET in configuration.  From
    David Sidrane.
  - STM32H7 PWM:  Configure multi-channel duty only if channel
    specified.  This allows you to update duty cycle for a single
    channel.  From Mateusz Szafoni.
  - STM32H7 RCC:  Fix RCC register definitions and typos for ADC/UART.
    From Markus Bernet.
  - STM32H7 RTC:  Ported over F7 RTC.  From David Sidrane.
  - STM32H7 SPI:  Allow more clock sources.  From David Sidrane.
  - STM32H7 UART:  Serial add HW HS on UART 4 &amp; 5.  From David Sidrane.
  - STM32H7 UART:  Fix typo in UART8 configuration.  From Markus Bernet.
  - STM32H7 UID:  Ported UID from F7  From David Sidrane.
  - STM32L4 PWM:  Configure multi-channel duty only if channel specified.
    This allows you to update duty cycle for a single channel.   From
    Mateusz Szafoni.
  - STM32L4 UART:  Serial add HW HS on UART 4 &amp; 5.  From David Sidrane.

* STMicro STM32 Boards:

  - B-L475E-IOT01A:  Add mx25rxx memory chip and smartfs support in NSH
    configuration.  From Simon Piriou.
  - LX_CPU:  Add support for the PIKRON LX_CPU board.  From Pavel Pisa.
  - Nucleo-F303RE:  Add basic NSH configuration.  From Mateusz Szafoni.
  - Nucleo-F303RE:  Enable console on UART2 and set entry point to
    nsh_main() in the PWM configuration.  From Mateusz Szafoni.
  - Nucleo-H743ZI:  Add RTC support.  From David Sidrane.
  - Nucleo-L432KC:  Added GPIO drivers for use with /apps/examples/gpio.
    From Daniel P. Carvalho.
  - Nucleo-L432KC:  Added Zero Cross sensor to nucleo-l432kc.  From
    Daniel P. Carvalho.

* TI Tiva:

  - Tiva:  Add support for Tiva TM4C123AH6PM.  From Nathan Hartman.
  - Tiva Configuration:  Modify preprocessor logic to support
    configurations with no UART.  Now similar to logic for other
    architectures.  From Nathan Hartman.
  - Tiva Interrupts:  Add handling for IRQs 128 thru 159.  From Nathan
    Hartman.

* TI Tiva Drivers:

  - TM4C QEncoder:  Reinstate TM4C qencoder driver and expand its
    ioctls. Add TIVA_HAVE_QEI0, TIVA_HAVE_QEI1 as applicable to each
    ARCH_CHIP_TM4C12*.  Rewrite tiva_qe_setup().  Replace tiva_qe_ppr()
    with tiva_qe_resetatppr().  Add tiva_qe_resetatmaxpos() and
    tiva_qe_resetatindex().  Add missing definitions:
    SIGMODE_QUADRATURE, SIGMODE_CLK_AND_DIR, SWAP_NO_SWAP, SWAP_PHA_PHB.
    Rename TIVA QEI ioctl QEIOC_PPR to QEIOC_RESETATPPR; add TIVA QEI
    ioctl identifiers QEIOC_RESETATMAXPOS, QEIOC_RESETATINDEX.  From
    Nathan Hartman.

* TI Tiva Boards:

  - TM4C1294-Launchpad:  Enables /dev/userleds in board bring-up for
    tm4c1294-launchpad by calling userled_lower_initialize() in
    tm4c_bringup().  From Nathan Hartman.

* TI Tiva Drivers:

  - Tiva GPTM timers:  Implement 16-bit PWM mode.  Add
    tiva_pwm16_sel_event() to choose GPTMCTL.TnEVENT value.  Implement
    tiva_pwm_mode16().  This also involved numerous corrections to the
    16-bit timer logic.  Add tiva_timer16pwm_setperiodduty() to set
    initial period, duty cycle, and enable interrupts if requested in
    GPTM peripheral. Interrupts are not enabled in NVIC until
    tiva_timer16_start() is called.  Add tiva_timer16pwm_setduty() to
    update duty cycle at any time.  Add new TIMER_FLAG_* configuration
    flags to enable configuring the 16-bit PWM feature.  Extend type of
    "flags" in tiva_timer32config_s and tiva_timer16config_s from 8- to
    32-bits to allow more flags.  From Nathan Hartman.

* Build System:

  - Export Build:  Export all variables/files to support architecture
    independent build against NSH.  From Pavel Pisa.
  - Application Export:  This change too build tools allows to export
    built-in applications registry into temporarily created directory
    where export archive content is prepared.  If the Makefile in apps/
    directory does not define export:  target then error is print but
    export continues without interruption. It would be more logical to
    print warning but there is no way instruct apps make to not print
    error.  From Pavel Pisa.
  - boards/Board.mk:  Add support to pass dependency paths.  From
    Gregory Nutt.

* Libraries/Header Files:

  - libs/libc/libc.csv:  Add some missing C library functions.  From
    Pavel Pisa.
  - libs/libc/libc.csv: Add ioctl() to fs_ioctl() wrapper for varidic
    case.  From Pavel Pisa.
  - libs/libc/builtin/:  Moves shared built-in information out of
    binfmt/libbuiltin and into libs/libc/builtin where it can be shared
    with applications.  This should permit built-in application in the
    PROTECTED build where binfmt/libbuiltin was not available in user
    space.  From Gregory Nutt.
  - libs/libc/dirent/:  Added alphasort() implemenation, scandir()
    implementation and DT_* definitions to include/dirent.h.  Apparently
    those definitions are not required by POSIX, but are part of
    4.3BSD and available in glibc as well.  From Michael Jung.
  - libs/libc/grp/:  Added stubbed implementations of getgrgid,
    getgrgid_r, getgrnam, getgrnam_r, and initgroups.  These functions
    are essentially stubs pretending that NuttX supported groups and
    that the only configured group in the system was 'root' with gid 0.
    The intend is not to provide meaningful new features, but to ease
    porting of foreign source code to NuttX.  From Michael Jung.
  - libs/libc/machine/arm/armv7-m/:  Add Cortex M4F machine optimized
    fabsf and sqrtf.  From David S. Alessio.
  - libs/libc/pwd/:  Added stubbed implementations.  Added stubbed
    implementations of getpwuid, getpwuid_r, getpwnam, and getpwnam_r.
    These functions are essentially stubs pretending that NuttX
    supported users and that the only configured user in the system
    was 'root' with uid 0.  The intend is not to provide meaningful
    new features, but to ease porting of foreign source code to NuttX.
    From Michael Jung.
  - libs/libc/pwd and libs/libc/grp/:  Modify to get user/group data
    from /etc/passwd and /etc/group if so configured.  From Gregory
    Nutt.
  - libs/libc/stdio/:  Add support for the size_t integer qualifier 'z'
    to the printf family.  This is kind of tricky due the variety of
    sizeof(size_t) on different platforms.  From David Sidrane.
  - libs/libc/unistd.h:  Added stubbed implementations of setuid() and
    setgid().  These functions are essentially stubs pretending that
    NuttX supported users and groups and that the only configured user
    and group in the system were both 'root' with a uid and a gid of 0,
    respectively.  The intent is not to provide meaningful new features,
    but to ease porting of foreign source code to NuttX.  From Michael
    Jung.
  - libs/libc/unistd/:  Add getuid() and getgid() stubs to match
    MichaelJung's setuid() and setgid().  From Gregory Nutt.
  - libc/libc/unistd/:  Add stubs for geteuid(), getegid(), seteuid(),
    setegid(), setreuid(), and setregid().  NuttX does not currently
    support effective user/group IDs, but these stubs will support
    linkage of applications that expect these POSIX standard interfaces.
    From Gregory Nutt.

* Symbol Tables:

  - NuttX provides lists of available syscalls and library functions and
    tools to process them.  The lists can be used to build symbol table
    which allows runtime program loading which can reuse functions
    already compiled into NuttX system image.  List processing,
    compilation and linking to the final system image has been possible
    only under manual control until now.  Provided changes add option
    (CONFIG_EXECFUNCS_GENERATE_SYSTEM_SYMTAB) to build complete list of
    available functions and syscalls automatically.  The symbolic table
    is generated in form libsymtab.a which can be reused by application
    or directly pull in when "g_symtab" and "g_nsymbols" variables are
    requested by EXECFUNCS configuration.  I have tried to follow
    mechanisms for library compilation in different kernel protection
    modes but tested only flat no-MMU build. The basic assumption is
    that this library and libraries providing syscall stubs and C-
    library functions are available in user-space context and initial
    application (usually NSH) registers the symbol table through IOCTL.
    The table can be reused then by another applications in their
    address space as kernel allows. Simple for flat or protected mode,
    I am not sure if really support in MMU mode. It is highly probable
    that I have made some mistake, overlooked something, but the
    functionality is optional (should not cause troubles in any mode if
    disabled) and main purpose is to lower memory overhead when more
    applications are loaded on memory constrained system which usually
    use direct kernel calling without protection or address space
    separation. If the table should be provided by kernel to
    applications then makefiles has to be adjusted.  From Pavel Pisa.

* Tools:

  - tools/:  Change preferred argument of configurations tools to use
    ':' as the delimiter between &lt;board-name&gt; and &lt;config-name&gt;.  This
    is to emphasize that this is not a path; it is configuration
    specification.  The legacy '/' delimiter is still supported but
    not recommend and not advertised.  Updated configurations
    instructions in README.txt files to show ':' delimiter vs '/'
    delimiter.  Update all configuration-related tools to accept ':'
    separator between board and configuration name.  From Gregory Nutt.

* apps/ General:

  - Makefile:  Added support for application-specific export target.
    Used by nuttx/tools/mkexport.sh.  From Pavel Pisa.
  - apps/builtins:  Move apps/builtins/builtin_forindex.c to
    nuttx/libs/libc/builtin since it is required by kernel logic as
    well.  Other changes account for movement of builtin.h from
    nuttx/include/nuttx/binfmt/built.h to nuttx/include/lib/builtin.h.
    From Gregory Nutt.

* Examples/Tests: apps/examples:

  - apps/examples/uid:  Demo used to verify PASSWD and GROUP interfaces.
    From Gregory Nutt.
  - apps/examples/webserver/:  Initialilze network and run forever only
    if not built-in app.  Infer from CONFIG_NSH_BUILTIN_APPS if we are a
    NSH built-in app or not.  If built-in app (CONFIG_NSH_BUILTIN_APPS
    defined) then we assume network is initialized prior to webserver
    starting and we exit on webserver failure.  If running standalone
    (CONFIG_NSH_BUILTIN_APPS is undefined) then behavior is unchanged:
    webserver initializes network and runs forever.  From Nathan Hartman.

* Network Utilities: apps/fsutils:

  - apps/fsutils/passwd:  Handle the improved the format of the
    /etc/passwd file.  It is now a little more similar to other systems.
    From Gregory Nutt.

* Network Utilities: apps/netutils:

  - apps/netutils/dhcpc:  Add host name support to DHCP client.  From
    Masayuki Ishikawa.

* Network Utilities: apps/wireless

  - apps/wireless/ieee802154/i8sak:  I8sak improvements:  (1) Adds
    support for getting/setting maxretries and promsicuous mode from
    i8sak, (2) Fixes a build warning and handles a few cases where a
    fault can occur due to not catching missing arguments.  From
    Anthony Merlino.
  - apps/wireless/ieee802154/i8sak:  Allow setting the endpoint PAN ID.
    From Anthony Merlino.
  - apps/wireless/ieee802154/i8sak:  Adds support for energy scan result
    printout.  From Anthony Merlino.
  - apps/wireless/ieee802154/i8shark:  Adds support for intentionally
    suppressing passing the FCS so that Wireshark doesn't try to
    validate it.  From Anthony Merlino.
  - apps/wireless/ieee802154/libmac:  Adds support for getting/setting
    the FCS length  From Anthony Merlino.
  - apps/wireless/gs2200m:  Add UDP support to the GS2200M driver.  From
    Masayuki Ishikawa.
  - apps/wireless/gs2200m:  Add DHCP client handling in ioctl_request().
    From Masayuki Ishikawa.
  - apps/wireless/gs2200m:  ioctl_request() supports SIOCGIFHWADDR.
    From Masayuki Ishikawa.
</code></pre></div></div>

<h2 id="bugfixes">Bugfixes:</h2>
<p>Only the most critical bugfixes are listed here (see the ChangeLog for a
more complete list of bugfixes and for additional, more detailed bugfix
information):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">*</span> <span class="n">Core</span> <span class="n">OS</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">Priority</span> <span class="n">Inheritance</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">a</span> <span class="n">race</span> <span class="k">in</span> <span class="n">telnet</span> <span class="k">with</span> <span class="n">PRIORITY_INHERITANCE</span>
    <span class="k">and</span> <span class="n">SCHED_HPWORK</span><span class="p">.</span>  <span class="n">Sometimes</span> <span class="n">causes</span> <span class="n">an</span> <span class="n">assertion</span> <span class="k">to</span> <span class="n">fire</span> <span class="n">incorrectly</span><span class="p">.</span>
    <span class="k">From</span> <span class="n">David</span> <span class="n">S</span><span class="p">.</span> <span class="n">Alessio</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Task</span> <span class="n">Groups</span><span class="p">:</span>  <span class="n">Correct</span> <span class="n">some</span> <span class="n">naming</span><span class="p">.</span>  <span class="n">The</span> <span class="n">NuttX</span> <span class="n">task</span> <span class="n">groups</span> <span class="n">have</span> <span class="n">been</span>
    <span class="n">using</span> <span class="n">the</span> <span class="n">acronym</span> <span class="s1">'gid'</span> <span class="k">and</span> <span class="n">also</span> <span class="n">the</span> <span class="n">type</span> <span class="s1">'gid_t'</span> <span class="n">for</span> <span class="n">the</span> <span class="n">the</span> <span class="n">task</span>
    <span class="n">group</span> <span class="n">ID</span><span class="p">.</span>  <span class="n">That</span> <span class="n">is</span> <span class="n">incorrect</span><span class="p">.</span>  <span class="n">Than</span> <span class="n">naming</span> <span class="n">is</span> <span class="n">reserved</span> <span class="n">for</span> <span class="n">use</span> <span class="k">with</span>
    <span class="n">group</span> <span class="n">permissions</span><span class="p">.</span>  <span class="n">So</span> <span class="n">these</span> <span class="n">were</span> <span class="n">all</span> <span class="n">named</span> <span class="k">to</span> <span class="n">grpid</span> <span class="k">and</span> <span class="n">grpid_t</span> <span class="n">so</span>
    <span class="n">that</span> <span class="n">it</span> <span class="n">is</span> <span class="n">clearer</span> <span class="n">that</span> <span class="n">these</span> <span class="n">refer</span> <span class="k">to</span> <span class="n">NuttX</span> <span class="n">task</span> <span class="n">group</span> <span class="n">IDs</span><span class="p">,</span> <span class="k">and</span> <span class="k">not</span>
    <span class="k">to</span> <span class="n">group</span> <span class="n">permissions</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Task</span> <span class="n">Termination</span><span class="p">:</span>  <span class="n">nxtask_signalparent</span><span class="p">()</span> <span class="k">in</span> <span class="n">task_exithook</span><span class="p">.</span><span class="n">c</span> <span class="n">may</span>
    <span class="n">invalidate</span> <span class="n">the</span> <span class="n">group</span><span class="s1">'s parent task ID (tg_ppid) too soon.  The
    tg_ppid field is use only to remember the parent tasks ID so that it
    can send the SIGCHLD signal to it.  So it must stay valid until
    SIGCHLD has been sent.  In nxtask_signalparent(), it calls
    nxtask_sigchild() to send SIGCHLD to the parent, then invalidates
    tg_ppid.  That would be okay, except that the SIGCHLD is only sent
    when the last member of the group terminates. That is incorrect;
    tg_ppid can be invalidated too soon and, as a consequence, SIGCHLD
    would never be sent.  Noted by Jeongchan Kim in the Google group:
    https://groups.google.com/forum/#!topic/nuttx/SXd8fVwVKBk  From
    Gregory Nutt.
  - sched_get_rr_interval():  sched_get_rr_interval() should return
    {0,0} if round-robin scheduling is not selected for the task.  From
    Gregory Nutt.
  - SMP Type Collision:  The non-standard, non-portable type cpu_set_t
    was created specifically to support the NuttX internal, SMP
    implementation.  Any resemblance to any other cpu_set_t would be
    purely coincidental.  However it appears that that coincidence has
    occurred.  cpu_set_t has an equivalent, non-standard, non-portable
    type in the GNU C library.  Compilation of libgnat expects this
    non-standard type to be defined.  Who am I to stand in the way of
    progress?  This commit removes the conditioning on CONFIG_SMP so
    that cpu_set_t is typed (as a uint8_t) even if CONFIG_SMP is not
    defined.  Reference:  Bitbucket issue 164.  From Gregory Nutt.
  - Binary Loader:  Change some debug macros from berr() to binfo()
    when dumping module data.  The report of problems is important
    during development but when it enables complete informative output
    about load binaries then the important information can be easily
    overlooked.  The huge output sent to serial terminal slows loading
    significantly as well.  From Pavel Pisa.
  - Power Management:  Fix g_pmcount 16-bits overflow when
    CONFIG_PM_XXENTER_COUNT set big value.  From ligd.
  - Timekeeping:  Fix cases in time conversion that must be &gt;=
    NSEC_PER_SEC, not &gt; NSEC_PER_SEC.  From Gregory Nutt.

* File System/Block and MTD Drivers:

  - opendir():  opendir() set errno to a negative value in one error
    case.  From Michael Jung.
  - SmartFS:  Update smartfs smart_scan() function.  From Simon Piriou.
  - ProcFS:  Add missing LF to cpuload procfs output  From David Alessio.
  - MMC/SD:  Copy/paste error fix in the SDIO-based block driver for
    MMC.  From Ivan Ucherdzhiev.
  - MMC/SD:  Correct a misplaced #endif in the SDIO-based driver.  From
    Gregory Nutt.

* Networking/Network Drivers:

  - Ethernet Configuration:  Ethernet packet buffer size cannot be
    permitted to go below 1294 if IPv6 is selected.  From Gregory Nutt.
  - TCP RST:  Fix outgoing RST packet with wrong ack number.  From
    biantao.
  - TCP Close:  Fix TCP close flow; free the connection after all TCP
    close process finished.  From zhangyuan7.
  - UDP Broadcast:  Remove net stack dependency from CONFIG_NET_BROADCAST.
    This change allows us to use CONFIG_NET_BROADCAST without network
    stack (i.e. usrsock application can use broadcast)  From Masayuki
    Ishikawa.
  - UDP:  Fixes a UDP send copy-paste error in the new SO_LINGER code:
    CONFIG_TCP_NOTIFIER to CONFIG_UDP_NOTIFIER.  From Juha Niskanen.
  - TCP and UDP:  Fix errors in the new implementation of SO_LINGER.
    The tcp_drain() and udp_drain() functions were casting the working
    argument to the wrong type, resulting in hangs and abnormal
    behavior.  There is a complexity in the TCP drain logic when the
    remote peer closes the socket before all Tx data has been flushed.
    Sometimes we are not notified of this case and wait the entire
    timeout unnecessarily.  There is a workaround in place in
    tcp_txdrain(), but this really should be revisited.  From Gregory
    Nutt.
  - 6LoWPAN:  Removes unnecessary conversions that were happening due to
    a misunderstanding of byte ordering with EUI-64.  From Anthony
    Merlino.
  - RNDIS:  Fix issue with DEBUGASSERT when using composite device and
    endpoint numbers not being the default.  From Anthony Merlino.

* Wireless/Wireless Drivers:

  - wireless network devices:  Attach radio to d_buf before registering
    device to handle forwarding case.  When CONFIG_NET_IPFORWARD is
    enabled, and CONFIG_NET_6LOWPAN is being used, a packet that
    attempts to get forwarded on the 6LoWPAN interface will require
    that the radio'</span><span class="n">s</span> <span class="n">buffer</span> <span class="n">be</span> <span class="n">attached</span> <span class="k">to</span> <span class="n">d_buf</span><span class="p">.</span> <span class="n">Otherwise</span> <span class="n">an</span> <span class="n">assertion</span>
    <span class="n">will</span> <span class="n">fire</span><span class="p">.</span>  <span class="n">The</span> <span class="n">underlying</span> <span class="s2">"radio"</span> <span class="k">in</span> <span class="n">this</span> <span class="k">case</span> <span class="n">is</span> <span class="n">the</span>
    <span class="n">mac802154_netdev</span><span class="p">.</span>  <span class="n">This</span> <span class="n">behavior</span> <span class="n">has</span> <span class="n">probably</span> <span class="k">not</span> <span class="n">been</span> <span class="n">observed</span>
    <span class="n">because</span> <span class="n">the</span> <span class="n">buffer</span> <span class="n">is</span> <span class="n">normally</span> <span class="n">attached</span> <span class="k">in</span> <span class="n">the</span> <span class="n">periodic</span> <span class="n">txpoll</span>
    <span class="n">worker</span><span class="p">.</span>  <span class="n">However</span><span class="p">,</span> <span class="k">in</span> <span class="n">my</span> <span class="k">case</span><span class="p">,</span> <span class="n">the</span> <span class="m">6L</span><span class="n">oWPAN</span> <span class="n">interface</span> <span class="n">was</span> <span class="k">not</span> <span class="n">UP</span> <span class="n">yet</span><span class="p">,</span>
    <span class="k">and</span> <span class="n">therefore</span> <span class="n">the</span> <span class="n">worker</span> <span class="n">hadn</span><span class="s1">'t run yet.  From Anthony Merlino.
  - IEEE 802.15.4 MAC:  Fixes issues with extended address. 1) Extended
    address should be read-only. 2) Extended address should be placed
    in frame in "reverse-canonical" order.  The extended address is a
    read-only attribute and thus an attempt to write the extended
    address should be denied. Instead, the extended address should
    really be either set by the PHY/radio itself, or provided at board
    bring-up time to the radio layer. The MAC layer now pulls in the
    extended address from the radio any time the MAC is reset.  The
    extended address is also supposed to be sent in the frame in
    reverse-canonical order. This is very confusing in the standard and
    it wasn'</span><span class="n">t</span> <span class="k">until</span> <span class="n">I</span> <span class="n">realized</span> <span class="n">it</span> <span class="n">was</span> <span class="n">backwards</span> <span class="k">in</span> <span class="n">Wireshark</span> <span class="n">that</span> <span class="n">I</span>
    <span class="n">researched</span> <span class="n">this</span> <span class="n">further</span><span class="p">.</span> <span class="n">Searching</span> <span class="n">online</span> <span class="n">I</span> <span class="n">find</span> <span class="n">documents</span> <span class="k">from</span> <span class="n">the</span>
    <span class="n">committee</span> <span class="n">for</span> <span class="n">suggestions</span><span class="p">/</span><span class="n">feedback</span> <span class="n">on</span> <span class="n">the</span> <span class="n">future</span> <span class="n">standard</span><span class="p">.</span>  <span class="n">It</span> <span class="n">isn</span><span class="s1">'t
    in the 2015 standard but a newer version of the standard will
    presumably clarify this. It says that the extended address should be
    written in reverse-canonical form, meaning the OUI comes last, not
    first inside the frame.  From Anthony Merlino.
  - IEEE 802.15.4 MAC:  Frame Version should have been 1, but was being
    set to 3 when payload exceeds version 0 capabilities.  Adds warning
    to build to indicate what is noted in the menu for
    CONFIG_MAC802154_NTXDESC  From Anthony Merlino.
  - IEEE 802.15.4 MAC:  Fixes issue where the txdesc'</span><span class="n">s</span> <span class="n">ackreq</span> <span class="n">flag</span> <span class="n">was</span>
    <span class="k">not</span> <span class="n">being</span> <span class="k">set</span><span class="p">,</span> <span class="n">despite</span> <span class="n">the</span> <span class="n">frame</span> <span class="n">containing</span> <span class="n">a</span> <span class="n">Frame</span> <span class="n">Control</span> <span class="n">field</span>
    <span class="k">with</span> <span class="n">ACKREQ</span> <span class="n">bit</span> <span class="k">set</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">logic</span> <span class="k">to</span> <span class="n">prevent</span> <span class="n">deadlock</span> <span class="n">scenario</span> <span class="n">when</span> <span class="n">there</span> <span class="n">are</span> <span class="n">no</span>
    <span class="n">available</span> <span class="n">IOBs</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span> <span class="p">(</span><span class="m">2018</span><span class="p">-</span><span class="m">12</span><span class="p">-</span><span class="m">21</span><span class="p">).</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Change</span> <span class="n">assumption</span> <span class="n">about</span> <span class="n">destination</span> <span class="n">address</span> <span class="n">mode</span> <span class="n">for</span> <span class="n">incoming</span>
    <span class="n">frames</span><span class="p">.</span>  <span class="k">If</span> <span class="n">a</span> <span class="n">short</span> <span class="n">address</span> <span class="n">has</span> <span class="n">been</span> <span class="n">assigned</span> <span class="k">to</span> <span class="n">our</span> <span class="n">radio</span><span class="p">,</span> <span class="k">then</span>
    <span class="n">assume</span> <span class="n">we</span> <span class="n">were</span> <span class="n">addressed</span> <span class="n">using</span> <span class="n">that</span><span class="p">.</span>  <span class="n">Otherwise</span> <span class="n">we</span> <span class="n">were</span> <span class="n">addressed</span>
    <span class="n">using</span> <span class="n">our</span> <span class="n">extended</span> <span class="n">address</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Initialize</span> <span class="n">the</span> <span class="n">short</span> <span class="n">address</span> <span class="k">to</span> <span class="n">the</span> <span class="n">unspecified</span> <span class="n">address</span> <span class="k">and</span>
    <span class="n">query</span> <span class="n">for</span> <span class="n">the</span> <span class="n">extended</span> <span class="n">address</span> <span class="n">on</span> <span class="n">initialization</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Anthony</span>
    <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Adds</span> <span class="n">CONFIG_XBEE_LOCKUP_WORKAROUND</span> <span class="n">option</span> <span class="k">and</span> <span class="n">corresponding</span>
    <span class="n">logic</span> <span class="k">to</span> <span class="n">workaround</span> <span class="n">an</span> <span class="n">issue</span> <span class="n">where</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">locks</span> <span class="n">up</span> <span class="k">and</span> <span class="n">stops</span>
    <span class="n">responding</span><span class="p">.</span>  <span class="n">This</span> <span class="n">typically</span> <span class="n">happens</span> <span class="n">when</span> <span class="n">there</span> <span class="n">is</span> <span class="n">a</span> <span class="n">lot</span> <span class="k">of</span> <span class="n">data</span>
    <span class="n">being</span> <span class="n">received</span> <span class="n">over</span> <span class="n">the</span> <span class="n">link</span><span class="p">.</span>  <span class="n">When</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">stops</span> <span class="n">responding</span><span class="p">,</span> <span class="n">many</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">querying</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">kicks</span> <span class="n">it</span> <span class="n">out</span> <span class="k">of</span> <span class="n">this</span> <span class="n">state</span><span class="p">.</span>  <span class="n">However</span><span class="p">,</span>
    <span class="n">occasionally</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">is</span> <span class="n">completely</span> <span class="n">locked</span> <span class="n">up</span> <span class="k">and</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">has</span> <span class="k">to</span>
    <span class="n">be</span> <span class="nb">reset</span><span class="p">.</span>  <span class="n">This</span> <span class="n">change</span> <span class="n">handles</span> <span class="n">these</span> <span class="n">conditions</span> <span class="n">by</span> <span class="n">periodically</span>
    <span class="p">(</span><span class="k">if</span> <span class="k">not</span> <span class="n">naturally</span> <span class="n">occurring</span><span class="p">)</span> <span class="n">querying</span> <span class="n">the</span> <span class="n">XBee</span><span class="p">.</span>  <span class="k">If</span> <span class="n">during</span> <span class="n">any</span>
    <span class="n">query</span><span class="p">,</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">does</span> <span class="k">not</span> <span class="n">respond</span> <span class="n">within</span> <span class="n">a</span> <span class="n">certain</span> <span class="n">number</span> <span class="k">of</span>
    <span class="n">attempts</span><span class="p">,</span> <span class="n">the</span> <span class="n">XBee</span> <span class="n">is</span> <span class="nb">reset</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Cancel</span> <span class="n">query</span> <span class="n">timeout</span> <span class="n">upon</span> <span class="n">receiving</span> <span class="n">the</span> <span class="n">expected</span> <span class="n">response</span><span class="p">.</span>
    <span class="n">Add</span> <span class="n">protection</span> <span class="n">for</span> <span class="n">race</span> <span class="n">condition</span> <span class="n">that</span> <span class="n">can</span> <span class="n">cause</span> <span class="n">association</span>
    <span class="n">timeout</span> <span class="k">to</span> <span class="n">continue</span> <span class="n">firing</span> <span class="n">repeatedly</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Detect</span> <span class="n">lockup</span> <span class="k">and</span> <span class="nb">reset</span> <span class="n">XBee</span> <span class="k">in</span> <span class="n">xbee_req_data</span>  <span class="k">From</span> <span class="n">Anthony</span>
    <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Xbee</span><span class="p">:</span>  <span class="n">Fixes</span> <span class="n">one</span> <span class="n">instance</span> <span class="k">of</span> <span class="n">the</span> <span class="n">use</span> <span class="k">of</span> <span class="n">IOBUSER_WIRELESS_MAC802154</span>
    <span class="n">which</span> <span class="n">isn</span><span class="s1">'t available without the software MAC layer.  Instead we
    use IOBUSER_WIRELESS_RAD802154 throughout the whole driver since it
    is always available when IEEE 802.15.4 support is enable.  From
    Anthony Merlino.

* Common Drivers:

  - pipes:  Use inode reference counter instead of device reference
    counter to handle dup().  I found that if I dup() a pipe, the
    reference counter d_refs is not increased.  If I close any of the
    fd, backed by the same pipe, the pipe will be freed.  This causes
    any further usage on the fd referencing a non existent pipe.  This
    change uses the inode reference counter, which is properly
    maintained during dup().  From Yang ChungFan.
  - SPI Bitbang:  Fix build error when the SPI bitbang variable width
    support is enabled.  From Augusto Fraga Giachero.
  - GPIO Lower Half:  Remove limitation when pintype &gt;
    GPIO_INTERRUPT_PIN.  From ligd.

* ARMv4/ARMv5

  - Classic ARM7/ARM9:  When performing stability test, the application
    would cause kernel crash. When I trace the stack, I find that
    register R1 has been changed, and its value is the same as register
    CPSR.  In up_fullcontextrestore.S, the restoration of R0 and R1 is
    not atomic:  '</span><span class="n">msr</span> <span class="n">cpsr</span> <span class="n">r1</span> <span class="n">will</span> <span class="n">enable</span> <span class="n">interrupts</span> <span class="k">and</span> <span class="n">the</span> <span class="n">recovery</span> <span class="k">of</span>
    <span class="n">r0</span> <span class="k">and</span> <span class="n">r1</span> <span class="n">may</span> <span class="n">be</span> <span class="n">interrupted</span> <span class="k">and</span> <span class="n">the</span> <span class="n">value</span> <span class="k">or</span> <span class="n">R1</span> <span class="n">may</span> <span class="n">be</span> <span class="n">changed</span><span class="p">.</span>
    <span class="n">Fix</span> <span class="n">is</span> <span class="k">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">single</span> <span class="n">ldmia</span> <span class="k">to</span> <span class="n">restore</span> <span class="n">R0</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="k">and</span> <span class="n">return</span> <span class="n">via</span> <span class="n">R15</span><span class="p">.</span>
    <span class="k">From</span> <span class="n">Loyen</span> <span class="n">Wang</span><span class="p">.</span>

<span class="p">*</span> <span class="n">ARMv7</span><span class="p">-</span><span class="n">A</span>

  <span class="p">-</span> <span class="n">ARMv7</span><span class="p">-</span><span class="n">A</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">typo</span> <span class="k">and</span> <span class="n">missing</span> <span class="n">quotation</span> <span class="n">for</span> <span class="n">ARMv7</span><span class="p">-</span><span class="n">A</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Oki</span>
    <span class="n">Minabe</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">ARMv7</span><span class="p">-</span><span class="n">A</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">double</span> <span class="n">increment</span> <span class="k">in</span> <span class="n">armv7</span><span class="p">-</span><span class="n">a</span><span class="s1">'s
    arm_addrenv_destroy_region().  From Oki Minabe.
  - ARMv7-A:  Fix L2 page table mask for ARMv7-A page allocator.  From
    Oki Minabe.

* ARMv7-M

  - Interrupts.  Removes the architecture-common
    CONFIG_ARCH_INT_DISABLEALL configuration option (but which was
    supported only by ARMv7-M).  In the normal course of things,
    interrupts must occasionally be disabled using the up_irq_save()
    inline function to prevent contention in use of resources that may
    be shared between interrupt level and non-interrupt level logic.
    Now the question arises, if we are using BASEPRI to disable
    interrupts and have high priority interrupts enabled
    (CONFIG_ARCH_HIPRI_INTERRUPT=y), do we disable all interrupts except
    SVCall (we cannot disable SVCall interrupts).  Or do we only disable
    the "normal" interrupts?  If we are using the BASEPRI register to
    disable interrupts, then the answer is that we must disable ONLY the
    "normal interrupts".  That is because we cannot disable SVCALL
    interrupts and we cannot permit SVCAll interrupts running at a
    higher priority than the high priority interrupts (otherwise, they
    will introduce jitter in the high priority interrupt response time.)
    Hence, if you need to disable the high priority interrupt, you will
    have to disable the interrupt either at the peripheral that
    generates the interrupt or at the NVIC.  Disabling global interrupts
    via the BASEPRI register cannot effect high priority interrupts.
    From Gregory Nutt.
  - ARMv7-M Priorities:  In the '</span><span class="n">normal</span><span class="s1">' case, the priority of the
    SVCALL interrupt was the same as the priority of the high priority
    interrupt.  This means that SVCALL interrupt processing can defer
    the high priority interrupt and result in the jitter in that
    interrupt response.  Fix is to raise the priority of the high
    priority interrupt above the priority of the SVCALL interrupt.
    Suggested by Nathan Hartman.  From Gregory Nutt.

* Microchip i.MXRT Drivers:

  - i.MXRT ENC:  Fix some errors in register bit definitions.  Noted by
    Arie de Muijnck.  From Gregory Nutt.
  - i.MXRT LPI2C:  Slave addresses are now correctly shifted when
    sending START.  TX/RX FIFOs now discarded on error to prevent FIFO
    underflow errors.  Fixes error checking to use priv structure and
    removes checking of BBF flag as it is not an error.  From Nicholas
    Chin.

* Microchip PIC32MZ Drivers:

  - PIC32MZ SPI:  Fix SPI Mode selection.  CKE is the inversion of the
    CPHA.  From Ouss4.

* Microchip/Atmel SAMD2x/SAML2x Drivers:

  - SAMD2/L2 I2C:  Correct time calculation.  From Bernd Walter.

* Microchip/Atmel SAM3/SAM4:

  - SAM3/4:  Add missing DMA configuration Kconfig setting.  From Bernd
    Walter.

* NXP LPC17xx/40xx Drivers:

  - LPC17xx/40xx ADC:  Only use PCLKSEL0 for ADC on LPC176x family.
    From jjlange.
  - LPC17xx/40xx Ethernet:  Set speed back to 10Mbps if 10Mmbps link
    negotiated.  From Augusto Fraga Giachero.
  - LPC17xx/40xx I2C:  Abort I2C transfers if a timeout has occurred.
    If a timeout has occurred in the middle of a I2C transfer, the next
    I2C interrupt should abort any transfers and send a stop condition
    to the corresponding I2C bus.  Failure to do so will result in
    memory corruption / undefined behavior as priv-&gt;msgs points to a
    region of memory it doesn'</span><span class="n">t</span> <span class="n">owns</span> <span class="n">anymore</span> <span class="n">after</span> <span class="n">lpc17_40_i2c_start</span>
    <span class="n">returns</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Augusto</span> <span class="n">Fraga</span> <span class="n">Giachero</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">I2C</span><span class="p">:</span>  <span class="n">Calculate</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">timeout</span> <span class="n">for</span> <span class="n">I2C</span>
    <span class="n">transfers</span><span class="p">.</span>  <span class="n">Depending</span> <span class="n">on</span> <span class="n">the</span> <span class="n">bus</span> <span class="n">frequency</span> <span class="k">and</span> <span class="n">transfer</span> <span class="n">size</span><span class="p">,</span> <span class="n">I2C</span>
    <span class="n">transactions</span> <span class="n">can</span> <span class="n">take</span> <span class="n">quite</span> <span class="n">a</span> <span class="n">bit</span><span class="p">,</span> <span class="n">so</span> <span class="n">a</span> <span class="n">fixed</span> <span class="n">timeout</span> <span class="n">is</span> <span class="k">not</span> <span class="n">a</span>
    <span class="n">good</span> <span class="n">solution</span><span class="p">.</span>  <span class="n">Calculating</span> <span class="n">the</span> <span class="n">timeout</span> <span class="n">at</span> <span class="nf">run</span> <span class="n">time</span> <span class="n">poses</span> <span class="n">some</span>
    <span class="n">overhead</span> <span class="n">but</span> <span class="n">still</span> <span class="n">better</span> <span class="n">than</span> <span class="n">aborting</span> <span class="n">long</span> <span class="n">transactions</span><span class="p">.</span>  <span class="k">From</span>
    <span class="n">Augusto</span> <span class="n">Fraga</span> <span class="n">Giachero</span><span class="p">.</span>

<span class="p">*</span> <span class="n">NXP</span><span class="p">/</span><span class="n">Freescale</span> <span class="n">Kinetis</span> <span class="n">Drivers</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">Kinetis</span> <span class="n">I2C</span><span class="p">:</span>  <span class="n">i2c</span> <span class="n">transfer</span> <span class="n">ensure</span> <span class="n">correct</span> <span class="n">result</span> <span class="n">returned</span><span class="p">.</span>
    <span class="n">kinetis_i2c_transfer</span> <span class="n">released</span> <span class="n">the</span> <span class="n">mutex</span> <span class="k">then</span> <span class="n">fetched</span> <span class="n">the</span> <span class="n">state</span><span class="p">,</span>
    <span class="n">this</span> <span class="n">resulted</span> <span class="k">in</span> <span class="n">returning</span> <span class="n">the</span> <span class="n">correct</span> <span class="n">results</span><span class="p">.</span>  <span class="k">From</span> <span class="n">David</span>
    <span class="n">Sidrane</span><span class="p">.</span>

<span class="p">*</span> <span class="n">NXP</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">Drivers</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">CAN</span><span class="p">:</span>  <span class="k">If</span> <span class="n">BOARD_CCLKSEL_DIVIDER</span> <span class="n">is</span> <span class="k">not</span> <span class="n">equal</span> <span class="k">to</span> <span class="m">1</span> <span class="n">on</span>
    <span class="n">LPC178x</span> <span class="k">or</span> <span class="n">LPC40xx</span> <span class="k">then</span> <span class="n">base</span> <span class="n">clock</span> <span class="n">rate</span> <span class="n">is</span> <span class="n">calculated</span> <span class="n">incorrectly</span>
    <span class="n">because</span> <span class="n">CCLK</span> <span class="n">frequency</span> <span class="n">does</span> <span class="k">not</span> <span class="n">correspond</span> <span class="k">to</span> <span class="n">PLL0</span> <span class="n">clock</span> <span class="n">which</span> <span class="n">is</span>
    <span class="n">used</span> <span class="n">for</span> <span class="n">PCLK</span><span class="p">.</span>  <span class="n">This</span>  <span class="n">is</span> <span class="n">partially</span> <span class="n">workaround</span> <span class="n">solution</span><span class="p">.</span>  <span class="n">It</span> <span class="n">would</span>
    <span class="n">be</span> <span class="n">probably</span> <span class="n">better</span> <span class="k">to</span> <span class="n">define</span> <span class="n">BOARD_PCLK_FREQUENCY</span> <span class="n">even</span> <span class="n">for</span> <span class="n">LPC176x</span>
    <span class="n">targets</span> <span class="k">and</span> <span class="n">use</span> <span class="n">that</span> <span class="k">to</span> <span class="n">replace</span> <span class="n">divisor</span> <span class="n">by</span> <span class="n">base_clock</span> <span class="k">in</span> <span class="n">up_dev_s</span><span class="p">.</span>
    <span class="k">From</span> <span class="n">Pavel</span> <span class="n">Pisa</span><span class="p">.</span>

<span class="p">*</span> <span class="n">NXP</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">Boards</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">Ethernet</span><span class="p">:</span>  <span class="n">Add</span> <span class="n">missing</span> <span class="n">LPC17_40_PHY_CEMENT_DISABLE</span>
    <span class="n">variable</span> <span class="k">to</span> <span class="n">the</span> <span class="n">lpc17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">Kconfig</span> <span class="n">file</span><span class="p">.</span>  <span class="n">For</span> <span class="n">some</span> <span class="n">reason</span> <span class="n">this</span>
    <span class="n">setting</span> <span class="n">was</span> <span class="k">not</span> <span class="n">referenced</span> <span class="n">anywhere</span> <span class="n">except</span> <span class="k">in</span> <span class="n">the</span> <span class="n">Ethernet</span> <span class="n">driver</span><span class="p">.</span>
    <span class="k">From</span> <span class="n">Augusto</span> <span class="n">Fraga</span> <span class="n">Giachero</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">LPC17xx</span><span class="p">/</span><span class="m">40</span><span class="n">xx</span> <span class="n">Ethernet</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">the</span> <span class="n">initialization</span> <span class="n">for</span> <span class="n">DP83848x</span> <span class="n">PHYs</span><span class="p">.</span>
    <span class="n">The</span> <span class="n">DP83848x</span> <span class="n">requires</span> <span class="n">the</span> <span class="n">RMII</span> <span class="n">mode</span> <span class="k">to</span> <span class="n">be</span> <span class="n">manually</span> <span class="n">enabled</span> <span class="n">through</span>
    <span class="n">the</span> <span class="n">MII_DP83848C_RBR</span> <span class="n">register</span><span class="p">.</span> <span class="n">Before</span> <span class="n">querying</span> <span class="n">the</span> <span class="n">speed</span> <span class="k">and</span> <span class="n">mode</span>
    <span class="n">it</span> <span class="n">should</span> <span class="nf">wait</span> <span class="n">for</span> <span class="n">the</span> <span class="n">link</span> <span class="k">to</span> <span class="n">be</span> <span class="n">established</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Augusto</span> <span class="n">Fraga</span>
    <span class="n">Giachero</span><span class="p">.</span>

<span class="p">*</span> <span class="n">NXP</span> <span class="n">i</span><span class="p">.</span><span class="n">MXRT</span> <span class="n">Drivers</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">i</span><span class="p">.</span><span class="n">MXRT</span> <span class="n">LPUART</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">some</span> <span class="n">errors</span> <span class="k">in</span> <span class="n">the</span> <span class="n">LPUART</span> <span class="n">register</span> <span class="n">definition</span>
    <span class="n">files</span><span class="p">.</span>  <span class="n">Correct</span> <span class="n">naming</span> <span class="k">of</span> <span class="n">a</span> <span class="k">function</span><span class="p">:</span>  <span class="n">up_earlyserialinit</span><span class="p">()</span> <span class="n">should</span>
    <span class="n">be</span> <span class="n">imxrt_earlyserialinit</span><span class="p">().</span>  <span class="n">Remove</span> <span class="n">prototypes</span> <span class="n">for</span> <span class="n">non</span><span class="p">-</span><span class="n">existent</span>
    <span class="n">serial</span> <span class="n">initialization</span> <span class="n">functions</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">i</span><span class="p">.</span><span class="n">MXRT</span> <span class="n">USDHC</span><span class="p">:</span>  <span class="n">uSDHC</span> <span class="n">typo</span> <span class="n">fixes</span> <span class="k">and</span> <span class="nf">command</span> <span class="n">transfer</span> <span class="n">error</span> <span class="n">handling</span>
    <span class="n">modified</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Ivan</span> <span class="n">Ucherdzhiev</span><span class="p">.</span>

<span class="p">*</span> <span class="n">SiLabs</span> <span class="n">EFM32</span> <span class="n">Drivers</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">EFM32</span> <span class="n">OTG</span> <span class="n">host</span><span class="p">:</span>  <span class="n">Adam</span> <span class="n">Porter</span><span class="s1">'s various fixex for STM32 FS/HS
    probably should be applied to EFM32 host which which has very
    similar IP.  From Gregory Nutt.

* STMicro STM32:

  - STM327F Configuration:  Kconfig add depends on BBSRAM.  From David
    Sidrane.
  - STM32F7 Interrupts:  Fix overwritten IRQ enable.  System boot order
    calls clock_initialize() then up_initalize().  clock_initialize()
    was setting up the alarm IRQ up_initalize is initializing the NVIC.
    This most likely worked in the past due to a bug in the NVIC
    initialization code that failed to clear the Interrupt enables.
  - STM32H7:  Rix BBSRAM name in memory map.  From David Sidrane.
  - STM32H7:  Removed f7 in file path.  From David Sidrane.

* STMicro STM32 Drivers:

  - STM32H7 BBSRAM:  Fix issues causing no writes and hardfaults.  From
    David Sidrane.
  - STM32H7 BBSRAM:  Convince compiler to perform 32 bit write.  From
    David Sidrane.
  - STM32F7 OTGHS:  Fixes bad preprocessor logic preventing USB OTG HS
    to work when used without external ULPI.  From Anthony Merlino.
  - STM32 OTGH[FS|HS] Host  STM32 host only initiates transfer if
    buflenl &gt; 0.  From Adam Porter.
  - STM32F7/H7/L4 OTG host:  Adam Porter'</span><span class="n">s</span> <span class="n">fix</span> <span class="n">for</span> <span class="n">STM32</span> <span class="n">FS</span><span class="p">/</span><span class="n">HS</span> <span class="n">probably</span>
    <span class="n">should</span> <span class="n">be</span> <span class="n">applied</span> <span class="k">to</span> <span class="n">STM32</span> <span class="n">F7</span><span class="p">,</span> <span class="n">H7</span><span class="p">,</span> <span class="k">and</span> <span class="n">L4</span> <span class="n">OTG</span> <span class="n">host</span> <span class="n">which</span> <span class="n">are</span> <span class="n">very</span>
    <span class="n">similar</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32</span><span class="p">/</span><span class="n">F7</span><span class="p">/</span><span class="n">H7</span><span class="p">/</span><span class="n">L4</span><span class="p">:</span>  <span class="n">This</span> <span class="n">change</span> <span class="n">was</span> <span class="n">required</span> <span class="k">to</span> <span class="n">get</span> <span class="n">my</span> <span class="n">devices</span>
    <span class="p">(</span><span class="n">CDC</span><span class="p">-</span><span class="n">MBIM</span><span class="p">)</span> <span class="k">to</span> <span class="n">enumerate</span><span class="p">.</span>  <span class="n">Initially</span> <span class="n">the</span> <span class="nf">system</span> <span class="n">timed</span> <span class="n">out</span> <span class="n">retrieving</span>
    <span class="n">the</span> <span class="n">USB</span> <span class="n">configuration</span> <span class="n">descriptor</span><span class="p">.</span>  <span class="n">Ctrl</span> <span class="k">IN</span> <span class="n">requests</span> <span class="n">got</span> <span class="n">nothing</span> <span class="n">but</span>
    <span class="n">NAKs</span><span class="p">.</span>  <span class="n">I</span> <span class="n">found</span> <span class="n">that</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">SETUP</span> <span class="n">packet</span> <span class="k">and</span> <span class="n">corresponding</span> <span class="k">IN</span>
    <span class="n">transfer</span> <span class="n">were</span> <span class="n">fine</span><span class="p">;</span> <span class="n">it</span> <span class="n">was</span> <span class="n">the</span> <span class="n">Status</span> <span class="n">OUT</span> <span class="n">phase</span> <span class="n">that</span> <span class="n">was</span> <span class="n">getting</span> <span class="n">the</span>
    <span class="n">NAK</span><span class="p">.</span>  <span class="n">After</span> <span class="n">receiving</span> <span class="n">a</span> <span class="n">NAK</span> <span class="n">on</span> <span class="n">the</span> <span class="n">Status</span> <span class="n">OUT</span><span class="p">,</span> <span class="n">the</span> <span class="n">code</span> <span class="n">would</span> <span class="n">loop</span>
    <span class="n">back</span> <span class="k">and</span> <span class="n">issue</span> <span class="n">another</span> <span class="n">ctrl</span> <span class="k">IN</span><span class="p">,</span> <span class="n">which</span> <span class="n">will</span> <span class="n">always</span> <span class="n">fail</span> <span class="n">because</span> <span class="n">the</span>
    <span class="n">data</span> <span class="n">was</span> <span class="n">already</span> <span class="n">transferred</span> <span class="n">before</span><span class="p">.</span> <span class="n">Thus</span> <span class="n">the</span> <span class="n">entire</span> <span class="n">transfer</span> <span class="n">would</span>
    <span class="s1">'timeout'</span><span class="p">.</span>  <span class="n">The</span> <span class="n">fix</span> <span class="n">I</span> <span class="n">implemented</span> <span class="n">moves</span> <span class="n">the</span> <span class="n">DATANAK</span> <span class="n">timeout</span> <span class="n">loop</span> <span class="k">to</span>
    <span class="n">only</span> <span class="n">apply</span> <span class="k">to</span> <span class="n">the</span> <span class="n">Status</span> <span class="n">OUT</span><span class="p">.</span>  <span class="n">Both</span> <span class="n">the</span> <span class="n">ctrl</span> <span class="k">IN</span> <span class="k">and</span> <span class="n">the</span> <span class="n">Status</span> <span class="n">OUT</span>
    <span class="n">need</span> <span class="n">their</span> <span class="n">own</span> <span class="n">retry</span> <span class="n">loops</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Adam</span> <span class="n">Porter</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32F7</span> <span class="n">SDMMC</span><span class="p">:</span>  <span class="k">If</span> <span class="n">there</span> <span class="n">is</span> <span class="n">only</span> <span class="n">one</span> <span class="n">SDMMC</span> <span class="n">it</span> <span class="n">is</span> <span class="n">slot</span> <span class="m">0</span>  <span class="k">From</span> <span class="n">David</span>
    <span class="n">Sidrane</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32F7</span> <span class="n">USART1</span><span class="p">:</span>  <span class="n">USART1_RXDMA</span> <span class="n">is</span> <span class="n">dependent</span> <span class="n">on</span> <span class="n">STM32F7_DMA2</span> <span class="k">not</span>
    <span class="n">STM32F7_DMA1</span>  <span class="k">From</span> <span class="n">Anthony</span> <span class="n">Merlino</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">DBGMCU</span><span class="p">:</span>  <span class="n">Memory</span> <span class="n">Map</span> <span class="n">DBGMCU</span> <span class="n">is</span> <span class="p">@</span> <span class="m">0x5c001000</span>  <span class="k">From</span> <span class="n">David</span>
    <span class="n">Sidrane</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32F7</span> <span class="n">SDMMC</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">warning</span> <span class="n">when</span> <span class="n">DMA</span> <span class="n">is</span> <span class="k">not</span> <span class="n">enabled</span><span class="p">.</span>  <span class="k">From</span> <span class="n">David</span>
    <span class="n">Sidrane</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">Ethernet</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">some</span> <span class="n">errors</span> <span class="k">in</span> <span class="n">Ethernet</span> <span class="n">MAC</span> <span class="n">configuration</span><span class="p">.</span>
    <span class="k">From</span> <span class="n">Markus</span> <span class="n">Bernet</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">Ethernet</span><span class="p">:</span>  <span class="n">Correct</span> <span class="n">stm32h7</span> <span class="n">mac</span> <span class="n">address</span> <span class="n">filtering</span><span class="p">.</span>  <span class="n">Correct</span>
    <span class="n">the</span> <span class="n">MAC</span> <span class="n">address</span> <span class="m">0</span> <span class="n">register</span> <span class="n">definition</span> <span class="k">and</span> <span class="n">remove</span> <span class="n">the</span> <span class="s1">'receive all'</span>
    <span class="n">flag</span><span class="p">.</span>  <span class="n">Now</span> <span class="n">the</span> <span class="n">Ethernet</span> <span class="n">driver</span> <span class="n">only</span> <span class="n">receives</span> <span class="n">packets</span> <span class="n">addressed</span> <span class="k">to</span>
    <span class="n">correct</span> <span class="n">MAC</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Jukka</span> <span class="n">Laitinen</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">Ethernet</span><span class="p">:</span>  <span class="n">Correct</span> <span class="n">memory</span> <span class="n">corruption</span> <span class="n">error</span><span class="p">.</span>  <span class="n">The</span> <span class="n">Ethernet</span>
    <span class="n">driver</span> <span class="n">initialization</span> <span class="n">incorrectly</span> <span class="n">wrote</span> <span class="k">to</span> <span class="n">DMACRXCR</span> <span class="n">instead</span> <span class="k">of</span>
    <span class="n">DMACSR</span> <span class="n">when</span> <span class="n">trying</span> <span class="k">to</span> <span class="n">clear</span> <span class="n">the</span> <span class="n">stopped</span> <span class="n">flags</span><span class="p">.</span>  <span class="n">This</span> <span class="n">caused</span>
    <span class="n">invalid</span> <span class="n">buffer</span> <span class="n">length</span> <span class="k">in</span> <span class="n">the</span> <span class="n">DMACRXCR</span><span class="p">,</span> <span class="n">causing</span> <span class="n">DMA</span> <span class="k">to</span> <span class="n">overflow</span> <span class="n">the</span>
    <span class="n">RX</span> <span class="n">buffers</span> <span class="n">when</span> <span class="n">large</span> <span class="n">packets</span> <span class="n">are</span> <span class="n">sent</span> <span class="k">to</span> <span class="n">the</span> <span class="n">device</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Jukka</span>
    <span class="n">Laitinen</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">PWR</span><span class="p">:</span>  <span class="n">Ensure</span> <span class="n">data</span> <span class="n">is</span> <span class="n">flushed</span> <span class="n">on</span> <span class="n">backup</span> <span class="n">domain</span> <span class="n">access</span>
    <span class="n">changes</span><span class="p">.</span>  <span class="k">From</span> <span class="n">David</span> <span class="n">Sidrane</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">Serial</span><span class="p">:</span>  <span class="n">Serial</span> <span class="n">fix</span> <span class="n">undefined</span> <span class="k">with</span> <span class="n">TERMIOS</span>  <span class="k">From</span> <span class="n">David</span>
    <span class="n">Sidrane</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">STM32H7</span> <span class="n">UARTs</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">UART7</span><span class="p">/</span><span class="m">8</span> <span class="n">typos</span><span class="p">.</span>  <span class="n">Fix</span> <span class="n">bug</span> <span class="k">in</span> <span class="n">ETH_MACQTXFCR</span>
    <span class="n">configuration</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Markus</span> <span class="n">Bernet</span><span class="p">.</span>

<span class="p">*</span> <span class="n">STMicro</span> <span class="n">STM32</span> <span class="n">Boards</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">Multiple</span> <span class="n">STM32</span> <span class="n">Boards</span><span class="p">:</span>  <span class="k">If</span> <span class="n">CONFIG_SCHED_CRITMONITOR</span> <span class="n">is</span> <span class="n">selected</span><span class="p">,</span>
    <span class="k">then</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">that</span> <span class="n">ITM</span> <span class="k">and</span> <span class="n">DWT</span> <span class="n">resources</span> <span class="n">are</span> <span class="n">enabled</span> <span class="n">before</span>
    <span class="n">accessing</span> <span class="n">ITM</span> <span class="k">and</span> <span class="n">DWT</span> <span class="n">registers</span><span class="p">.</span>  <span class="n">By</span> <span class="n">default</span><span class="p">,</span> <span class="n">these</span> <span class="n">registers</span> <span class="n">are</span>
    <span class="n">disabled</span><span class="p">.</span>  <span class="n">Suggested</span> <span class="n">by</span> <span class="n">Juha</span> <span class="n">Niskanen</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Nucleo</span><span class="p">-</span><span class="n">H743ZI</span><span class="p">:</span>  <span class="n">Correct</span> <span class="n">logic</span> <span class="n">that</span> <span class="n">determines</span> <span class="k">if</span> <span class="n">the</span> <span class="n">RTC</span> <span class="n">driver</span> <span class="n">is</span>
    <span class="n">available</span><span class="p">.</span>  <span class="n">Find</span> <span class="k">in</span> <span class="n">build</span> <span class="n">testing</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Nucleo</span><span class="p">-</span><span class="n">G071RB</span><span class="p">:</span>  <span class="n">Fix</span> <span class="n">linker</span> <span class="n">script</span> <span class="k">to</span> <span class="n">avoid</span> <span class="p">.</span><span class="n">ARM</span><span class="p">.</span><span class="n">exidx</span> <span class="n">section</span>
    <span class="n">overlap</span> <span class="k">with</span> <span class="p">.</span><span class="n">data</span>  <span class="k">From</span> <span class="n">Daniel</span> <span class="n">Pereira</span> <span class="n">Volpato</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Modify</span> <span class="n">all</span> <span class="n">linker</span> <span class="n">scripts</span> <span class="p">(</span><span class="n">all</span> <span class="n">boards</span><span class="p">,</span> <span class="n">all</span> <span class="n">architectures</span><span class="p">)</span> <span class="k">to</span> <span class="n">use</span>
    <span class="n">solution</span> <span class="k">from</span> <span class="n">Daniel</span> <span class="n">P</span><span class="p">.</span> <span class="n">Volpato</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Alan</span> <span class="n">Carvalho</span> <span class="n">de</span> <span class="n">Assis</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">Nucleo</span><span class="p">-</span><span class="n">L432KC</span> <span class="n">ADC</span><span class="p">:</span>  <span class="n">Change</span> <span class="n">analog</span> <span class="n">pins</span> <span class="n">definitions</span> <span class="k">and</span> <span class="n">correct</span> <span class="n">DMA</span>
    <span class="n">related</span> <span class="n">issue</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Daniel</span> <span class="n">P</span><span class="p">.</span> <span class="n">Carvalho</span><span class="p">.</span>

<span class="p">*</span> <span class="n">TI</span> <span class="n">Tiva</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">Tiva</span> <span class="n">Configuration</span><span class="p">:</span>  <span class="n">Rename</span> <span class="n">TM4C123GH6PMI</span> <span class="n">identifiers</span> <span class="k">to</span>
    <span class="n">TM4C123GH6PM</span><span class="p">.</span>  <span class="n">Rationale</span><span class="p">:</span> <span class="k">In</span> <span class="n">terms</span> <span class="k">of</span> <span class="n">firmware</span> <span class="n">programming</span><span class="p">,</span> <span class="n">there</span>
    <span class="n">is</span> <span class="n">no</span> <span class="n">functional</span> <span class="n">difference</span> <span class="n">between</span> <span class="n">these</span> <span class="n">parts</span><span class="p">:</span>  <span class="n">TM4C123GH6PMI7</span><span class="p">,</span>
    <span class="n">TM4C123GH6PMI7R</span><span class="p">,</span> <span class="n">TM4C123GH6PMT7</span><span class="p">,</span> <span class="k">and</span> <span class="n">TM4C123GH6PMT7R</span><span class="p">.</span>  <span class="k">From</span> <span class="n">a</span>
    <span class="n">programming</span> <span class="n">standpoint</span><span class="p">,</span> <span class="n">all</span> <span class="k">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">parts</span> <span class="n">are</span> <span class="n">TM4C123GH6PM</span><span class="p">,</span>
    <span class="n">which</span> <span class="n">means</span> <span class="n">it</span> <span class="n">doesn</span><span class="s1">'t make sense to differentiate between PM and
    PMI. (The PM means 64-LQFP. The I means temperature range -40C to
    +85C. It could be T meaning -40C to +105C. The R means it ships in
    Tape and Reel packaging as opposed to Tray.)  From Nathan Hartman.
  - Tiva Configuration:  Rename TM4C1294NC identifiers to TM4C1294NCPDT.
    Rationale: TM4C1294NC is ambiguous: TM4C1294NCPDT is a 128-TQFP,
    TM4C1294NCZAD is a 212-NFBGA.  The TM4C1294NC part currently
    supported by NuttX is the TM4C1294NCPDT used on the TI EK-TM4C1294XL
    "Connected LaunchPad" (see configs/tm4c1294-launchpad).  To ensure
    the correct part is fully specified, this commit updates all
    TM4C1294NC identifiers to TM4C1294NCPDT.  From Nathan Hartman.
  - Tiva Configuration:  Fix TM4C129XNCZAD part number in Kconfig and
    identifiers.  Rationale: Fully specify that this is the 212-pin BGA
    package (ZAD ending) and for consistency with earlier changes to
    other Tiva TM4C12x part numbers in Kconfig names and identifiers.
    From Nathan Hartman.

* TI Tiva Drivers:

  - Tiva TM4C 1-Wire:  Fix wrong description on define TIVA_1WIRE_BASE:
    Was "EEPROM and Key Locker" (same as the item above). Now "1-Wire
    Master Module." Make DMACTL symbols visible for TM4C123:  Remove
    "#ifdef CONFIG_ARCH_CHIP_TM4C129" guard around UART DMA Control
    (DMACTL) symbols.  These bits are valid on TM4C123 devices, as well
    as on TM4C129. Also, improve the comment on UART_DMACTL_DMAERR.
    From Nathan Hartman.
  - Tiva GPIO Interrupts:  LM3S, LM4F, TM4C: Fix GPIO IRQ error, ports
    R, S, T.  Preprocessor logic for CONFIG_TIVA_GPIOx_IRQS was setting/
    clearing port Q defines when it should act on ports R, S, T.
    gpioport2irq() was missing handling for port T.  From Nathan
    Hartman.
  - Tiva Timers:  Fix minor errors in tiva_timerlib.c.  Fix incorrect
    preprocessor conditionals related to Kconfig defines:
    CONFIG_TIVA_TIMER32_EDGECOUNT -&gt; CONFIG_TIVA_TIMER16_EDGECOUNT,
    CONFIG_TIVA_TIMER32_TIMECAP -&gt; CONFIG_TIVA_TIMER16_TIMECAP,
    CONFIG_TIVA_TIMER32_PWM -&gt; CONFIG_TIVA_TIMER16_PWM.  From Nathan
    Hartman.
  - Tiva Timers: Fix errors in low-level timer support.
    tiva_gptm_configure() and tiva_gptm_release() were calling
    tiva_emac_periphrdy() instead of tiva_gptm_periphrdy().  Fix
    error in "abcde" description of bit flag defines.  From Nathan
    Hartman.
  - Tiva Timers:  Fix one code error and some comment errors.
    tiva_timer16_setinterval(): Was DEBUGASSERTing on mode !=
    TIMER16_MODE.  Fixed to DEBUGASSERT on mode == TIMER16_MODE.
    From Nathan Hartman.

* ZiLOG Z80 Boards:

  - z80sim Serial:  Fix uart_dev_t initializer:  pollfds[] is a array of
    pointers and, hence, the NULL initializer must be included in braces.
    Noted by Paul Osmialowski in Issue #160.  From Gregory Nutt.
  - z80sim Interrupts:  Missed a name change up_irqinitialize to
    z80_irq_initialize.  From Gregory Nutt.

* C Library/Header Files:

  - include/netinet/in.h:  Rename __pad member to sin_zero in struct
    sockaddr_in.  Libwebsockets initializes the '</span><span class="n">sin_zero</span><span class="s1">' member of
    sockaddr_in objects to zeros.  Apparently, judging from mailing list
    entries, there are platforms on which not doing this causes
    undefined behavior.  On NuttX compiling respective code is broken,
    as the corresponding member variable is called '</span><span class="n">__pad</span><span class="s1">'.  Neither in
    the '</span><span class="n">nuttx</span><span class="s1">' nor in the '</span><span class="n">apps</span><span class="s1">' repository did I find any reference to
    this identifier.  Thus, I believe its a safe bet to just rename it.
    UNIX Network Programming states in this regard:  "The POSIX
    specification requires only three members in the structure:
    sin_family, sin_addr, and sin_port. It is acceptable for a POSIX-
    compliant implementation to define additional structure members, and
    this is normal for an Internet socket address structure. Almost all
    implementations add the sin_zero member so that all socket address
    structures are at least 16 bytes in size."  From Michael Jung.

  - libs/libc/libc.csv:  Correct dependency of setlocale on
    CONFIG_LIBC_LOCALE.  From Pavel Pisa.
  - libs/libc/machine/arm/armv7-m:  Fix build error for ELF.  From
    Masayuki Ishikawa.
  - libs/libc/math.csv:  Correct format of some function entries.  From
    Pavel Pisa.

* Tools:

  - tools/:  Change all occurrences of /bin/(ba)sh in shell scripts to
    /usr/bin/env bash which appears more portable  From Manuel StÃ¼hn.

* NSH Library: apps/nshlib:

  - apps/nshlib/:  As noted by David S. Alessio, '</span><span class="n">cat</span><span class="s1">' should not output
    any additional newline at the end of the cat'</span><span class="n">ed</span> <span class="n">file</span> <span class="n">content</span><span class="p">.</span>  <span class="n">This</span>
    <span class="n">additional</span> <span class="n">newline</span> <span class="n">was</span> <span class="n">added</span> <span class="k">to</span> <span class="n">assure</span> <span class="n">that</span> <span class="n">the</span> <span class="n">NSH</span> <span class="n">prompt</span> <span class="n">was</span>
    <span class="n">presented</span> <span class="n">on</span> <span class="n">a</span> <span class="n">new</span> <span class="n">line</span><span class="p">.</span>  <span class="n">However</span><span class="p">,</span> <span class="n">that</span> <span class="n">is</span> <span class="k">not</span> <span class="n">the</span> <span class="n">correct</span> <span class="n">behavior</span>
    <span class="k">of</span> <span class="s1">'cat'</span> <span class="n">per</span> <span class="n">the</span> <span class="n">IEEE</span> <span class="n">std</span><span class="p">:</span>  <span class="s2">"The standard output shall contain the
    sequence of bytes read from the input files. Nothing else shall be
    written to the standard output."</span>  <span class="n">Reference</span><span class="p">:</span>
    <span class="n">https</span><span class="p">://</span><span class="n">pubs</span><span class="p">.</span><span class="n">opengroup</span><span class="p">.</span><span class="n">org</span><span class="p">/</span><span class="n">onlinepubs</span><span class="p">/</span><span class="m">009695399</span><span class="p">/</span><span class="n">utilities</span><span class="p">/</span><span class="n">cat</span><span class="p">.</span><span class="n">html</span><span class="p">.</span>
    <span class="n">This</span> <span class="n">commit</span> <span class="n">changes</span> <span class="n">the</span> <span class="k">function</span> <span class="n">nsh_catfile</span><span class="p">()</span> <span class="n">which</span> <span class="n">underlies</span> <span class="n">the</span>
    <span class="s1">'cat'</span> <span class="nf">command</span> <span class="k">and</span> <span class="n">well</span> <span class="k">as</span> <span class="n">other</span> <span class="n">NSH</span> <span class="n">commands</span><span class="p">.</span>  <span class="n">Although</span> <span class="n">this</span> <span class="n">is</span> <span class="n">the</span>
    <span class="n">correct</span> <span class="n">behavior</span> <span class="n">for</span> <span class="s1">'cat'</span> <span class="n">it</span> <span class="n">may</span> <span class="k">not</span> <span class="n">be</span> <span class="n">the</span> <span class="n">correct</span> <span class="n">behavior</span> <span class="n">for</span>
    <span class="n">other</span> <span class="n">commands</span> <span class="n">implemented</span> <span class="n">via</span> <span class="n">nsh_catfile</span><span class="p">().</span>  <span class="n">That</span> <span class="n">remains</span> <span class="k">to</span> <span class="n">be</span>
    <span class="n">determined</span><span class="p">.</span>  <span class="k">From</span> <span class="n">Gregory</span> <span class="n">Nutt</span><span class="p">.</span>

<span class="p">*</span> <span class="nf">System</span> <span class="n">Utilities</span><span class="p">:</span> <span class="n">apps</span><span class="p">/</span><span class="nf">system</span><span class="p">:</span>

  <span class="p">-</span> <span class="n">apps</span><span class="p">/</span><span class="nf">system</span><span class="p">/</span><span class="n">cle</span><span class="p">/:</span>  <span class="n">ASCII</span> <span class="n">DEL</span> <span class="n">should</span> <span class="n">be</span> <span class="n">treated</span> <span class="n">by</span> <span class="n">Delete</span><span class="p">-</span><span class="n">Left</span><span class="p">.</span>  <span class="k">From</span>
    <span class="n">Dave</span> <span class="n">Marples</span><span class="p">.</span>
  <span class="p">-</span> <span class="n">apps</span><span class="p">/</span><span class="nf">system</span><span class="p">/</span><span class="n">i2ctool</span><span class="p">:</span>  <span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="n">Friendlier</span> <span class="n">I2C</span> <span class="s2">"knock-knock"</span> <span class="k">uses</span> <span class="n">only</span>
    <span class="nb">read</span> <span class="n">request</span><span class="p">.</span>  <span class="k">While</span> <span class="n">many</span> <span class="n">I2C</span> <span class="n">slave</span> <span class="n">devices</span> <span class="n">have</span> <span class="n">multiple</span> <span class="n">indexed</span>
    <span class="n">registers</span><span class="p">,</span> <span class="n">some</span> <span class="n">have</span> <span class="n">only</span> <span class="n">one</span> <span class="n">register</span> <span class="k">and</span> <span class="n">it</span><span class="s1">'s not indexed.  For
    example, the I2C bus switch TCA9548A has only a Control Register,
    attempting to index to "Reg[0]" alters its contents to 0x00
    disabling all subordinate buses.  This patch fixes that problem by
    simply trying to read something/anything from the slave.  This also
    helps coax out slaves with register files that start from a higher
    index, i.e. the AT24CS0x, FLASH chips with a UUID that appears as a
    2nd I2C slave at (address+8), report their serial number at
    Reg[80]-Reg[8F] and will NAK a read of Reg[0].  (2) Modify get/set
    to prevent write of reg index if not specifed  From David Alessio.

* Network Utilities: apps/netutils:

  - apps/netutils/dhcpd:  Fixes bug where hwaddr was being used instead
    of ipaddr in the ARP update.  This bug seems to have been introduced
    three years ago during a rewrite to remove a direct OS call to arp.
    I'</span><span class="n">m</span> <span class="k">not</span> <span class="n">sure</span> <span class="n">how</span> <span class="n">others</span> <span class="n">have</span> <span class="k">not</span> <span class="nf">run</span> <span class="n">into</span> <span class="n">issues</span> <span class="k">with</span> <span class="n">this</span><span class="p">.</span>  <span class="n">The</span>
    <span class="n">behavior</span> <span class="n">I</span> <span class="n">was</span> <span class="n">observing</span> <span class="n">was</span> <span class="n">that</span> <span class="n">the</span> <span class="n">DHCPD</span> <span class="n">would</span> <span class="n">go</span> <span class="k">to</span> <span class="n">offer</span> <span class="n">an</span> <span class="n">IP</span>
    <span class="n">address</span><span class="p">,</span> <span class="n">but</span> <span class="k">then</span> <span class="nf">send</span> <span class="n">a</span> <span class="n">ARP</span> <span class="n">request</span> <span class="n">for</span> <span class="n">the</span> <span class="n">IP</span> <span class="n">instead</span> <span class="n">because</span> <span class="n">it</span>
    <span class="n">didn</span><span class="s1">'t know where to send the data.  From Anthony Merlino.
  - apps/netutils/netinit/:  Remove warnings.  Unhook PHY notification
    signal handler when cleaning up, if an error occurs after the signal
    handler is put into place.  From Nathan Hartman.

* Wireless Utilities: apps/wireless:

  - apps/wireless/ieee802154/i8sak:  Fixes conversion from extended
    address to IPv6 address.  From Anthony Merlino.
</span></code></pre></div></div>

  </div>
</div>


      <hr>
      <footer>
        <!-- <p>&copy; 2022 </p>-->
        <footer class="site-footer">
    <div class="wrapper">
        <div class="footer-col-wrapper">
            
            Apache NuttX is an effort undergoing <a href="https://incubator.apache.org/index.html">Incubation</a>
            at The Apache Software Foundation (ASF), sponsored by the Incubator. Incubation is required of all newly
            accepted projects until a further review indicates that the infrastructure, communications, and decision
            making process have stabilized in a manner consistent with other successful ASF projects. While incubation
            status is not necessarily a reflection of the completeness or stability of the code, it does indicate that
            the project has yet to be fully endorsed by the ASF.
            <hr>
            
            <div style="text-align:center;">
                
                <div style="margin-top: 20px; margin-bottom: 20px;">
                    <a href="http://incubator.apache.org"><img src="/assets/themes/apache/img/egg-logo.png"
                                                               alt="Apache Incubator"/></a>
                </div>
                
                <div>
                    Copyright &copy; 2019 <a href="http://www.apache.org">The Apache Software Foundation</a>.
                    Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version
                    2.0</a>.
                    <br>
                    
                    Apache, the Apache Feather logo, and the Apache Incubator project logo are trademarks of The Apache
                    Software Foundation.
                    
                </div>
            </div>
        </div>
    </div>
</footer>

      </footer>
    </div>

    
    <script src="/assets/themes/apache/jquery/jquery-2.1.1.min.js"></script>

    <script src="/assets/themes/apache/bootstrap/js/bootstrap.min.js"></script>


  </body>
</html>

